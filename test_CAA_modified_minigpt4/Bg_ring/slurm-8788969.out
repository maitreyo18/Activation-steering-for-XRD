Wed Jun 25 13:07:23 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 565.57.01              Driver Version: 565.57.01      CUDA Version: 12.7     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:AF:00.0 Off |                    0 |
| N/A   27C    P0             25W /  250W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
/depot/amannodi/apps/ASTRA/envs/astra_minigpt/lib/python3.10/site-packages/transformers/utils/hub.py:127: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/scratch/gilbreth/biswasm/ASTRA_updated/minigpt4/models/eva_vit.py:433: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(cached_file, map_location="cpu")
/scratch/gilbreth/biswasm/ASTRA_updated/minigpt4/models/blip2.py:77: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(cached_file, map_location="cpu")
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565 - if you loaded a llama tokenizer from a GGUF file you can ignore this message
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
=== CAA Generation with Continuous Steering (Batch Mode) ===
CSV File: ./test_generate.csv
Image Directory: ../datasets/XRD_data/one_correct/background_ring
Alpha: 0.3, Layer: 16
Loading VIT
Loading VIT Done
Loading Q-Former
Loading Q-Former Done
Loading LLAMA
Downloading shards:   0%|          | 0/3 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 3/3 [00:00<00:00, 547.70it/s]
/depot/amannodi/apps/ASTRA/envs/astra_minigpt/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:519: UserWarning: `pad_token_id` should be positive but got -1. This will cause errors when batch generating, if there is padding. Please set `pad_token_id` explicitly by `model.generation_config.pad_token_id=PAD_TOKEN_ID` to avoid errors in generation, and ensure your `input_ids` input does not have negative values.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:20<00:41, 20.52s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:43<00:21, 21.89s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:57<00:00, 18.53s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:57<00:00, 19.30s/it]
/scratch/gilbreth/biswasm/ASTRA_updated/minigpt4/models/mini_gpt4.py:274: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(ckpt_path, map_location="cpu")
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama_fast.LlamaTokenizerFast'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565 - if you loaded a llama tokenizer from a GGUF file you can ignore this message.
/scratch/gilbreth/biswasm/ASTRA_updated/test_CAA_modified/./CAA_modified_generate.py:226: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  steering_data = torch.load(args.steering_vectors_path)
Loading LLAMA Done
Load BLIP2-LLM Checkpoint: /scratch/gilbreth/biswasm/ASTRA_updated/ckpts/pretrained_minigpt4.pth
[Model Initialized]

Loading steering vectors...
Mean steering vector: [-0.819  -0.6514  0.8076 ... -0.6553 -2.129  -0.2183]
Steering vector loaded (norm: 58.9688)
Reading CSV file: ./test_generate.csv
Found 321 items to process
Processing items:   0%|          | 0/321 [00:00<?, ?it/s]/scratch/gilbreth/biswasm/ASTRA_updated/test_CAA_modified/./CAA_modified_generate.py:154: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.no_grad(), torch.cuda.amp.autocast():
/scratch/gilbreth/biswasm/ASTRA_updated/minigpt4/models/blip2.py:41: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/depot/amannodi/apps/ASTRA/envs/astra_minigpt/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:540: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.5` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/depot/amannodi/apps/ASTRA/envs/astra_minigpt/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:545: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Processing items:   0%|          | 1/321 [00:10<57:53, 10.86s/it]Processing items:   1%|          | 2/321 [00:19<51:15,  9.64s/it]Processing items:   1%|          | 3/321 [00:28<49:16,  9.30s/it]Processing items:   1%|          | 4/321 [00:37<48:05,  9.10s/it]Processing items:   2%|▏         | 5/321 [00:46<47:18,  8.98s/it]Processing items:   2%|▏         | 6/321 [00:54<46:56,  8.94s/it]Processing items:   2%|▏         | 7/321 [01:03<46:38,  8.91s/it]Processing items:   2%|▏         | 8/321 [01:12<46:12,  8.86s/it]Processing items:   3%|▎         | 9/321 [01:21<45:51,  8.82s/it]Processing items:   3%|▎         | 10/321 [01:30<45:37,  8.80s/it]Processing items:   3%|▎         | 11/321 [01:38<45:26,  8.79s/it]Processing items:   4%|▎         | 12/321 [01:47<45:16,  8.79s/it]Processing items:   4%|▍         | 13/321 [01:56<44:59,  8.77s/it]Processing items:   4%|▍         | 14/321 [02:05<44:51,  8.77s/it]Processing items:   5%|▍         | 15/321 [02:13<44:37,  8.75s/it]Processing items:   5%|▍         | 16/321 [02:22<44:30,  8.76s/it]Processing items:   5%|▌         | 17/321 [02:31<44:22,  8.76s/it]Processing items:   6%|▌         | 18/321 [02:40<44:16,  8.77s/it]Processing items:   6%|▌         | 19/321 [02:48<44:02,  8.75s/it]Processing items:   6%|▌         | 20/321 [02:57<43:57,  8.76s/it]Processing items:   7%|▋         | 21/321 [03:06<43:48,  8.76s/it]Processing items:   7%|▋         | 22/321 [03:15<43:42,  8.77s/it]Processing items:   7%|▋         | 23/321 [03:23<43:32,  8.77s/it]Processing items:   7%|▋         | 24/321 [03:32<43:31,  8.79s/it]Processing items:   8%|▊         | 25/321 [03:41<43:23,  8.80s/it]Processing items:   8%|▊         | 26/321 [03:50<43:16,  8.80s/it]Processing items:   8%|▊         | 27/321 [03:59<43:06,  8.80s/it]Processing items:   9%|▊         | 28/321 [04:08<42:59,  8.80s/it]Processing items:   9%|▉         | 29/321 [04:16<42:48,  8.80s/it]Processing items:   9%|▉         | 30/321 [04:25<42:53,  8.85s/it]Processing items:  10%|▉         | 31/321 [04:34<42:45,  8.85s/it]Processing items:  10%|▉         | 32/321 [04:43<42:34,  8.84s/it]Processing items:  10%|█         | 33/321 [04:52<42:23,  8.83s/it]Processing items:  11%|█         | 34/321 [05:01<42:11,  8.82s/it]Processing items:  11%|█         | 35/321 [05:09<41:59,  8.81s/it]Processing items:  11%|█         | 36/321 [05:18<41:46,  8.80s/it]Processing items:  12%|█▏        | 37/321 [05:27<41:38,  8.80s/it]Processing items:  12%|█▏        | 38/321 [05:36<41:29,  8.80s/it]Processing items:  12%|█▏        | 39/321 [05:45<41:23,  8.81s/it]Processing items:  12%|█▏        | 40/321 [05:53<41:10,  8.79s/it]Processing items:  13%|█▎        | 41/321 [06:02<41:05,  8.81s/it]Processing items:  13%|█▎        | 42/321 [06:11<40:57,  8.81s/it]Processing items:  13%|█▎        | 43/321 [06:20<40:48,  8.81s/it]Processing items:  14%|█▎        | 44/321 [06:29<40:41,  8.82s/it]Processing items:  14%|█▍        | 45/321 [06:37<40:36,  8.83s/it]Processing items:  14%|█▍        | 46/321 [06:46<40:24,  8.82s/it]Processing items:  15%|█▍        | 47/321 [06:55<40:16,  8.82s/it]Processing items:  15%|█▍        | 48/321 [07:04<40:06,  8.82s/it]Processing items:  15%|█▌        | 49/321 [07:13<39:54,  8.80s/it]Processing items:  16%|█▌        | 50/321 [07:21<39:46,  8.80s/it]Processing items:  16%|█▌        | 51/321 [07:30<39:36,  8.80s/it]Processing items:  16%|█▌        | 52/321 [07:39<39:27,  8.80s/it]Processing items:  17%|█▋        | 53/321 [07:48<39:17,  8.80s/it]Processing items:  17%|█▋        | 54/321 [07:57<39:10,  8.80s/it]Processing items:  17%|█▋        | 55/321 [08:05<39:03,  8.81s/it]Processing items:  17%|█▋        | 56/321 [08:14<38:51,  8.80s/it]Processing items:  18%|█▊        | 57/321 [08:23<38:44,  8.81s/it]Processing items:  18%|█▊        | 58/321 [08:32<38:38,  8.82s/it]Processing items:  18%|█▊        | 59/321 [08:41<38:24,  8.80s/it]Processing items:  19%|█▊        | 60/321 [08:49<38:16,  8.80s/it]Processing items:  19%|█▉        | 61/321 [08:58<38:09,  8.81s/it]Processing items:  19%|█▉        | 62/321 [09:07<38:02,  8.81s/it]Processing items:  20%|█▉        | 63/321 [09:16<37:53,  8.81s/it]Processing items:  20%|█▉        | 64/321 [09:25<37:40,  8.80s/it]Processing items:  20%|██        | 65/321 [09:33<37:33,  8.80s/it]Processing items:  21%|██        | 66/321 [09:42<37:23,  8.80s/it]Processing items:  21%|██        | 67/321 [09:51<37:16,  8.80s/it]Processing items:  21%|██        | 68/321 [10:00<37:01,  8.78s/it]Processing items:  21%|██▏       | 69/321 [10:09<36:51,  8.78s/it]Processing items:  22%|██▏       | 70/321 [10:17<36:37,  8.75s/it]Processing items:  22%|██▏       | 71/321 [10:26<36:31,  8.77s/it]Processing items:  22%|██▏       | 72/321 [10:35<36:21,  8.76s/it]Processing items:  23%|██▎       | 73/321 [10:44<36:26,  8.82s/it]Processing items:  23%|██▎       | 74/321 [10:53<36:14,  8.80s/it]Processing items:  23%|██▎       | 75/321 [11:01<36:04,  8.80s/it]Processing items:  24%|██▎       | 76/321 [11:10<35:55,  8.80s/it]Processing items:  24%|██▍       | 77/321 [11:19<35:43,  8.78s/it]Processing items:  24%|██▍       | 78/321 [11:28<35:33,  8.78s/it]Processing items:  25%|██▍       | 79/321 [11:36<35:25,  8.78s/it]Processing items:  25%|██▍       | 80/321 [11:45<35:11,  8.76s/it]Processing items:  25%|██▌       | 81/321 [11:54<35:03,  8.77s/it]Processing items:  26%|██▌       | 82/321 [12:03<34:56,  8.77s/it]Processing items:  26%|██▌       | 83/321 [12:12<34:50,  8.79s/it]Processing items:  26%|██▌       | 84/321 [12:20<34:42,  8.79s/it]Processing items:  26%|██▋       | 85/321 [12:29<34:33,  8.79s/it]Processing items:  27%|██▋       | 86/321 [12:38<34:30,  8.81s/it]Processing items:  27%|██▋       | 87/321 [12:47<34:15,  8.79s/it]Processing items:  27%|██▋       | 88/321 [12:55<34:06,  8.78s/it]Processing items:  28%|██▊       | 89/321 [13:04<33:58,  8.79s/it]Processing items:  28%|██▊       | 90/321 [13:13<33:51,  8.79s/it]Processing items:  28%|██▊       | 91/321 [13:22<33:41,  8.79s/it]Processing items:  29%|██▊       | 92/321 [13:31<33:35,  8.80s/it]Processing items:  29%|██▉       | 93/321 [13:39<33:22,  8.78s/it]Processing items:  29%|██▉       | 94/321 [13:48<33:14,  8.78s/it]Processing items:  30%|██▉       | 95/321 [13:57<33:02,  8.77s/it]Processing items:  30%|██▉       | 96/321 [14:06<32:58,  8.79s/it]Processing items:  30%|███       | 97/321 [14:15<32:43,  8.77s/it]Processing items:  31%|███       | 98/321 [14:23<32:37,  8.78s/it]Processing items:  31%|███       | 99/321 [14:32<32:26,  8.77s/it]Processing items:  31%|███       | 100/321 [14:41<32:22,  8.79s/it]Processing items:  31%|███▏      | 101/321 [14:50<32:12,  8.78s/it]Processing items:  32%|███▏      | 102/321 [14:58<32:00,  8.77s/it]Processing items:  32%|███▏      | 103/321 [15:07<31:52,  8.77s/it]Processing items:  32%|███▏      | 104/321 [15:16<31:45,  8.78s/it]Processing items:  33%|███▎      | 105/321 [15:25<31:37,  8.78s/it]Processing items:  33%|███▎      | 106/321 [15:34<31:26,  8.78s/it]Processing items:  33%|███▎      | 107/321 [15:42<31:17,  8.77s/it]Processing items:  34%|███▎      | 108/321 [15:51<31:06,  8.76s/it]Processing items:  34%|███▍      | 109/321 [16:00<30:59,  8.77s/it]Processing items:  34%|███▍      | 110/321 [16:09<30:46,  8.75s/it]Processing items:  35%|███▍      | 111/321 [16:17<30:39,  8.76s/it]Processing items:  35%|███▍      | 112/321 [16:26<30:34,  8.78s/it]Processing items:  35%|███▌      | 113/321 [16:35<30:30,  8.80s/it]Processing items:  36%|███▌      | 114/321 [16:44<30:19,  8.79s/it]Processing items:  36%|███▌      | 115/321 [16:53<30:11,  8.79s/it]Processing items:  36%|███▌      | 116/321 [17:01<30:00,  8.78s/it]Processing items:  36%|███▋      | 117/321 [17:10<29:53,  8.79s/it]Processing items:  37%|███▋      | 118/321 [17:19<29:44,  8.79s/it]Processing items:  37%|███▋      | 119/321 [17:28<29:36,  8.79s/it]Processing items:  37%|███▋      | 120/321 [17:36<29:24,  8.78s/it]Processing items:  38%|███▊      | 121/321 [17:45<29:16,  8.78s/it]Processing items:  38%|███▊      | 122/321 [17:54<29:09,  8.79s/it]Processing items:  38%|███▊      | 123/321 [18:03<28:58,  8.78s/it]Processing items:  39%|███▊      | 124/321 [18:12<28:49,  8.78s/it]Processing items:  39%|███▉      | 125/321 [18:20<28:37,  8.76s/it]Processing items:  39%|███▉      | 126/321 [18:29<28:33,  8.79s/it]Processing items:  40%|███▉      | 127/321 [18:38<28:23,  8.78s/it]Processing items:  40%|███▉      | 128/321 [18:47<28:16,  8.79s/it]Processing items:  40%|████      | 129/321 [18:55<28:05,  8.78s/it]Processing items:  40%|████      | 130/321 [19:04<27:58,  8.79s/it]Processing items:  41%|████      | 131/321 [19:13<27:50,  8.79s/it]Processing items:  41%|████      | 132/321 [19:22<27:43,  8.80s/it]Processing items:  41%|████▏     | 133/321 [19:31<27:32,  8.79s/it]Processing items:  42%|████▏     | 134/321 [19:40<27:26,  8.81s/it]Processing items:  42%|████▏     | 135/321 [19:48<27:15,  8.80s/it]Processing items:  42%|████▏     | 136/321 [19:57<27:07,  8.80s/it]Processing items:  43%|████▎     | 137/321 [20:06<26:59,  8.80s/it]Processing items:  43%|████▎     | 138/321 [20:15<26:51,  8.81s/it]Processing items:  43%|████▎     | 139/321 [20:24<26:41,  8.80s/it]Processing items:  44%|████▎     | 140/321 [20:32<26:32,  8.80s/it]Processing items:  44%|████▍     | 141/321 [20:41<26:22,  8.79s/it]Processing items:  44%|████▍     | 142/321 [20:50<26:12,  8.78s/it]Processing items:  45%|████▍     | 143/321 [20:59<26:06,  8.80s/it]Processing items:  45%|████▍     | 144/321 [21:08<26:00,  8.82s/it]Processing items:  45%|████▌     | 145/321 [21:16<25:50,  8.81s/it]Processing items:  45%|████▌     | 146/321 [21:25<25:48,  8.85s/it]Processing items:  46%|████▌     | 147/321 [21:34<25:51,  8.92s/it]Processing items:  46%|████▌     | 148/321 [21:43<25:32,  8.86s/it]Processing items:  46%|████▋     | 149/321 [21:52<25:18,  8.83s/it]Processing items:  47%|████▋     | 150/321 [22:01<25:05,  8.80s/it]Processing items:  47%|████▋     | 151/321 [22:09<24:58,  8.82s/it]Processing items:  47%|████▋     | 152/321 [22:18<24:46,  8.80s/it]Processing items:  48%|████▊     | 153/321 [22:27<24:37,  8.80s/it]Processing items:  48%|████▊     | 154/321 [22:36<24:27,  8.79s/it]Processing items:  48%|████▊     | 155/321 [22:45<24:17,  8.78s/it]Processing items:  49%|████▊     | 156/321 [22:53<24:09,  8.78s/it]Processing items:  49%|████▉     | 157/321 [23:02<24:00,  8.79s/it]Processing items:  49%|████▉     | 158/321 [23:11<23:53,  8.79s/it]Processing items:  50%|████▉     | 159/321 [23:20<23:46,  8.81s/it]Processing items:  50%|████▉     | 160/321 [23:28<23:35,  8.79s/it]Processing items:  50%|█████     | 161/321 [23:37<23:26,  8.79s/it]Processing items:  50%|█████     | 162/321 [23:46<23:16,  8.78s/it]Processing items:  51%|█████     | 163/321 [23:55<23:08,  8.79s/it]Processing items:  51%|█████     | 164/321 [24:04<23:00,  8.80s/it]Processing items:  51%|█████▏    | 165/321 [24:12<22:50,  8.78s/it]Processing items:  52%|█████▏    | 166/321 [24:21<22:42,  8.79s/it]Processing items:  52%|█████▏    | 167/321 [24:30<22:30,  8.77s/it]Processing items:  52%|█████▏    | 168/321 [24:39<22:21,  8.77s/it]Processing items:  53%|█████▎    | 169/321 [24:47<22:11,  8.76s/it]Processing items:  53%|█████▎    | 170/321 [24:56<22:03,  8.76s/it]Processing items:  53%|█████▎    | 171/321 [25:05<21:57,  8.78s/it]Processing items:  54%|█████▎    | 172/321 [25:14<21:48,  8.78s/it]Processing items:  54%|█████▍    | 173/321 [25:23<21:39,  8.78s/it]Processing items:  54%|█████▍    | 174/321 [25:31<21:33,  8.80s/it]Processing items:  55%|█████▍    | 175/321 [25:40<21:22,  8.78s/it]Processing items:  55%|█████▍    | 176/321 [25:49<21:13,  8.78s/it]Processing items:  55%|█████▌    | 177/321 [25:58<21:05,  8.79s/it]Processing items:  55%|█████▌    | 178/321 [26:07<20:58,  8.80s/it]Processing items:  56%|█████▌    | 179/321 [26:15<20:49,  8.80s/it]Processing items:  56%|█████▌    | 180/321 [26:24<20:43,  8.82s/it]Processing items:  56%|█████▋    | 181/321 [26:33<20:33,  8.81s/it]Processing items:  57%|█████▋    | 182/321 [26:42<20:24,  8.81s/it]Processing items:  57%|█████▋    | 183/321 [26:51<20:15,  8.81s/it]Processing items:  57%|█████▋    | 184/321 [26:59<20:04,  8.79s/it]Processing items:  58%|█████▊    | 185/321 [27:08<19:57,  8.81s/it]Processing items:  58%|█████▊    | 186/321 [27:17<19:48,  8.80s/it]Processing items:  58%|█████▊    | 187/321 [27:26<19:40,  8.81s/it]Processing items:  59%|█████▊    | 188/321 [27:35<19:29,  8.79s/it]Processing items:  59%|█████▉    | 189/321 [27:43<19:20,  8.79s/it]Processing items:  59%|█████▉    | 190/321 [27:52<19:09,  8.77s/it]Processing items:  60%|█████▉    | 191/321 [28:01<19:02,  8.79s/it]Processing items:  60%|█████▉    | 192/321 [28:10<18:53,  8.79s/it]Processing items:  60%|██████    | 193/321 [28:19<18:45,  8.79s/it]Processing items:  60%|██████    | 194/321 [28:27<18:37,  8.80s/it]Processing items:  61%|██████    | 195/321 [28:36<18:27,  8.79s/it]Processing items:  61%|██████    | 196/321 [28:45<18:17,  8.78s/it]Processing items:  61%|██████▏   | 197/321 [28:54<18:09,  8.78s/it]Processing items:  62%|██████▏   | 198/321 [29:02<18:00,  8.78s/it]Processing items:  62%|██████▏   | 199/321 [29:11<17:53,  8.80s/it]Processing items:  62%|██████▏   | 200/321 [29:20<17:45,  8.81s/it]Processing items:  63%|██████▎   | 201/321 [29:29<17:35,  8.80s/it]Processing items:  63%|██████▎   | 202/321 [29:38<17:25,  8.79s/it]Processing items:  63%|██████▎   | 203/321 [29:46<17:17,  8.79s/it]Processing items:  64%|██████▎   | 204/321 [29:55<17:08,  8.79s/it]Processing items:  64%|██████▍   | 205/321 [30:04<17:00,  8.80s/it]Processing items:  64%|██████▍   | 206/321 [30:13<16:50,  8.79s/it]Processing items:  64%|██████▍   | 207/321 [30:22<16:40,  8.77s/it]Processing items:  65%|██████▍   | 208/321 [30:30<16:32,  8.78s/it]Processing items:  65%|██████▌   | 209/321 [30:39<16:26,  8.81s/it]Processing items:  65%|██████▌   | 210/321 [30:48<16:17,  8.80s/it]Processing items:  66%|██████▌   | 211/321 [30:57<16:09,  8.82s/it]Processing items:  66%|██████▌   | 212/321 [31:06<16:01,  8.82s/it]Processing items:  66%|██████▋   | 213/321 [31:15<15:52,  8.82s/it]Processing items:  67%|██████▋   | 214/321 [31:23<15:43,  8.82s/it]Processing items:  67%|██████▋   | 215/321 [31:32<15:33,  8.81s/it]Processing items:  67%|██████▋   | 216/321 [31:41<15:24,  8.80s/it]Processing items:  68%|██████▊   | 217/321 [31:50<15:15,  8.80s/it]Processing items:  68%|██████▊   | 218/321 [31:58<15:04,  8.79s/it]Processing items:  68%|██████▊   | 219/321 [32:07<14:57,  8.80s/it]Processing items:  69%|██████▊   | 220/321 [32:16<14:47,  8.79s/it]Processing items:  69%|██████▉   | 221/321 [32:25<14:38,  8.78s/it]Processing items:  69%|██████▉   | 222/321 [32:34<14:36,  8.86s/it]Processing items:  69%|██████▉   | 223/321 [32:43<14:26,  8.84s/it]Processing items:  70%|██████▉   | 224/321 [32:51<14:15,  8.82s/it]Processing items:  70%|███████   | 225/321 [33:00<14:07,  8.83s/it]Processing items:  70%|███████   | 226/321 [33:09<13:58,  8.82s/it]Processing items:  71%|███████   | 227/321 [33:18<13:49,  8.82s/it]Processing items:  71%|███████   | 228/321 [33:27<13:40,  8.82s/it]Processing items:  71%|███████▏  | 229/321 [33:36<13:30,  8.81s/it]Processing items:  72%|███████▏  | 230/321 [33:44<13:20,  8.79s/it]Processing items:  72%|███████▏  | 231/321 [33:53<13:11,  8.80s/it]Processing items:  72%|███████▏  | 232/321 [34:02<13:03,  8.80s/it]Processing items:  73%|███████▎  | 233/321 [34:11<12:55,  8.82s/it]Processing items:  73%|███████▎  | 234/321 [34:20<12:48,  8.84s/it]Processing items:  73%|███████▎  | 235/321 [34:28<12:38,  8.82s/it]Processing items:  74%|███████▎  | 236/321 [34:37<12:29,  8.82s/it]Processing items:  74%|███████▍  | 237/321 [34:46<12:20,  8.82s/it]Processing items:  74%|███████▍  | 238/321 [34:55<12:11,  8.81s/it]Processing items:  74%|███████▍  | 239/321 [35:04<12:01,  8.80s/it]Processing items:  75%|███████▍  | 240/321 [35:12<11:52,  8.79s/it]Processing items:  75%|███████▌  | 241/321 [35:21<11:43,  8.80s/it]Processing items:  75%|███████▌  | 242/321 [35:30<11:34,  8.79s/it]Processing items:  76%|███████▌  | 243/321 [35:39<11:26,  8.80s/it]Processing items:  76%|███████▌  | 244/321 [35:48<11:18,  8.81s/it]Processing items:  76%|███████▋  | 245/321 [35:56<11:10,  8.83s/it]Processing items:  77%|███████▋  | 246/321 [36:05<11:01,  8.82s/it]Processing items:  77%|███████▋  | 247/321 [36:14<10:47,  8.75s/it]Processing items:  77%|███████▋  | 248/321 [36:23<10:36,  8.72s/it]Processing items:  78%|███████▊  | 249/321 [36:31<10:25,  8.68s/it]Processing items:  78%|███████▊  | 250/321 [36:40<10:14,  8.65s/it]Processing items:  78%|███████▊  | 251/321 [36:48<10:06,  8.66s/it]Processing items:  79%|███████▊  | 252/321 [36:57<09:58,  8.67s/it]Processing items:  79%|███████▉  | 253/321 [37:06<09:48,  8.66s/it]Processing items:  79%|███████▉  | 254/321 [37:14<09:38,  8.64s/it]Processing items:  79%|███████▉  | 255/321 [37:23<09:28,  8.62s/it]Processing items:  80%|███████▉  | 256/321 [37:31<09:19,  8.60s/it]Processing items:  80%|████████  | 257/321 [37:40<09:09,  8.59s/it]Processing items:  80%|████████  | 258/321 [37:49<09:01,  8.59s/it]Processing items:  81%|████████  | 259/321 [37:57<08:53,  8.61s/it]Processing items:  81%|████████  | 260/321 [38:07<09:14,  9.09s/it]Processing items:  81%|████████▏ | 261/321 [38:18<09:22,  9.37s/it]Processing items:  82%|████████▏ | 262/321 [38:28<09:29,  9.65s/it]Processing items:  82%|████████▏ | 263/321 [38:38<09:27,  9.79s/it]Processing items:  82%|████████▏ | 264/321 [38:48<09:17,  9.78s/it]Processing items:  83%|████████▎ | 265/321 [38:56<08:49,  9.46s/it]Processing items:  83%|████████▎ | 266/321 [39:05<08:26,  9.21s/it]Processing items:  83%|████████▎ | 267/321 [39:14<08:07,  9.02s/it]Processing items:  83%|████████▎ | 268/321 [39:22<07:51,  8.90s/it]Processing items:  84%|████████▍ | 269/321 [39:31<07:37,  8.80s/it]Processing items:  84%|████████▍ | 270/321 [39:39<07:25,  8.73s/it]Processing items:  84%|████████▍ | 271/321 [39:48<07:15,  8.70s/it]Processing items:  85%|████████▍ | 272/321 [39:57<07:05,  8.69s/it]Processing items:  85%|████████▌ | 273/321 [40:07<07:15,  9.07s/it]Processing items:  85%|████████▌ | 274/321 [40:17<07:20,  9.38s/it]Processing items:  86%|████████▌ | 275/321 [40:27<07:23,  9.64s/it]Processing items:  86%|████████▌ | 276/321 [40:37<07:21,  9.81s/it]Processing items:  86%|████████▋ | 277/321 [40:47<07:07,  9.71s/it]Processing items:  87%|████████▋ | 278/321 [40:55<06:44,  9.40s/it]Processing items:  87%|████████▋ | 279/321 [41:04<06:24,  9.16s/it]Processing items:  87%|████████▋ | 280/321 [41:13<06:09,  9.02s/it]Processing items:  88%|████████▊ | 281/321 [41:21<05:55,  8.89s/it]Processing items:  88%|████████▊ | 282/321 [41:30<05:43,  8.80s/it]Processing items:  88%|████████▊ | 283/321 [41:38<05:31,  8.74s/it]Processing items:  88%|████████▊ | 284/321 [41:47<05:21,  8.70s/it]Processing items:  89%|████████▉ | 285/321 [41:56<05:12,  8.67s/it]Processing items:  89%|████████▉ | 286/321 [42:05<05:12,  8.93s/it]Processing items:  89%|████████▉ | 287/321 [42:15<05:16,  9.32s/it]Processing items:  90%|████████▉ | 288/321 [42:25<05:15,  9.55s/it]Processing items:  90%|█████████ | 289/321 [42:36<05:11,  9.75s/it]Processing items:  90%|█████████ | 290/321 [42:45<05:00,  9.69s/it]Processing items:  91%|█████████ | 291/321 [42:54<04:41,  9.39s/it]Processing items:  91%|█████████ | 292/321 [43:02<04:25,  9.14s/it]Processing items:  91%|█████████▏| 293/321 [43:11<04:11,  8.97s/it]Processing items:  92%|█████████▏| 294/321 [43:20<03:58,  8.84s/it]Processing items:  92%|█████████▏| 295/321 [43:28<03:48,  8.77s/it]Processing items:  92%|█████████▏| 296/321 [43:37<03:37,  8.70s/it]Processing items:  93%|█████████▎| 297/321 [43:45<03:27,  8.66s/it]Processing items:  93%|█████████▎| 298/321 [43:54<03:18,  8.63s/it]Processing items:  93%|█████████▎| 299/321 [44:03<03:11,  8.71s/it]Processing items:  93%|█████████▎| 300/321 [44:13<03:12,  9.16s/it]Processing items:  94%|█████████▍| 301/321 [44:23<03:08,  9.43s/it]Processing items:  94%|█████████▍| 302/321 [44:33<02:59,  9.46s/it]Processing items:  94%|█████████▍| 303/321 [44:43<02:56,  9.79s/it]Processing items:  95%|█████████▍| 304/321 [44:52<02:42,  9.53s/it]Processing items:  95%|█████████▌| 305/321 [45:01<02:29,  9.36s/it]Processing items:  95%|█████████▌| 306/321 [45:10<02:17,  9.14s/it]Processing items:  96%|█████████▌| 307/321 [45:18<02:05,  8.98s/it]Processing items:  96%|█████████▌| 308/321 [45:27<01:55,  8.86s/it]Processing items:  96%|█████████▋| 309/321 [45:35<01:45,  8.78s/it]Processing items:  97%|█████████▋| 310/321 [45:44<01:35,  8.72s/it]Processing items:  97%|█████████▋| 311/321 [45:53<01:26,  8.69s/it]Processing items:  97%|█████████▋| 312/321 [46:01<01:18,  8.71s/it]Processing items:  98%|█████████▊| 313/321 [46:12<01:13,  9.22s/it]Processing items:  98%|█████████▊| 314/321 [46:22<01:06,  9.49s/it]Processing items:  98%|█████████▊| 315/321 [46:31<00:56,  9.48s/it]Processing items:  98%|█████████▊| 316/321 [46:41<00:48,  9.69s/it]Processing items:  99%|█████████▉| 317/321 [46:50<00:37,  9.37s/it]Processing items:  99%|█████████▉| 318/321 [46:59<00:27,  9.15s/it]Processing items:  99%|█████████▉| 319/321 [47:07<00:17,  8.98s/it]Processing items: 100%|█████████▉| 320/321 [47:16<00:08,  8.88s/it]Processing items: 100%|██████████| 321/321 [47:25<00:00,  8.80s/it]Processing items: 100%|██████████| 321/321 [47:25<00:00,  8.86s/it]

================================================================================
PROCESSING ROW 1/321
Image: bjp_plate2-b3_LR_8_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4360, -0.4443,  1.3018,  ..., -0.7954, -1.5898, -0.3657]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1904, -0.6396,  1.5439,  ..., -0.9922, -2.2285, -0.4312]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7070, -0.3154,  0.5327,  ..., -1.3740, -1.5449, -0.7148]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.5107,  0.7749,  ..., -1.5703, -2.1836, -0.7803]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3750, -0.4780, -0.0414,  ..., -0.6660, -0.2253, -1.2168]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6211, -0.6733,  0.2009,  ..., -0.8623, -0.8643, -1.2822]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5547,  0.2742, -0.4138,  ..., -0.4080, -0.1100, -0.9727]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8008,  0.0787, -0.1715,  ..., -0.6045, -0.7485, -1.0381]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6455,  1.2002,  1.0654,  ..., -0.7412, -0.2208, -1.5273]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8911,  1.0049,  1.3076,  ..., -0.9375, -0.8594, -1.5928]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2869,  0.3291,  1.5723,  ...,  0.4180, -0.8525, -1.3477]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5322,  0.1337,  1.8145,  ...,  0.2214, -1.4912, -1.4131]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 2/321
Image: XZ2_set.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4609, -0.4141,  1.4766,  ..., -0.6948, -1.6758, -0.3574]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2153, -0.6094,  1.7188,  ..., -0.8916, -2.3145, -0.4229]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6699, -0.4690,  0.6611,  ..., -1.6250, -1.5996, -0.6470]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9160, -0.6646,  0.9033,  ..., -1.8213, -2.2383, -0.7124]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3135, -0.6333,  0.0400,  ..., -0.9609, -0.1934, -1.2510]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5586, -0.8286,  0.2822,  ..., -1.1572, -0.8320, -1.3164]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4570,  0.2834, -0.4136,  ..., -0.4368, -0.0723, -0.9272]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7031,  0.0880, -0.1713,  ..., -0.6333, -0.7109, -0.9927]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5557,  1.2354,  1.0322,  ..., -0.7725, -0.1827, -1.4395]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8013,  1.0400,  1.2744,  ..., -0.9688, -0.8213, -1.5049]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2456,  0.2734,  1.5312,  ...,  0.4292, -0.8521, -1.2871]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4912,  0.0780,  1.7734,  ...,  0.2327, -1.4902, -1.3525]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 3/321
Image: 70568_1_E1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4082, -0.3806,  1.2676,  ..., -0.7676, -1.6279, -0.3555]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1626, -0.5762,  1.5098,  ..., -0.9639, -2.2656, -0.4209]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7627, -0.2529,  0.5532,  ..., -1.4023, -1.6084, -0.7393]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0078, -0.4482,  0.7954,  ..., -1.5986, -2.2461, -0.8047]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4316, -0.4604,  0.1221,  ..., -0.8687, -0.2688, -1.2402]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6777, -0.6558,  0.3645,  ..., -1.0654, -0.9072, -1.3057]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5205,  0.2913, -0.3508,  ..., -0.4048, -0.1158, -0.9497]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7656,  0.0958, -0.1085,  ..., -0.6016, -0.7544, -1.0156]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5078,  1.2012,  1.0771,  ..., -0.7793, -0.1364, -1.4492]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7534,  1.0059,  1.3193,  ..., -0.9756, -0.7749, -1.5146]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2908,  0.3311,  1.5664,  ...,  0.4578, -0.8823, -1.3584]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5361,  0.1356,  1.8086,  ...,  0.2612, -1.5215, -1.4238]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 4/321
Image: wrv7-6b.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4453, -0.4028,  1.3975,  ..., -0.7676, -1.6562, -0.3770]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1997, -0.5981,  1.6396,  ..., -0.9639, -2.2949, -0.4424]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6973, -0.3240,  0.5186,  ..., -1.4580, -1.5762, -0.7119]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9434, -0.5195,  0.7607,  ..., -1.6543, -2.2148, -0.7773]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3037, -0.4810, -0.0596,  ..., -0.7197, -0.1471, -1.1797]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5488, -0.6763,  0.1827,  ..., -0.9160, -0.7856, -1.2451]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5166,  0.2749, -0.3420,  ..., -0.4268, -0.0836, -0.9209]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.0795, -0.0997,  ..., -0.6230, -0.7222, -0.9863]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6445,  1.2334,  1.0850,  ..., -0.7642, -0.1732, -1.5420]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8901,  1.0381,  1.3271,  ..., -0.9609, -0.8120, -1.6074]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2593,  0.3357,  1.5762,  ...,  0.4146, -0.8135, -1.3574]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5049,  0.1403,  1.8184,  ...,  0.2180, -1.4521, -1.4229]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 5/321
Image: T2265_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3560, -0.4363,  1.3447,  ..., -0.7305, -1.6816, -0.3423]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1104, -0.6318,  1.5869,  ..., -0.9268, -2.3203, -0.4077]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7705, -0.2190,  0.5342,  ..., -1.4629, -1.5840, -0.6426]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0156, -0.4146,  0.7764,  ..., -1.6592, -2.2227, -0.7080]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2998, -0.5469, -0.0335,  ..., -0.6685, -0.1815, -1.1201]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5449, -0.7422,  0.2089,  ..., -0.8652, -0.8203, -1.1855]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5400,  0.2603, -0.3481,  ..., -0.4219, -0.1089, -0.8887]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7852,  0.0648, -0.1058,  ..., -0.6182, -0.7476, -0.9541]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6909,  1.2207,  1.0850,  ..., -0.8198, -0.1696, -1.5430]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9365,  1.0254,  1.3271,  ..., -1.0166, -0.8081, -1.6084]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3198,  0.3589,  1.6348,  ...,  0.3518, -0.8647, -1.3545]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5654,  0.1635,  1.8770,  ...,  0.1553, -1.5039, -1.4199]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 6/321
Image: 206239a1_1MKI_z0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4072, -0.3931,  1.3145,  ..., -0.7681, -1.6221, -0.3765]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1616, -0.5884,  1.5566,  ..., -0.9648, -2.2617, -0.4419]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7354, -0.4033,  0.6489,  ..., -1.5371, -1.5352, -0.7075]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9805, -0.5986,  0.8911,  ..., -1.7334, -2.1738, -0.7729]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3887, -0.4175, -0.0247,  ..., -0.6885, -0.1581, -1.1875]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6348, -0.6128,  0.2177,  ..., -0.8848, -0.7969, -1.2529]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5176,  0.3066, -0.3508,  ..., -0.4812, -0.0830, -0.9497]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7637,  0.1112, -0.1085,  ..., -0.6777, -0.7217, -1.0156]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6475,  1.1416,  1.0957,  ..., -0.7295, -0.0653, -1.4375]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8931,  0.9463,  1.3379,  ..., -0.9258, -0.7041, -1.5029]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2803,  0.3369,  1.5635,  ...,  0.4265, -0.9028, -1.3613]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5259,  0.1415,  1.8057,  ...,  0.2300, -1.5410, -1.4268]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 7/321
Image: xAs1.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4956, -0.3782,  1.4883,  ..., -0.7549, -1.6582, -0.4009]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2500, -0.5737,  1.7305,  ..., -0.9512, -2.2969, -0.4663]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6377, -0.4333,  0.6182,  ..., -1.6465, -1.5088, -0.6641]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8828, -0.6289,  0.8604,  ..., -1.8428, -2.1484, -0.7295]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2773, -0.5879,  0.1366,  ..., -0.9131, -0.1461, -1.2344]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5234, -0.7832,  0.3789,  ..., -1.1094, -0.7847, -1.2998]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4580,  0.3181, -0.3633,  ..., -0.4478, -0.1069, -0.9146]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7031,  0.1227, -0.1210,  ..., -0.6445, -0.7456, -0.9800]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5156,  1.2334,  1.0439,  ..., -0.8125, -0.1148, -1.4277]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7612,  1.0381,  1.2861,  ..., -1.0088, -0.7534, -1.4932]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2686,  0.2788,  1.5488,  ...,  0.4097, -0.8608, -1.3672]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5142,  0.0834,  1.7910,  ...,  0.2131, -1.5000, -1.4326]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 8/321
Image: zxp4-9.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3635, -0.3938,  1.3320,  ..., -0.8237, -1.5869, -0.3921]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1179, -0.5894,  1.5742,  ..., -1.0205, -2.2266, -0.4575]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6836, -0.4216,  0.6338,  ..., -1.4824, -1.5557, -0.7588]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9297, -0.6172,  0.8760,  ..., -1.6787, -2.1953, -0.8242]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4180, -0.3857, -0.0463,  ..., -0.6689, -0.1564, -1.2461]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6641, -0.5811,  0.1960,  ..., -0.8652, -0.7949, -1.3115]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5342,  0.3301, -0.3503,  ..., -0.4790, -0.0900, -0.9487]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7793,  0.1346, -0.1080,  ..., -0.6758, -0.7285, -1.0146]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6279,  1.1934,  1.0342,  ..., -0.7661, -0.2010, -1.4805]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8735,  0.9980,  1.2764,  ..., -0.9629, -0.8398, -1.5459]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2964,  0.3452,  1.5977,  ...,  0.4038, -0.8604, -1.3662]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5420,  0.1498,  1.8398,  ...,  0.2073, -1.4990, -1.4316]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 9/321
Image: CAA0080_NADH_data.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4678, -0.4399,  1.4092,  ..., -0.7710, -1.6797, -0.3706]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2222, -0.6353,  1.6514,  ..., -0.9678, -2.3184, -0.4360]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6777, -0.4346,  0.6426,  ..., -1.6426, -1.6074, -0.6865]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9238, -0.6299,  0.8848,  ..., -1.8389, -2.2461, -0.7520]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2676, -0.5098, -0.0419,  ..., -0.7241, -0.1785, -1.2461]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5137, -0.7051,  0.2004,  ..., -0.9209, -0.8174, -1.3115]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4941,  0.2705, -0.3633,  ..., -0.4741, -0.1160, -0.9717]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7402,  0.0751, -0.1210,  ..., -0.6709, -0.7549, -1.0371]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6455,  1.1035,  1.1357,  ..., -0.7891, -0.1466, -1.4570]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8911,  0.9082,  1.3779,  ..., -0.9854, -0.7852, -1.5225]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2781,  0.3013,  1.5469,  ...,  0.4199, -0.8799, -1.3320]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5234,  0.1058,  1.7891,  ...,  0.2234, -1.5186, -1.3975]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 10/321
Image: 35270_1_E2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3630, -0.3931,  1.2812,  ..., -0.7676, -1.6543, -0.3306]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1174, -0.5884,  1.5234,  ..., -0.9639, -2.2930, -0.3960]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7510, -0.2549,  0.6084,  ..., -1.3721, -1.6416, -0.7021]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9961, -0.4502,  0.8506,  ..., -1.5684, -2.2812, -0.7676]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4805, -0.4385,  0.0497,  ..., -0.8447, -0.2607, -1.2383]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7266, -0.6338,  0.2920,  ..., -1.0410, -0.8994, -1.3037]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5137,  0.2671, -0.3730,  ..., -0.3945, -0.1012, -0.9248]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.0717, -0.1307,  ..., -0.5908, -0.7397, -0.9902]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5547,  1.2051,  1.0508,  ..., -0.7183, -0.1682, -1.4531]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8003,  1.0098,  1.2930,  ..., -0.9150, -0.8066, -1.5186]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3245,  0.3240,  1.6016,  ...,  0.4824, -0.8867, -1.3086]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5703,  0.1285,  1.8438,  ...,  0.2859, -1.5254, -1.3740]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 11/321
Image: a2g5g-peak.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4546, -0.3970,  1.4219,  ..., -0.7432, -1.6826, -0.3799]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2090, -0.5923,  1.6641,  ..., -0.9395, -2.3203, -0.4453]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7158, -0.2878,  0.5640,  ..., -1.4473, -1.5918, -0.6895]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9609, -0.4834,  0.8062,  ..., -1.6436, -2.2305, -0.7549]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3389, -0.5977,  0.0536,  ..., -0.9155, -0.2450, -1.2285]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5840, -0.7930,  0.2959,  ..., -1.1123, -0.8838, -1.2939]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4883,  0.2815, -0.3708,  ..., -0.4121, -0.1057, -0.8784]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7344,  0.0861, -0.1285,  ..., -0.6084, -0.7441, -0.9438]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5361,  1.1963,  1.1250,  ..., -0.7598, -0.0939, -1.3984]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7817,  1.0010,  1.3672,  ..., -0.9561, -0.7324, -1.4639]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3057,  0.2773,  1.5479,  ...,  0.3926, -0.9243, -1.3232]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5513,  0.0819,  1.7900,  ...,  0.1960, -1.5625, -1.3887]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 12/321
Image: hok2-8.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4243, -0.3784,  1.3604,  ..., -0.7622, -1.6123, -0.3779]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1787, -0.5737,  1.6025,  ..., -0.9590, -2.2500, -0.4434]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7158, -0.2747,  0.5200,  ..., -1.4150, -1.5361, -0.7095]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9609, -0.4702,  0.7622,  ..., -1.6113, -2.1758, -0.7749]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3760, -0.4556, -0.0762,  ..., -0.6519, -0.1407, -1.2090]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6211, -0.6509,  0.1661,  ..., -0.8486, -0.7793, -1.2744]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5322,  0.3137, -0.3518,  ..., -0.4028, -0.0790, -0.9409]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7773,  0.1183, -0.1095,  ..., -0.5996, -0.7178, -1.0068]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6426,  1.2295,  1.0947,  ..., -0.7524, -0.1790, -1.4980]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8882,  1.0342,  1.3369,  ..., -0.9492, -0.8174, -1.5635]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2712,  0.3186,  1.5918,  ...,  0.4436, -0.8389, -1.3066]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5166,  0.1232,  1.8340,  ...,  0.2471, -1.4775, -1.3721]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 13/321
Image: IDP01304_3hho.0501.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4111, -0.4170,  1.3965,  ..., -0.7603, -1.6484, -0.3794]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1655, -0.6123,  1.6387,  ..., -0.9570, -2.2871, -0.4448]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6895, -0.4250,  0.6289,  ..., -1.5967, -1.5332, -0.6641]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9355, -0.6206,  0.8711,  ..., -1.7930, -2.1719, -0.7295]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4160, -0.5059,  0.0292,  ..., -0.8867, -0.1925, -1.2588]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6621, -0.7012,  0.2715,  ..., -1.0830, -0.8311, -1.3242]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5059,  0.3047, -0.3740,  ..., -0.4297, -0.0785, -0.9131]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7520,  0.1093, -0.1317,  ..., -0.6260, -0.7173, -0.9785]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5483,  1.2119,  0.9990,  ..., -0.8359, -0.1119, -1.4395]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7939,  1.0166,  1.2412,  ..., -1.0322, -0.7505, -1.5049]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2930,  0.2852,  1.5283,  ...,  0.4170, -0.8726, -1.3545]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5386,  0.0897,  1.7705,  ...,  0.2205, -1.5117, -1.4199]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 14/321
Image: ProlWT_Mn_Pro100_2_00001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3633, -0.3984,  1.2705,  ..., -0.7920, -1.6045, -0.3887]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1177, -0.5938,  1.5127,  ..., -0.9883, -2.2422, -0.4541]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7266, -0.2942,  0.5723,  ..., -1.3506, -1.5967, -0.7822]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9727, -0.4897,  0.8145,  ..., -1.5469, -2.2344, -0.8477]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.5186, -0.4893,  0.1048,  ..., -0.8838, -0.2830, -1.2959]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7637, -0.6846,  0.3472,  ..., -1.0801, -0.9219, -1.3613]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5332,  0.2510, -0.3975,  ..., -0.3853, -0.0851, -0.9287]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7793,  0.0555, -0.1552,  ..., -0.5820, -0.7236, -0.9941]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5405,  1.1885,  1.0371,  ..., -0.7422, -0.1595, -1.4600]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7861,  0.9932,  1.2793,  ..., -0.9385, -0.7983, -1.5254]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2935,  0.2969,  1.5566,  ...,  0.4468, -0.8760, -1.3379]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5391,  0.1014,  1.7988,  ...,  0.2502, -1.5146, -1.4033]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 15/321
Image: vmk5_7_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4170, -0.4419,  1.3203,  ..., -0.7422, -1.6904, -0.3555]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1714, -0.6372,  1.5625,  ..., -0.9385, -2.3281, -0.4209]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7266, -0.2578,  0.4976,  ..., -1.4541, -1.6250, -0.7124]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9727, -0.4531,  0.7397,  ..., -1.6504, -2.2637, -0.7778]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3643, -0.5947,  0.1674,  ..., -0.9053, -0.3018, -1.1963]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6094, -0.7900,  0.4097,  ..., -1.1016, -0.9404, -1.2617]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5137,  0.2253, -0.3779,  ..., -0.3828, -0.1024, -0.8911]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.0299, -0.1356,  ..., -0.5791, -0.7412, -0.9565]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5576,  1.2061,  1.0762,  ..., -0.7920, -0.1260, -1.4941]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8032,  1.0107,  1.3184,  ..., -0.9883, -0.7646, -1.5596]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2827,  0.3076,  1.5732,  ...,  0.4014, -0.8623, -1.3672]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5283,  0.1122,  1.8154,  ...,  0.2048, -1.5010, -1.4326]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 16/321
Image: 11921_7_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3755, -0.4714,  1.2646,  ..., -0.7520, -1.6914, -0.3022]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1299, -0.6670,  1.5068,  ..., -0.9482, -2.3301, -0.3677]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7725, -0.2986,  0.5161,  ..., -1.4014, -1.6426, -0.6602]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0176, -0.4941,  0.7583,  ..., -1.5977, -2.2812, -0.7256]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3906, -0.5181, -0.0985,  ..., -0.6377, -0.2268, -1.1572]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6367, -0.7134,  0.1438,  ..., -0.8340, -0.8652, -1.2227]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5908,  0.2751, -0.3584,  ..., -0.4248, -0.1189, -0.9009]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8359,  0.0797, -0.1161,  ..., -0.6211, -0.7578, -0.9663]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6836,  1.1426,  1.0986,  ..., -0.8213, -0.1439, -1.5156]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9292,  0.9473,  1.3408,  ..., -1.0176, -0.7827, -1.5811]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3218,  0.3555,  1.5098,  ...,  0.4216, -0.8960, -1.3242]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5674,  0.1600,  1.7520,  ...,  0.2251, -1.5352, -1.3896]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 17/321
Image: uqd2-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3503, -0.3733,  1.3613,  ..., -0.8252, -1.5996, -0.3955]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1047, -0.5688,  1.6035,  ..., -1.0215, -2.2383, -0.4609]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7139, -0.2844,  0.5137,  ..., -1.3623, -1.5186, -0.7373]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9590, -0.4800,  0.7559,  ..., -1.5586, -2.1562, -0.8027]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3906, -0.4468, -0.0344,  ..., -0.6763, -0.1782, -1.2012]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6367, -0.6421,  0.2079,  ..., -0.8730, -0.8169, -1.2666]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5518,  0.3340, -0.3359,  ..., -0.4451, -0.1230, -0.9316]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7969,  0.1385, -0.0936,  ..., -0.6416, -0.7617, -0.9971]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6230,  1.2305,  1.0781,  ..., -0.7578, -0.1957, -1.5010]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8687,  1.0352,  1.3203,  ..., -0.9541, -0.8345, -1.5664]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3044,  0.3582,  1.5938,  ...,  0.4038, -0.8477, -1.3477]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5498,  0.1627,  1.8359,  ...,  0.2073, -1.4863, -1.4131]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 18/321
Image: 65408_2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4448, -0.3794,  1.3262,  ..., -0.7285, -1.6562, -0.3540]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1992, -0.5747,  1.5684,  ..., -0.9248, -2.2949, -0.4194]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7324, -0.2598,  0.5591,  ..., -1.4053, -1.5928, -0.7061]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9785, -0.4551,  0.8013,  ..., -1.6016, -2.2305, -0.7715]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4062, -0.5049,  0.0821,  ..., -0.8696, -0.2336, -1.2490]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6523, -0.7002,  0.3245,  ..., -1.0664, -0.8721, -1.3145]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4736,  0.2727, -0.3748,  ..., -0.3848, -0.0991, -0.9141]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7188,  0.0773, -0.1324,  ..., -0.5811, -0.7378, -0.9795]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5493,  1.2393,  1.0684,  ..., -0.7603, -0.1519, -1.4502]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7949,  1.0439,  1.3105,  ..., -0.9570, -0.7905, -1.5156]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2725,  0.3022,  1.5547,  ...,  0.4478, -0.8955, -1.3359]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5181,  0.1068,  1.7969,  ...,  0.2512, -1.5342, -1.4014]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 19/321
Image: IDP91419-8.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3894, -0.3774,  1.2900,  ..., -0.7842, -1.6045, -0.3735]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1438, -0.5728,  1.5322,  ..., -0.9805, -2.2422, -0.4390]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7012, -0.2656,  0.5405,  ..., -1.3936, -1.5430, -0.7681]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9473, -0.4609,  0.7827,  ..., -1.5898, -2.1816, -0.8335]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4736, -0.4785,  0.1172,  ..., -0.8696, -0.2289, -1.3115]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7188, -0.6738,  0.3594,  ..., -1.0664, -0.8677, -1.3770]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5391,  0.3125, -0.3679,  ..., -0.3862, -0.1016, -0.9619]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7852,  0.1171, -0.1256,  ..., -0.5830, -0.7402, -1.0273]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5459,  1.2080,  1.0488,  ..., -0.7285, -0.1652, -1.4551]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7915,  1.0127,  1.2910,  ..., -0.9248, -0.8037, -1.5205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2747,  0.2927,  1.5371,  ...,  0.4795, -0.8599, -1.3086]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5205,  0.0973,  1.7793,  ...,  0.2830, -1.4980, -1.3740]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 20/321
Image: klb5-1-snaps.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3970, -0.3687,  1.3936,  ..., -0.7773, -1.6279, -0.3774]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1514, -0.5640,  1.6357,  ..., -0.9736, -2.2656, -0.4429]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7100, -0.2666,  0.4780,  ..., -1.4297, -1.4717, -0.7236]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9551, -0.4619,  0.7202,  ..., -1.6260, -2.1094, -0.7891]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4336, -0.5166,  0.0665,  ..., -0.9438, -0.2131, -1.2529]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6797, -0.7119,  0.3088,  ..., -1.1406, -0.8516, -1.3184]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5342,  0.3340, -0.3870,  ..., -0.4204, -0.1494, -0.9097]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7793,  0.1385, -0.1447,  ..., -0.6172, -0.7881, -0.9751]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5225,  1.2373,  1.0342,  ..., -0.7559, -0.1750, -1.4326]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7681,  1.0420,  1.2764,  ..., -0.9521, -0.8135, -1.4980]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2756,  0.2979,  1.5186,  ...,  0.4395, -0.8818, -1.3203]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5215,  0.1024,  1.7607,  ...,  0.2429, -1.5205, -1.3857]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 21/321
Image: IDP00499_3IIE.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4170, -0.4658,  1.4180,  ..., -0.7705, -1.7119, -0.3716]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1714, -0.6611,  1.6602,  ..., -0.9668, -2.3516, -0.4370]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6562, -0.4651,  0.6318,  ..., -1.6240, -1.6670, -0.6494]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9023, -0.6606,  0.8740,  ..., -1.8203, -2.3047, -0.7148]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3066, -0.5063, -0.1142,  ..., -0.6782, -0.1946, -1.2275]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5527, -0.7017,  0.1282,  ..., -0.8750, -0.8330, -1.2930]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5303,  0.2854, -0.3770,  ..., -0.4463, -0.1111, -0.9224]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7754,  0.0900, -0.1346,  ..., -0.6426, -0.7500, -0.9878]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6548,  1.1611,  1.0977,  ..., -0.8076, -0.1113, -1.4746]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9004,  0.9658,  1.3398,  ..., -1.0039, -0.7500, -1.5400]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3296,  0.3076,  1.5547,  ...,  0.4033, -0.8589, -1.3457]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5752,  0.1122,  1.7969,  ...,  0.2068, -1.4980, -1.4111]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 22/321
Image: x4-data.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4966, -0.3857,  1.5498,  ..., -0.7031, -1.6836, -0.4019]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2510, -0.5811,  1.7920,  ..., -0.8994, -2.3223, -0.4673]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7246, -0.3169,  0.4814,  ..., -1.5361, -1.4541, -0.6919]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9707, -0.5122,  0.7236,  ..., -1.7324, -2.0938, -0.7573]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2197, -0.6841,  0.0706,  ..., -0.9658, -0.1606, -1.2061]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4648, -0.8794,  0.3130,  ..., -1.1621, -0.7993, -1.2715]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4355,  0.2830, -0.3613,  ..., -0.4138, -0.1329, -0.8662]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6816,  0.0875, -0.1190,  ..., -0.6104, -0.7715, -0.9316]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5449,  1.3184,  1.0615,  ..., -0.8018, -0.1118, -1.4473]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7905,  1.1230,  1.3037,  ..., -0.9980, -0.7505, -1.5127]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2654,  0.3159,  1.5459,  ...,  0.4077, -0.8457, -1.3379]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5107,  0.1205,  1.7881,  ...,  0.2112, -1.4844, -1.4033]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 23/321
Image: MEMMCSG4F9eg-peak.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4609, -0.4033,  1.4346,  ..., -0.7480, -1.6914, -0.3911]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2153, -0.5986,  1.6768,  ..., -0.9443, -2.3301, -0.4565]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6641, -0.4277,  0.6514,  ..., -1.6367, -1.5586, -0.6777]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9102, -0.6230,  0.8936,  ..., -1.8330, -2.1973, -0.7432]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.1885, -0.5234,  0.0088,  ..., -0.7559, -0.1482, -1.2207]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4336, -0.7188,  0.2512,  ..., -0.9521, -0.7871, -1.2861]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4678,  0.2764, -0.3516,  ..., -0.4480, -0.1282, -0.9429]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7129,  0.0809, -0.1093,  ..., -0.6445, -0.7666, -1.0088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6318,  1.1963,  1.0898,  ..., -0.8047, -0.1774, -1.5039]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8774,  1.0010,  1.3320,  ..., -1.0010, -0.8159, -1.5693]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2854,  0.2888,  1.6094,  ...,  0.3855, -0.8369, -1.3574]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5312,  0.0934,  1.8516,  ...,  0.1890, -1.4756, -1.4229]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 24/321
Image: atpnp-data-1.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4941, -0.4058,  1.4443,  ..., -0.7588, -1.6582, -0.4019]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2485, -0.6011,  1.6865,  ..., -0.9551, -2.2969, -0.4673]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6904, -0.3171,  0.4790,  ..., -1.4912, -1.5049, -0.6665]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9355, -0.5127,  0.7212,  ..., -1.6875, -2.1445, -0.7319]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3115, -0.6411,  0.1014,  ..., -0.9355, -0.2061, -1.2461]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5566, -0.8364,  0.3438,  ..., -1.1318, -0.8447, -1.3115]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5166,  0.2925, -0.3738,  ..., -0.4229, -0.1207, -0.9141]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.0970, -0.1315,  ..., -0.6191, -0.7593, -0.9795]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5693,  1.3027,  1.0459,  ..., -0.7754, -0.1650, -1.4707]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8149,  1.1074,  1.2881,  ..., -0.9717, -0.8037, -1.5361]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2695,  0.2979,  1.5176,  ...,  0.4004, -0.8643, -1.3711]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5151,  0.1024,  1.7598,  ...,  0.2039, -1.5029, -1.4365]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 25/321
Image: lof5-5_lowres_b.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4172, -0.3950,  1.3652,  ..., -0.8164, -1.6094, -0.3755]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1716, -0.5903,  1.6074,  ..., -1.0127, -2.2480, -0.4409]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7471, -0.3103,  0.4626,  ..., -1.4160, -1.5107, -0.6978]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9922, -0.5059,  0.7051,  ..., -1.6123, -2.1484, -0.7632]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3457, -0.4609, -0.0570,  ..., -0.6553, -0.1765, -1.2031]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5918, -0.6562,  0.1853,  ..., -0.8516, -0.8154, -1.2686]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5713,  0.3433, -0.3645,  ..., -0.4146, -0.1149, -0.9312]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8164,  0.1478, -0.1222,  ..., -0.6113, -0.7534, -0.9966]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6538,  1.2539,  1.0762,  ..., -0.7617, -0.2311, -1.5332]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8994,  1.0586,  1.3184,  ..., -0.9580, -0.8696, -1.5986]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2852,  0.3462,  1.5684,  ...,  0.4263, -0.8618, -1.3359]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5308,  0.1508,  1.8105,  ...,  0.2297, -1.5000, -1.4014]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 26/321
Image: 100666_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3848, -0.3718,  1.2549,  ..., -0.7832, -1.6152, -0.3687]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1392, -0.5674,  1.4971,  ..., -0.9795, -2.2539, -0.4341]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7422, -0.2781,  0.5596,  ..., -1.3623, -1.6191, -0.7725]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9883, -0.4736,  0.8018,  ..., -1.5586, -2.2578, -0.8379]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4707, -0.4355,  0.0941,  ..., -0.8438, -0.2671, -1.2852]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7168, -0.6309,  0.3364,  ..., -1.0400, -0.9058, -1.3506]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5176,  0.2659, -0.3467,  ..., -0.3862, -0.0969, -0.9546]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7637,  0.0704, -0.1044,  ..., -0.5830, -0.7354, -1.0205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5645,  1.2139,  1.0557,  ..., -0.7471, -0.1494, -1.4678]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8101,  1.0186,  1.2979,  ..., -0.9434, -0.7881, -1.5332]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2964,  0.3149,  1.5791,  ...,  0.4556, -0.8936, -1.3555]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5420,  0.1195,  1.8213,  ...,  0.2590, -1.5322, -1.4209]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 27/321
Image: IDP05262M3B3_PKa.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5020, -0.3577,  1.5498,  ..., -0.7153, -1.6709, -0.3921]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2563, -0.5532,  1.7920,  ..., -0.9121, -2.3086, -0.4575]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7471, -0.3206,  0.4512,  ..., -1.4775, -1.4473, -0.6948]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9922, -0.5161,  0.6934,  ..., -1.6738, -2.0859, -0.7603]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2578, -0.6616,  0.0483,  ..., -0.9463, -0.1404, -1.2422]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5039, -0.8569,  0.2905,  ..., -1.1426, -0.7793, -1.3076]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4443,  0.3025, -0.3293,  ..., -0.3918, -0.1273, -0.9106]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6895,  0.1071, -0.0870,  ..., -0.5884, -0.7661, -0.9761]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5405,  1.3281,  1.1035,  ..., -0.8164, -0.1199, -1.4258]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7861,  1.1328,  1.3457,  ..., -1.0127, -0.7588, -1.4912]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2458,  0.3130,  1.5127,  ...,  0.4316, -0.8535, -1.3242]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4915,  0.1176,  1.7549,  ...,  0.2351, -1.4922, -1.3896]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 28/321
Image: xBs1.0120.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5703, -0.3857,  1.5771,  ..., -0.7344, -1.6484, -0.3955]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.3247, -0.5811,  1.8193,  ..., -0.9307, -2.2871, -0.4609]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6660, -0.4780,  0.5469,  ..., -1.6865, -1.4863, -0.6426]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9121, -0.6733,  0.7891,  ..., -1.8828, -2.1250, -0.7080]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.1953, -0.6626,  0.1165,  ..., -0.9199, -0.1216, -1.2109]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4414, -0.8579,  0.3589,  ..., -1.1162, -0.7603, -1.2764]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4229,  0.3198, -0.3328,  ..., -0.4329, -0.1219, -0.9209]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6680,  0.1244, -0.0905,  ..., -0.6294, -0.7607, -0.9863]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4824,  1.2461,  1.0811,  ..., -0.8027, -0.1255, -1.4014]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7280,  1.0508,  1.3232,  ..., -0.9990, -0.7642, -1.4668]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2421,  0.2764,  1.5352,  ...,  0.4556, -0.8525, -1.3271]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4878,  0.0809,  1.7773,  ...,  0.2590, -1.4912, -1.3926]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 29/321
Image: idp90748_3R0S.####.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4585, -0.4341,  1.4414,  ..., -0.7344, -1.6660, -0.3804]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2129, -0.6294,  1.6836,  ..., -0.9307, -2.3047, -0.4458]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6953, -0.4316,  0.6748,  ..., -1.6553, -1.5703, -0.6582]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.6270,  0.9170,  ..., -1.8516, -2.2090, -0.7236]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.1992, -0.5420, -0.0350,  ..., -0.7441, -0.1543, -1.2461]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4453, -0.7373,  0.2073,  ..., -0.9404, -0.7930, -1.3115]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4795,  0.2622, -0.3784,  ..., -0.4658, -0.1184, -0.9429]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7246,  0.0668, -0.1361,  ..., -0.6621, -0.7568, -1.0088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6479,  1.1514,  1.1348,  ..., -0.7886, -0.1161, -1.4492]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8936,  0.9561,  1.3770,  ..., -0.9854, -0.7549, -1.5146]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2969,  0.2830,  1.5654,  ...,  0.3848, -0.8442, -1.3135]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5425,  0.0875,  1.8076,  ...,  0.1882, -1.4824, -1.3789]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 30/321
Image: 44156_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4937, -0.4016,  1.4102,  ..., -0.7451, -1.6484, -0.3936]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2480, -0.5972,  1.6523,  ..., -0.9414, -2.2871, -0.4590]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6699, -0.2661,  0.4939,  ..., -1.4316, -1.5635, -0.7319]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9160, -0.4614,  0.7363,  ..., -1.6279, -2.2031, -0.7974]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3975, -0.5562,  0.1700,  ..., -0.8662, -0.2710, -1.1748]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6426, -0.7515,  0.4124,  ..., -1.0625, -0.9097, -1.2402]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4922,  0.2988, -0.3413,  ..., -0.4111, -0.1140, -0.8779]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7383,  0.1034, -0.0990,  ..., -0.6074, -0.7529, -0.9434]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5405,  1.1826,  1.1299,  ..., -0.7168, -0.0812, -1.4111]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7861,  0.9873,  1.3721,  ..., -0.9131, -0.7197, -1.4766]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2864,  0.2825,  1.5176,  ...,  0.4546, -0.9546, -1.3789]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5322,  0.0870,  1.7598,  ...,  0.2581, -1.5938, -1.4443]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 31/321
Image: PI09_1_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3936, -0.4287,  1.2861,  ..., -0.7534, -1.6680, -0.3374]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1479, -0.6240,  1.5283,  ..., -0.9502, -2.3066, -0.4028]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7578, -0.2236,  0.5303,  ..., -1.4766, -1.6230, -0.6885]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0039, -0.4189,  0.7725,  ..., -1.6729, -2.2617, -0.7539]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4229, -0.5684,  0.1050,  ..., -0.9326, -0.2539, -1.2344]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6680, -0.7637,  0.3474,  ..., -1.1289, -0.8926, -1.2998]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5625,  0.2749, -0.4224,  ..., -0.3923, -0.1134, -0.9004]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8086,  0.0795, -0.1801,  ..., -0.5889, -0.7520, -0.9658]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5815,  1.2520,  1.0225,  ..., -0.7910, -0.1487, -1.5029]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8271,  1.0566,  1.2646,  ..., -0.9873, -0.7871, -1.5684]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2849,  0.3086,  1.5684,  ...,  0.3975, -0.8696, -1.3311]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5303,  0.1132,  1.8105,  ...,  0.2009, -1.5078, -1.3965]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 32/321
Image: tk-xf12-soak-ca-2.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5493, -0.4253,  1.4473,  ..., -0.7598, -1.6562, -0.3906]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.3037, -0.6206,  1.6895,  ..., -0.9561, -2.2949, -0.4561]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6533, -0.3533,  0.4819,  ..., -1.4062, -1.5547, -0.6870]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8984, -0.5488,  0.7241,  ..., -1.6025, -2.1934, -0.7524]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3301, -0.6328,  0.2119,  ..., -0.9102, -0.2432, -1.2109]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5762, -0.8281,  0.4541,  ..., -1.1064, -0.8818, -1.2764]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5039,  0.2988, -0.3286,  ..., -0.3955, -0.1757, -0.9072]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7500,  0.1034, -0.0863,  ..., -0.5918, -0.8145, -0.9727]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4829,  1.1963,  1.1777,  ..., -0.7275, -0.1903, -1.4150]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7285,  1.0010,  1.4199,  ..., -0.9238, -0.8291, -1.4805]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2517,  0.2998,  1.4580,  ...,  0.4453, -0.9492, -1.3691]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4973,  0.1044,  1.7002,  ...,  0.2488, -1.5879, -1.4346]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 33/321
Image: s2_2.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4297, -0.4556,  1.4043,  ..., -0.7842, -1.6758, -0.3838]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1841, -0.6509,  1.6465,  ..., -0.9805, -2.3145, -0.4492]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6797, -0.4255,  0.6182,  ..., -1.6260, -1.5947, -0.6689]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9258, -0.6211,  0.8604,  ..., -1.8223, -2.2344, -0.7344]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3184, -0.4980, -0.1201,  ..., -0.6865, -0.1583, -1.2480]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5645, -0.6934,  0.1222,  ..., -0.8828, -0.7969, -1.3135]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5322,  0.2732, -0.3682,  ..., -0.4702, -0.0986, -0.9390]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7773,  0.0778, -0.1259,  ..., -0.6670, -0.7373, -1.0049]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6919,  1.2139,  1.0488,  ..., -0.7764, -0.1912, -1.5312]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9375,  1.0186,  1.2910,  ..., -0.9727, -0.8301, -1.5967]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2759,  0.3047,  1.5879,  ...,  0.4004, -0.8242, -1.3633]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5215,  0.1093,  1.8301,  ...,  0.2039, -1.4629, -1.4287]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 34/321
Image: 3ga7_anomalous_stm490-2_2_A.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4233, -0.3940,  1.3838,  ..., -0.7915, -1.6123, -0.3901]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1777, -0.5894,  1.6260,  ..., -0.9883, -2.2500, -0.4556]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7373, -0.3215,  0.5020,  ..., -1.4102, -1.5000, -0.7188]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9824, -0.5171,  0.7441,  ..., -1.6064, -2.1387, -0.7842]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3516, -0.4448, -0.0678,  ..., -0.7129, -0.1111, -1.2061]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5977, -0.6401,  0.1746,  ..., -0.9092, -0.7500, -1.2715]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5479,  0.3247, -0.3474,  ..., -0.4333, -0.1021, -0.9634]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7930,  0.1293, -0.1051,  ..., -0.6299, -0.7407, -1.0293]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6426,  1.2500,  1.0859,  ..., -0.7666, -0.1858, -1.5088]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8882,  1.0547,  1.3281,  ..., -0.9629, -0.8242, -1.5742]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2688,  0.3345,  1.5742,  ...,  0.3901, -0.8579, -1.3555]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5146,  0.1390,  1.8164,  ...,  0.1936, -1.4961, -1.4209]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 35/321
Image: IDP01143-3k.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3923, -0.4084,  1.2656,  ..., -0.8135, -1.6035, -0.3730]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1467, -0.6040,  1.5078,  ..., -1.0098, -2.2422, -0.4385]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7412, -0.4233,  0.6436,  ..., -1.5039, -1.5996, -0.7168]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9863, -0.6187,  0.8857,  ..., -1.7002, -2.2383, -0.7822]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4160, -0.3848, -0.0972,  ..., -0.6138, -0.1682, -1.2734]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6621, -0.5801,  0.1450,  ..., -0.8105, -0.8066, -1.3389]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5332,  0.2922, -0.3735,  ..., -0.4424, -0.0740, -0.9800]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7793,  0.0968, -0.1312,  ..., -0.6387, -0.7129, -1.0459]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6611,  1.1768,  1.0186,  ..., -0.7188, -0.2019, -1.4941]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9067,  0.9814,  1.2607,  ..., -0.9150, -0.8408, -1.5596]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3042,  0.3516,  1.5938,  ...,  0.4490, -0.8540, -1.3467]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5498,  0.1561,  1.8359,  ...,  0.2524, -1.4922, -1.4121]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 36/321
Image: non-anomalous_IDP00577-4.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5229, -0.4011,  1.4629,  ..., -0.7002, -1.6250, -0.3384]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2773, -0.5967,  1.7051,  ..., -0.8965, -2.2637, -0.4038]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6504, -0.4998,  0.5747,  ..., -1.6348, -1.5605, -0.6792]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8965, -0.6953,  0.8169,  ..., -1.8311, -2.1992, -0.7446]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2744, -0.5854,  0.1458,  ..., -0.9238, -0.1572, -1.2529]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5195, -0.7808,  0.3882,  ..., -1.1201, -0.7959, -1.3184]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4395,  0.3152, -0.3403,  ..., -0.4109, -0.0955, -0.9619]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6855,  0.1198, -0.0980,  ..., -0.6074, -0.7344, -1.0273]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5332,  1.2002,  1.0703,  ..., -0.7266, -0.1840, -1.4316]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7788,  1.0049,  1.3125,  ..., -0.9229, -0.8228, -1.4971]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2153,  0.3059,  1.4922,  ...,  0.5010, -0.8286, -1.2773]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4609,  0.1105,  1.7344,  ...,  0.3044, -1.4668, -1.3428]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 37/321
Image: IDP_ro_C6_2.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4653, -0.4214,  1.4121,  ..., -0.7495, -1.6465, -0.3735]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2197, -0.6167,  1.6543,  ..., -0.9463, -2.2852, -0.4390]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6709, -0.3210,  0.4951,  ..., -1.4648, -1.5596, -0.6885]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9160, -0.5166,  0.7373,  ..., -1.6611, -2.1992, -0.7539]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2871, -0.5381, -0.0519,  ..., -0.7085, -0.1553, -1.1973]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5332, -0.7334,  0.1904,  ..., -0.9053, -0.7939, -1.2627]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5254,  0.2915, -0.3511,  ..., -0.4363, -0.1245, -0.9355]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7715,  0.0961, -0.1088,  ..., -0.6328, -0.7632, -1.0010]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6748,  1.2549,  1.0928,  ..., -0.7627, -0.1940, -1.5342]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9204,  1.0596,  1.3350,  ..., -0.9590, -0.8325, -1.5996]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2607,  0.3052,  1.5771,  ...,  0.4072, -0.8359, -1.3574]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5063,  0.1097,  1.8193,  ...,  0.2107, -1.4746, -1.4229]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 38/321
Image: 125907_1_E2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4424, -0.3828,  1.2939,  ..., -0.7798, -1.6045, -0.3740]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1968, -0.5781,  1.5361,  ..., -0.9766, -2.2422, -0.4395]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7285, -0.3179,  0.5146,  ..., -1.3789, -1.5586, -0.7422]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9746, -0.5132,  0.7568,  ..., -1.5752, -2.1973, -0.8076]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4385, -0.5034,  0.1338,  ..., -0.8867, -0.2295, -1.2754]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6836, -0.6987,  0.3760,  ..., -1.0830, -0.8682, -1.3408]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5166,  0.2732, -0.3569,  ..., -0.3909, -0.0875, -0.9546]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.0778, -0.1146,  ..., -0.5874, -0.7261, -1.0205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5508,  1.2275,  1.0635,  ..., -0.7373, -0.1421, -1.4561]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7964,  1.0322,  1.3057,  ..., -0.9336, -0.7808, -1.5215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2515,  0.3042,  1.5537,  ...,  0.4453, -0.8862, -1.3672]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4971,  0.1088,  1.7959,  ...,  0.2488, -1.5254, -1.4326]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 39/321
Image: 217343a5_cx####.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3433, -0.3838,  1.2666,  ..., -0.7910, -1.6172, -0.3628]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0977, -0.5791,  1.5088,  ..., -0.9873, -2.2559, -0.4282]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7842, -0.2944,  0.5879,  ..., -1.3359, -1.5996, -0.7065]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0293, -0.4897,  0.8301,  ..., -1.5322, -2.2383, -0.7720]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4697, -0.4248, -0.0800,  ..., -0.5991, -0.2057, -1.1426]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7148, -0.6201,  0.1624,  ..., -0.7959, -0.8442, -1.2080]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5537,  0.3013, -0.3486,  ..., -0.4414, -0.1113, -0.9346]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7988,  0.1058, -0.1063,  ..., -0.6377, -0.7500, -1.0000]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6523,  1.1816,  1.0518,  ..., -0.7100, -0.2130, -1.5176]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8979,  0.9863,  1.2939,  ..., -0.9062, -0.8516, -1.5830]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3267,  0.3389,  1.6152,  ...,  0.4365, -0.8823, -1.3467]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5723,  0.1434,  1.8574,  ...,  0.2400, -1.5215, -1.4121]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 40/321
Image: SA2904-N4_B.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3882, -0.3765,  1.2861,  ..., -0.8018, -1.6084, -0.3765]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1426, -0.5718,  1.5283,  ..., -0.9980, -2.2461, -0.4419]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7158, -0.4155,  0.6367,  ..., -1.5449, -1.5400, -0.7358]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9609, -0.6108,  0.8789,  ..., -1.7412, -2.1797, -0.8013]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3906, -0.3545, -0.0473,  ..., -0.6567, -0.1122, -1.2529]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6367, -0.5498,  0.1949,  ..., -0.8535, -0.7510, -1.3184]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5156,  0.3157, -0.3669,  ..., -0.4285, -0.0867, -0.9561]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.1202, -0.1246,  ..., -0.6250, -0.7256, -1.0215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6445,  1.2148,  1.0283,  ..., -0.7476, -0.1671, -1.4727]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8901,  1.0195,  1.2705,  ..., -0.9443, -0.8057, -1.5381]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2949,  0.3284,  1.6133,  ...,  0.4326, -0.8389, -1.3281]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5405,  0.1329,  1.8555,  ...,  0.2361, -1.4775, -1.3936]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 41/321
Image: 11820_1_E1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4023, -0.4521,  1.2803,  ..., -0.7129, -1.6816, -0.3057]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1567, -0.6475,  1.5225,  ..., -0.9092, -2.3203, -0.3711]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7686, -0.1719,  0.5049,  ..., -1.4395, -1.5957, -0.7583]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0137, -0.3672,  0.7471,  ..., -1.6357, -2.2344, -0.8237]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4717, -0.4917,  0.1345,  ..., -0.8760, -0.2686, -1.1895]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7168, -0.6870,  0.3770,  ..., -1.0723, -0.9072, -1.2549]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5254,  0.2825, -0.3364,  ..., -0.3633, -0.1405, -0.8882]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7715,  0.0870, -0.0941,  ..., -0.5596, -0.7793, -0.9536]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5625,  1.2549,  1.0781,  ..., -0.8193, -0.1190, -1.4863]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8081,  1.0596,  1.3203,  ..., -1.0156, -0.7578, -1.5518]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2781,  0.3796,  1.5820,  ...,  0.4424, -0.8555, -1.3418]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5234,  0.1842,  1.8242,  ...,  0.2458, -1.4941, -1.4072]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 42/321
Image: idp02329-10.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3950, -0.3721,  1.3086,  ..., -0.8081, -1.5723, -0.3999]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1494, -0.5674,  1.5508,  ..., -1.0049, -2.2109, -0.4653]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7373, -0.4492,  0.6133,  ..., -1.5332, -1.4727, -0.7017]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9824, -0.6445,  0.8555,  ..., -1.7295, -2.1113, -0.7671]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3779, -0.3623, -0.0676,  ..., -0.6855, -0.0754, -1.2666]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6230, -0.5576,  0.1748,  ..., -0.8818, -0.7139, -1.3320]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5029,  0.3337, -0.3547,  ..., -0.4622, -0.0724, -0.9912]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7480,  0.1383, -0.1124,  ..., -0.6587, -0.7109, -1.0566]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6196,  1.2246,  1.0283,  ..., -0.7383, -0.1661, -1.4893]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8652,  1.0293,  1.2705,  ..., -0.9346, -0.8047, -1.5547]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2524,  0.3279,  1.5840,  ...,  0.4229, -0.8145, -1.3428]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4980,  0.1324,  1.8262,  ...,  0.2263, -1.4531, -1.4082]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 43/321
Image: qnf2-9.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4395, -0.4326,  1.3398,  ..., -0.7969, -1.6230, -0.3735]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1938, -0.6279,  1.5820,  ..., -0.9932, -2.2617, -0.4390]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7188, -0.4480,  0.6309,  ..., -1.5557, -1.5781, -0.6973]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9648, -0.6436,  0.8730,  ..., -1.7520, -2.2168, -0.7627]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3418, -0.4326, -0.0881,  ..., -0.6943, -0.1736, -1.2598]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5879, -0.6279,  0.1542,  ..., -0.8906, -0.8125, -1.3252]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5391,  0.2942, -0.3904,  ..., -0.4712, -0.0845, -0.9902]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7852,  0.0988, -0.1481,  ..., -0.6680, -0.7231, -1.0557]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6484,  1.2197,  1.0322,  ..., -0.7568, -0.2238, -1.5020]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8940,  1.0244,  1.2744,  ..., -0.9531, -0.8623, -1.5674]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2805,  0.3376,  1.5586,  ...,  0.4102, -0.8594, -1.3418]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5264,  0.1422,  1.8008,  ...,  0.2136, -1.4980, -1.4072]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 44/321
Image: xtal-1-inf.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5757, -0.3960,  1.5293,  ..., -0.7310, -1.6426, -0.3818]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.3301, -0.5913,  1.7715,  ..., -0.9277, -2.2812, -0.4473]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6348, -0.5000,  0.5767,  ..., -1.6865, -1.4727, -0.6274]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8809, -0.6953,  0.8188,  ..., -1.8828, -2.1113, -0.6929]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.1328, -0.5757,  0.0332,  ..., -0.7197, -0.1199, -1.1123]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.3789, -0.7710,  0.2754,  ..., -0.9160, -0.7588, -1.1777]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4062,  0.3037, -0.2764,  ..., -0.4609, -0.1484, -0.9277]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6523,  0.1083, -0.0341,  ..., -0.6572, -0.7871, -0.9932]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5791,  1.1836,  1.1729,  ..., -0.7227, -0.1004, -1.3975]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8247,  0.9883,  1.4150,  ..., -0.9189, -0.7393, -1.4629]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2561,  0.3076,  1.5527,  ...,  0.4705, -0.8608, -1.3516]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5020,  0.1122,  1.7949,  ...,  0.2739, -1.5000, -1.4170]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 45/321
Image: IDP5262ACo_B.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4387, -0.4314,  1.5273,  ..., -0.7168, -1.7178, -0.3945]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1931, -0.6270,  1.7695,  ..., -0.9131, -2.3555, -0.4600]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7041, -0.4395,  0.6899,  ..., -1.6484, -1.6133, -0.6646]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9492, -0.6348,  0.9321,  ..., -1.8447, -2.2520, -0.7300]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2959, -0.6528,  0.0765,  ..., -1.0166, -0.2469, -1.2393]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5410, -0.8481,  0.3188,  ..., -1.2129, -0.8857, -1.3047]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4766,  0.2600, -0.3962,  ..., -0.4678, -0.0992, -0.8931]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7227,  0.0646, -0.1539,  ..., -0.6641, -0.7378, -0.9585]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5503,  1.2090,  1.0420,  ..., -0.8818, -0.1255, -1.4570]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7959,  1.0137,  1.2842,  ..., -1.0781, -0.7642, -1.5225]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2646,  0.2837,  1.5684,  ...,  0.3843, -0.8257, -1.3281]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5103,  0.0883,  1.8105,  ...,  0.1877, -1.4648, -1.3936]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 46/321
Image: spine7_7test.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3445, -0.3955,  1.3613,  ..., -0.8032, -1.6221, -0.3794]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0989, -0.5908,  1.6035,  ..., -1.0000, -2.2617, -0.4448]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6816, -0.4321,  0.6299,  ..., -1.5098, -1.5400, -0.7256]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9277, -0.6274,  0.8721,  ..., -1.7061, -2.1797, -0.7910]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3916, -0.4229, -0.0585,  ..., -0.6636, -0.1451, -1.2480]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6367, -0.6182,  0.1838,  ..., -0.8604, -0.7837, -1.3135]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5225,  0.2954, -0.3635,  ..., -0.4609, -0.0823, -0.9448]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7676,  0.1000, -0.1212,  ..., -0.6572, -0.7207, -1.0107]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6460,  1.1641,  1.0576,  ..., -0.7520, -0.2097, -1.4844]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8916,  0.9688,  1.2998,  ..., -0.9482, -0.8486, -1.5498]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2852,  0.3193,  1.6328,  ...,  0.4131, -0.8369, -1.3301]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5308,  0.1239,  1.8750,  ...,  0.2166, -1.4756, -1.3955]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 47/321
Image: 47812_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4490, -0.3711,  1.3027,  ..., -0.7407, -1.6377, -0.3687]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2034, -0.5664,  1.5449,  ..., -0.9375, -2.2773, -0.4341]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7080, -0.2739,  0.5454,  ..., -1.4150, -1.6016, -0.7212]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.4692,  0.7876,  ..., -1.6113, -2.2402, -0.7866]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4043, -0.5015,  0.0461,  ..., -0.8535, -0.2402, -1.2393]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6504, -0.6968,  0.2883,  ..., -1.0498, -0.8789, -1.3047]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4844,  0.2749, -0.3718,  ..., -0.3655, -0.1173, -0.9360]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7305,  0.0795, -0.1295,  ..., -0.5620, -0.7559, -1.0020]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5596,  1.2441,  1.0547,  ..., -0.7412, -0.1614, -1.4502]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8052,  1.0488,  1.2969,  ..., -0.9375, -0.7998, -1.5156]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2944,  0.2917,  1.5498,  ...,  0.4624, -0.9297, -1.3389]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5400,  0.0963,  1.7920,  ...,  0.2659, -1.5684, -1.4043]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 48/321
Image: IDP92768-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4224, -0.3682,  1.4189,  ..., -0.7495, -1.6113, -0.3794]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1768, -0.5635,  1.6611,  ..., -0.9463, -2.2500, -0.4448]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7139, -0.4136,  0.6323,  ..., -1.5850, -1.5117, -0.6948]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9590, -0.6089,  0.8745,  ..., -1.7812, -2.1504, -0.7603]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2891, -0.4805, -0.0279,  ..., -0.7085, -0.0858, -1.2383]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5352, -0.6758,  0.2144,  ..., -0.9053, -0.7246, -1.3037]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5000,  0.3228, -0.3472,  ..., -0.4292, -0.0923, -0.9653]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7461,  0.1273, -0.1049,  ..., -0.6260, -0.7310, -1.0312]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6689,  1.2139,  1.1172,  ..., -0.7324, -0.2358, -1.4863]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9146,  1.0186,  1.3594,  ..., -0.9287, -0.8745, -1.5518]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2556,  0.3027,  1.6006,  ...,  0.4255, -0.8291, -1.3047]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5010,  0.1073,  1.8428,  ...,  0.2290, -1.4678, -1.3701]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 49/321
Image: epp4-10.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4460, -0.4053,  1.3828,  ..., -0.7817, -1.6260, -0.3970]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2004, -0.6006,  1.6250,  ..., -0.9785, -2.2656, -0.4624]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6953, -0.4309,  0.6436,  ..., -1.5615, -1.5449, -0.7056]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.6265,  0.8857,  ..., -1.7578, -2.1836, -0.7710]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3379, -0.4360, -0.0174,  ..., -0.6792, -0.1010, -1.2275]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5840, -0.6313,  0.2250,  ..., -0.8760, -0.7397, -1.2930]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5098,  0.3059, -0.3608,  ..., -0.4346, -0.0664, -0.9653]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7559,  0.1105, -0.1185,  ..., -0.6309, -0.7051, -1.0312]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6602,  1.2109,  1.0615,  ..., -0.7363, -0.1665, -1.5029]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9058,  1.0156,  1.3037,  ..., -0.9326, -0.8052, -1.5684]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2644,  0.3203,  1.5957,  ...,  0.4258, -0.8408, -1.3477]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5098,  0.1249,  1.8379,  ...,  0.2292, -1.4795, -1.4131]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 50/321
Image: 11280_6_E2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3809, -0.4331,  1.2988,  ..., -0.7876, -1.6152, -0.3535]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1353, -0.6284,  1.5410,  ..., -0.9844, -2.2539, -0.4189]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7471, -0.3232,  0.5439,  ..., -1.3457, -1.6094, -0.7305]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9922, -0.5186,  0.7861,  ..., -1.5420, -2.2480, -0.7959]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4258, -0.4351, -0.0726,  ..., -0.6240, -0.2393, -1.2207]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6719, -0.6304,  0.1697,  ..., -0.8203, -0.8779, -1.2861]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5635,  0.2705, -0.3396,  ..., -0.4189, -0.1177, -0.9468]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8086,  0.0751, -0.0973,  ..., -0.6152, -0.7563, -1.0127]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6680,  1.1816,  1.0879,  ..., -0.7510, -0.2218, -1.5420]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9136,  0.9863,  1.3301,  ..., -0.9473, -0.8604, -1.6074]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3035,  0.3418,  1.5742,  ...,  0.4214, -0.8643, -1.3477]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5488,  0.1464,  1.8164,  ...,  0.2249, -1.5029, -1.4131]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 51/321
Image: xAs2m.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3538, -0.3926,  1.4775,  ..., -0.7754, -1.6738, -0.3931]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1082, -0.5879,  1.7197,  ..., -0.9717, -2.3125, -0.4585]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6689, -0.4060,  0.6250,  ..., -1.6230, -1.5488, -0.6484]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9141, -0.6016,  0.8672,  ..., -1.8193, -2.1875, -0.7139]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3926, -0.5366,  0.0193,  ..., -0.9751, -0.1733, -1.3105]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6387, -0.7319,  0.2617,  ..., -1.1719, -0.8120, -1.3760]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5293,  0.3411, -0.4045,  ..., -0.4851, -0.1102, -0.9277]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7754,  0.1456, -0.1622,  ..., -0.6816, -0.7490, -0.9932]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5649,  1.2607,  1.0020,  ..., -0.8271, -0.1688, -1.4424]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8105,  1.0654,  1.2441,  ..., -1.0234, -0.8076, -1.5078]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2996,  0.3149,  1.5234,  ...,  0.3940, -0.8662, -1.3164]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5449,  0.1195,  1.7656,  ...,  0.1975, -1.5049, -1.3818]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 52/321
Image: IDP04364_4FXS.####.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3340, -0.4204,  1.4961,  ..., -0.7529, -1.6641, -0.3809]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0884, -0.6157,  1.7383,  ..., -0.9492, -2.3027, -0.4463]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6562, -0.4094,  0.6226,  ..., -1.6377, -1.5312, -0.6748]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9023, -0.6050,  0.8647,  ..., -1.8340, -2.1699, -0.7402]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2627, -0.5078, -0.0557,  ..., -0.7842, -0.1357, -1.2422]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5078, -0.7031,  0.1865,  ..., -0.9805, -0.7744, -1.3076]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4941,  0.2925, -0.3259,  ..., -0.4727, -0.1312, -0.9385]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7402,  0.0970, -0.0836,  ..., -0.6689, -0.7700, -1.0039]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6836,  1.2383,  1.0918,  ..., -0.8262, -0.1851, -1.5146]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9292,  1.0430,  1.3340,  ..., -1.0225, -0.8237, -1.5801]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2666,  0.3359,  1.5801,  ...,  0.3745, -0.7905, -1.3203]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5122,  0.1405,  1.8223,  ...,  0.1780, -1.4297, -1.3857]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 53/321
Image: idp00743b.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4077, -0.3767,  1.3545,  ..., -0.7764, -1.6211, -0.4028]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1621, -0.5723,  1.5967,  ..., -0.9727, -2.2598, -0.4683]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7441, -0.2820,  0.5215,  ..., -1.4189, -1.5000, -0.7725]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9902, -0.4775,  0.7637,  ..., -1.6152, -2.1387, -0.8379]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4141, -0.5005,  0.0916,  ..., -0.9028, -0.1481, -1.2793]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6602, -0.6958,  0.3340,  ..., -1.0996, -0.7866, -1.3447]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5234,  0.3101, -0.3608,  ..., -0.3918, -0.0743, -0.9556]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7695,  0.1146, -0.1185,  ..., -0.5884, -0.7129, -1.0215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5356,  1.2529,  1.0752,  ..., -0.7822, -0.1423, -1.4385]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7812,  1.0576,  1.3174,  ..., -0.9785, -0.7812, -1.5039]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2336,  0.2883,  1.5469,  ...,  0.4248, -0.8462, -1.3398]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4792,  0.0929,  1.7891,  ...,  0.2283, -1.4844, -1.4053]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 54/321
Image: act6-15_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4285, -0.4299,  1.2910,  ..., -0.7451, -1.6738, -0.3325]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1829, -0.6255,  1.5332,  ..., -0.9414, -2.3125, -0.3979]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7373, -0.2405,  0.4688,  ..., -1.4561, -1.6221, -0.7300]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9824, -0.4360,  0.7109,  ..., -1.6523, -2.2617, -0.7954]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3896, -0.5557,  0.1350,  ..., -0.8892, -0.2532, -1.2314]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6348, -0.7510,  0.3774,  ..., -1.0859, -0.8916, -1.2969]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4795,  0.2539, -0.3474,  ..., -0.3538, -0.0962, -0.9365]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7246,  0.0585, -0.1051,  ..., -0.5503, -0.7349, -1.0020]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5737,  1.2314,  1.0908,  ..., -0.7578, -0.1339, -1.4873]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8193,  1.0361,  1.3330,  ..., -0.9541, -0.7725, -1.5527]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2173,  0.3220,  1.5449,  ...,  0.4463, -0.8325, -1.3408]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4629,  0.1266,  1.7871,  ...,  0.2498, -1.4707, -1.4062]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 55/321
Image: idp2451-n3_B.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4780, -0.3779,  1.4004,  ..., -0.7671, -1.5947, -0.3755]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2324, -0.5732,  1.6426,  ..., -0.9639, -2.2344, -0.4409]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7070, -0.4771,  0.5605,  ..., -1.5996, -1.5107, -0.6782]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.6724,  0.8027,  ..., -1.7959, -2.1484, -0.7437]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2969, -0.4238, -0.0509,  ..., -0.7393, -0.0823, -1.2598]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5430, -0.6191,  0.1914,  ..., -0.9355, -0.7207, -1.3252]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5088,  0.3533, -0.3564,  ..., -0.4600, -0.1173, -0.9834]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7539,  0.1578, -0.1141,  ..., -0.6562, -0.7559, -1.0488]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6318,  1.2441,  1.0645,  ..., -0.7471, -0.2255, -1.4883]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8774,  1.0488,  1.3066,  ..., -0.9434, -0.8643, -1.5537]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2371,  0.3193,  1.5596,  ...,  0.4331, -0.8486, -1.3066]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4827,  0.1239,  1.8018,  ...,  0.2366, -1.4873, -1.3721]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 56/321
Image: EHJ6_2_1_10.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3511, -0.3809,  1.3691,  ..., -0.8252, -1.6152, -0.3984]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1055, -0.5762,  1.6113,  ..., -1.0215, -2.2539, -0.4639]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7012, -0.4038,  0.6865,  ..., -1.5127, -1.5527, -0.7056]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9473, -0.5991,  0.9287,  ..., -1.7090, -2.1914, -0.7710]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4023, -0.3984, -0.0531,  ..., -0.6768, -0.1171, -1.2441]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6484, -0.5938,  0.1892,  ..., -0.8730, -0.7559, -1.3096]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5107,  0.3169, -0.3550,  ..., -0.4883, -0.0795, -0.9302]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7559,  0.1215, -0.1127,  ..., -0.6846, -0.7183, -0.9956]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5898,  1.1514,  1.0547,  ..., -0.8184, -0.1428, -1.4688]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8354,  0.9561,  1.2969,  ..., -1.0146, -0.7812, -1.5342]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2903,  0.3296,  1.6289,  ...,  0.3833, -0.8389, -1.3652]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5361,  0.1342,  1.8711,  ...,  0.1868, -1.4775, -1.4307]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 57/321
Image: fez5-10.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4502, -0.4221,  1.4326,  ..., -0.7852, -1.6436, -0.3892]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2046, -0.6177,  1.6748,  ..., -0.9814, -2.2812, -0.4546]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6650, -0.4771,  0.6113,  ..., -1.5840, -1.5752, -0.6855]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9102, -0.6724,  0.8535,  ..., -1.7803, -2.2148, -0.7510]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3125, -0.4824, -0.0534,  ..., -0.7207, -0.1422, -1.2549]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5586, -0.6777,  0.1888,  ..., -0.9170, -0.7808, -1.3203]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5146,  0.3037, -0.3582,  ..., -0.4673, -0.0958, -0.9683]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.1083, -0.1158,  ..., -0.6641, -0.7344, -1.0342]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6484,  1.2012,  1.0801,  ..., -0.7690, -0.2070, -1.5156]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8940,  1.0059,  1.3223,  ..., -0.9658, -0.8457, -1.5811]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2622,  0.3215,  1.5762,  ...,  0.3936, -0.8447, -1.3564]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5078,  0.1261,  1.8184,  ...,  0.1970, -1.4834, -1.4219]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 58/321
Image: stm595-3_A.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4097, -0.3899,  1.3652,  ..., -0.7524, -1.6211, -0.3643]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1641, -0.5854,  1.6074,  ..., -0.9492, -2.2598, -0.4297]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7275, -0.3054,  0.4951,  ..., -1.4414, -1.5225, -0.7349]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9727, -0.5010,  0.7373,  ..., -1.6377, -2.1602, -0.8003]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4561, -0.5093,  0.0385,  ..., -0.9175, -0.2139, -1.2754]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7012, -0.7046,  0.2808,  ..., -1.1143, -0.8525, -1.3408]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5156,  0.3096, -0.3855,  ..., -0.4033, -0.1141, -0.9331]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.1141, -0.1432,  ..., -0.5996, -0.7529, -0.9985]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5396,  1.2266,  1.0703,  ..., -0.7715, -0.1614, -1.4561]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7852,  1.0312,  1.3125,  ..., -0.9678, -0.7998, -1.5215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2642,  0.2878,  1.5420,  ...,  0.4463, -0.8418, -1.3125]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5098,  0.0924,  1.7842,  ...,  0.2498, -1.4805, -1.3779]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 59/321
Image: wjm1-10.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3848, -0.3828,  1.3906,  ..., -0.8135, -1.6172, -0.4043]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1392, -0.5781,  1.6328,  ..., -1.0098, -2.2559, -0.4697]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6807, -0.4092,  0.6504,  ..., -1.5186, -1.5283, -0.7383]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9258, -0.6045,  0.8926,  ..., -1.7148, -2.1680, -0.8037]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4033, -0.4038, -0.0120,  ..., -0.6738, -0.1301, -1.2578]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6484, -0.5991,  0.2302,  ..., -0.8701, -0.7686, -1.3232]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5068,  0.3081, -0.3459,  ..., -0.4678, -0.0908, -0.9375]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7520,  0.1127, -0.1036,  ..., -0.6641, -0.7295, -1.0029]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6484,  1.2129,  1.0635,  ..., -0.7725, -0.1627, -1.4805]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8940,  1.0176,  1.3057,  ..., -0.9688, -0.8013, -1.5459]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2915,  0.3472,  1.6289,  ...,  0.3804, -0.8433, -1.3828]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5371,  0.1517,  1.8711,  ...,  0.1838, -1.4824, -1.4482]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 60/321
Image: hmp9-7.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3872, -0.4021,  1.3555,  ..., -0.8066, -1.6201, -0.3926]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1416, -0.5977,  1.5977,  ..., -1.0029, -2.2578, -0.4580]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6904, -0.4238,  0.6729,  ..., -1.5527, -1.5605, -0.7061]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9355, -0.6191,  0.9150,  ..., -1.7490, -2.1992, -0.7715]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3623, -0.4336, -0.0506,  ..., -0.7119, -0.1195, -1.2568]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6074, -0.6289,  0.1917,  ..., -0.9082, -0.7583, -1.3223]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5215,  0.3052, -0.3748,  ..., -0.4839, -0.0864, -0.9600]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7676,  0.1097, -0.1324,  ..., -0.6807, -0.7251, -1.0254]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6572,  1.1914,  1.0479,  ..., -0.7549, -0.1995, -1.4902]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9028,  0.9961,  1.2900,  ..., -0.9512, -0.8379, -1.5557]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2827,  0.3142,  1.5957,  ...,  0.3989, -0.8325, -1.3477]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5283,  0.1188,  1.8379,  ...,  0.2024, -1.4707, -1.4131]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 61/321
Image: IDP06102_INa_B.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4714, -0.4189,  1.5410,  ..., -0.7305, -1.6943, -0.4126]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2258, -0.6143,  1.7832,  ..., -0.9268, -2.3320, -0.4780]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7217, -0.4236,  0.6387,  ..., -1.6523, -1.5547, -0.7192]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9668, -0.6191,  0.8809,  ..., -1.8486, -2.1934, -0.7847]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3018, -0.6353,  0.1024,  ..., -1.0039, -0.2294, -1.2891]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5469, -0.8306,  0.3447,  ..., -1.2002, -0.8682, -1.3545]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4805,  0.2563, -0.3811,  ..., -0.4570, -0.1108, -0.9165]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7266,  0.0609, -0.1388,  ..., -0.6533, -0.7495, -0.9819]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5571,  1.1514,  1.0762,  ..., -0.8589, -0.0731, -1.3711]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8027,  0.9561,  1.3184,  ..., -1.0557, -0.7119, -1.4365]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2539,  0.2751,  1.4824,  ...,  0.4272, -0.8540, -1.2852]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4995,  0.0797,  1.7246,  ...,  0.2307, -1.4922, -1.3506]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 62/321
Image: idp01611-3_B.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3799, -0.3921,  1.3213,  ..., -0.7886, -1.6094, -0.3862]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1343, -0.5874,  1.5635,  ..., -0.9854, -2.2480, -0.4517]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7422, -0.3232,  0.5527,  ..., -1.3770, -1.5547, -0.7329]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9883, -0.5186,  0.7949,  ..., -1.5732, -2.1934, -0.7983]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4189, -0.4424, -0.0530,  ..., -0.6250, -0.1606, -1.2217]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6641, -0.6377,  0.1893,  ..., -0.8213, -0.7993, -1.2871]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5635,  0.3042, -0.3381,  ..., -0.4214, -0.1084, -0.9683]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8086,  0.1088, -0.0958,  ..., -0.6182, -0.7471, -1.0342]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6484,  1.1895,  1.0879,  ..., -0.7407, -0.2056, -1.5195]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8940,  0.9941,  1.3301,  ..., -0.9375, -0.8442, -1.5850]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2944,  0.3259,  1.6123,  ...,  0.4351, -0.8491, -1.3438]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5400,  0.1305,  1.8545,  ...,  0.2385, -1.4883, -1.4092]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 63/321
Image: imd9-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3723, -0.3853,  1.3496,  ..., -0.8081, -1.6045, -0.3892]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1267, -0.5806,  1.5918,  ..., -1.0049, -2.2422, -0.4546]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6982, -0.2898,  0.5103,  ..., -1.4082, -1.5176, -0.7422]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9434, -0.4854,  0.7524,  ..., -1.6045, -2.1562, -0.8076]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3848, -0.4453, -0.0581,  ..., -0.6709, -0.1808, -1.2139]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6309, -0.6406,  0.1842,  ..., -0.8672, -0.8193, -1.2793]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5439,  0.3076, -0.3569,  ..., -0.4253, -0.0962, -0.9336]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7891,  0.1122, -0.1146,  ..., -0.6221, -0.7349, -0.9990]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6357,  1.2090,  1.0732,  ..., -0.7461, -0.2070, -1.5234]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8813,  1.0137,  1.3154,  ..., -0.9424, -0.8457, -1.5889]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2676,  0.3101,  1.5986,  ...,  0.4106, -0.8447, -1.3369]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5132,  0.1146,  1.8408,  ...,  0.2141, -1.4834, -1.4023]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 64/321
Image: 148367_1_E1_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3921, -0.4092,  1.3213,  ..., -0.7568, -1.6699, -0.3555]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1465, -0.6045,  1.5635,  ..., -0.9531, -2.3086, -0.4209]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7490, -0.2715,  0.5918,  ..., -1.3984, -1.6016, -0.6699]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9941, -0.4668,  0.8340,  ..., -1.5947, -2.2402, -0.7354]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4766, -0.5029,  0.0185,  ..., -0.8774, -0.2451, -1.2266]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7227, -0.6982,  0.2607,  ..., -1.0742, -0.8838, -1.2920]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5176,  0.2781, -0.3809,  ..., -0.4136, -0.0985, -0.8955]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7637,  0.0826, -0.1385,  ..., -0.6104, -0.7373, -0.9609]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5254,  1.2139,  1.0703,  ..., -0.8008, -0.1558, -1.4688]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7710,  1.0186,  1.3125,  ..., -0.9971, -0.7944, -1.5342]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3008,  0.2974,  1.5498,  ...,  0.4402, -0.9077, -1.3340]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5464,  0.1019,  1.7920,  ...,  0.2437, -1.5469, -1.3994]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 65/321
Image: 47812_1_E2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3926, -0.3647,  1.2607,  ..., -0.7744, -1.6328, -0.3667]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1470, -0.5601,  1.5029,  ..., -0.9707, -2.2715, -0.4321]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7324, -0.2478,  0.5757,  ..., -1.3828, -1.6309, -0.7354]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9785, -0.4434,  0.8179,  ..., -1.5791, -2.2695, -0.8008]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4678, -0.4165,  0.0474,  ..., -0.8276, -0.2617, -1.2490]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7129, -0.6118,  0.2896,  ..., -1.0244, -0.9004, -1.3145]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5000,  0.2874, -0.3564,  ..., -0.3728, -0.1128, -0.9414]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7461,  0.0919, -0.1141,  ..., -0.5693, -0.7515, -1.0068]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5703,  1.2363,  1.0498,  ..., -0.7358, -0.1595, -1.4629]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8159,  1.0410,  1.2920,  ..., -0.9326, -0.7983, -1.5283]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3237,  0.3252,  1.5977,  ...,  0.4678, -0.9150, -1.3438]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5693,  0.1298,  1.8398,  ...,  0.2712, -1.5537, -1.4092]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 66/321
Image: idp90820-1_B.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4333, -0.4048,  1.3320,  ..., -0.7734, -1.6123, -0.3794]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1877, -0.6001,  1.5742,  ..., -0.9697, -2.2500, -0.4448]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6953, -0.4282,  0.6323,  ..., -1.5508, -1.5791, -0.7188]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.6235,  0.8745,  ..., -1.7471, -2.2188, -0.7842]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4238, -0.4922,  0.0605,  ..., -0.8955, -0.2030, -1.3086]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6699, -0.6875,  0.3027,  ..., -1.0918, -0.8418, -1.3740]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4941,  0.2988, -0.4050,  ..., -0.4331, -0.0723, -0.9551]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7402,  0.1034, -0.1627,  ..., -0.6299, -0.7109, -1.0205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5576,  1.2061,  1.0283,  ..., -0.7441, -0.1802, -1.4346]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8032,  1.0107,  1.2705,  ..., -0.9404, -0.8188, -1.5000]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2734,  0.2842,  1.5371,  ...,  0.4600, -0.8540, -1.3340]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5190,  0.0887,  1.7793,  ...,  0.2634, -1.4922, -1.3994]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 67/321
Image: 66063_2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3975, -0.3970,  1.2725,  ..., -0.7852, -1.6250, -0.3711]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1519, -0.5923,  1.5146,  ..., -0.9814, -2.2637, -0.4365]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7051, -0.3970,  0.6567,  ..., -1.5303, -1.5576, -0.7598]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9512, -0.5923,  0.8989,  ..., -1.7266, -2.1953, -0.8252]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4521, -0.4268,  0.1371,  ..., -0.8740, -0.2512, -1.2607]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6973, -0.6221,  0.3794,  ..., -1.0703, -0.8896, -1.3262]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5059,  0.2939, -0.3645,  ..., -0.4458, -0.0560, -0.9707]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7520,  0.0985, -0.1222,  ..., -0.6426, -0.6948, -1.0361]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4937,  1.1406,  1.0312,  ..., -0.7910, -0.0833, -1.4297]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7393,  0.9453,  1.2734,  ..., -0.9873, -0.7217, -1.4951]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2815,  0.3271,  1.5488,  ...,  0.4697, -0.8672, -1.3809]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5273,  0.1317,  1.7910,  ...,  0.2732, -1.5059, -1.4463]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 68/321
Image: XF_5_Se_set.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4514, -0.4009,  1.3711,  ..., -0.7510, -1.6289, -0.3628]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2058, -0.5962,  1.6133,  ..., -0.9473, -2.2676, -0.4282]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7109, -0.2888,  0.5020,  ..., -1.4199, -1.6074, -0.6978]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9570, -0.4844,  0.7441,  ..., -1.6162, -2.2461, -0.7632]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3936, -0.5503,  0.0379,  ..., -0.9131, -0.2257, -1.2734]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6387, -0.7456,  0.2803,  ..., -1.1094, -0.8643, -1.3389]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4990,  0.2808, -0.3831,  ..., -0.3618, -0.1089, -0.9233]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7441,  0.0853, -0.1407,  ..., -0.5586, -0.7476, -0.9888]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5508,  1.2490,  1.0508,  ..., -0.7480, -0.1731, -1.4570]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7964,  1.0537,  1.2930,  ..., -0.9443, -0.8115, -1.5225]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2413,  0.2949,  1.5088,  ...,  0.4570, -0.8574, -1.2988]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4868,  0.0995,  1.7510,  ...,  0.2605, -1.4961, -1.3643]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 69/321
Image: 70568_1_E2_1000.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4119, -0.3945,  1.2930,  ..., -0.7686, -1.6250, -0.3633]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1663, -0.5898,  1.5352,  ..., -0.9648, -2.2637, -0.4287]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7129, -0.2900,  0.5488,  ..., -1.3623, -1.5732, -0.7446]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9590, -0.4854,  0.7910,  ..., -1.5586, -2.2109, -0.8101]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4727, -0.4941,  0.1128,  ..., -0.8545, -0.2739, -1.2295]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7188, -0.6895,  0.3550,  ..., -1.0508, -0.9126, -1.2949]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5391,  0.2917, -0.3503,  ..., -0.4036, -0.0991, -0.9346]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7852,  0.0963, -0.1080,  ..., -0.6001, -0.7378, -1.0000]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5527,  1.2227,  1.0322,  ..., -0.7319, -0.1602, -1.4648]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7983,  1.0273,  1.2744,  ..., -0.9287, -0.7988, -1.5303]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2817,  0.3052,  1.5586,  ...,  0.4561, -0.9062, -1.3789]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5273,  0.1097,  1.8008,  ...,  0.2595, -1.5449, -1.4443]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 70/321
Image: lof5-5_lowres.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4585, -0.3960,  1.3242,  ..., -0.7646, -1.5908, -0.3647]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2129, -0.5913,  1.5664,  ..., -0.9609, -2.2305, -0.4302]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7168, -0.4412,  0.5879,  ..., -1.5713, -1.5156, -0.7456]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9629, -0.6367,  0.8301,  ..., -1.7676, -2.1543, -0.8110]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3369, -0.4072, -0.0318,  ..., -0.6904, -0.1222, -1.2383]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5820, -0.6025,  0.2106,  ..., -0.8867, -0.7607, -1.3037]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5049,  0.3252, -0.3733,  ..., -0.4331, -0.0818, -0.9707]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7500,  0.1298, -0.1310,  ..., -0.6299, -0.7207, -1.0361]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6670,  1.2236,  1.0459,  ..., -0.7480, -0.2007, -1.4980]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9126,  1.0283,  1.2881,  ..., -0.9443, -0.8394, -1.5635]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2671,  0.3125,  1.5742,  ...,  0.4343, -0.8384, -1.3242]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5127,  0.1171,  1.8164,  ...,  0.2378, -1.4766, -1.3896]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 71/321
Image: 84799_1_E2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3564, -0.3818,  1.2432,  ..., -0.7798, -1.6465, -0.3413]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1108, -0.5771,  1.4854,  ..., -0.9766, -2.2852, -0.4067]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7578, -0.2515,  0.6230,  ..., -1.3555, -1.6582, -0.7432]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0039, -0.4468,  0.8652,  ..., -1.5518, -2.2969, -0.8086]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4912, -0.3955,  0.0576,  ..., -0.8086, -0.2693, -1.2412]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7363, -0.5908,  0.2998,  ..., -1.0049, -0.9082, -1.3066]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5029,  0.2754, -0.3477,  ..., -0.3960, -0.1006, -0.9282]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7480,  0.0800, -0.1053,  ..., -0.5928, -0.7393, -0.9937]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5723,  1.2021,  1.0605,  ..., -0.7080, -0.1611, -1.4824]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8179,  1.0068,  1.3027,  ..., -0.9043, -0.7998, -1.5479]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3423,  0.3296,  1.6133,  ...,  0.4873, -0.8887, -1.3311]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5879,  0.1342,  1.8555,  ...,  0.2908, -1.5273, -1.3965]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 72/321
Image: 3h0p_stm1194_n1_nat.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4158, -0.3860,  1.3125,  ..., -0.7808, -1.6318, -0.3887]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1702, -0.5815,  1.5547,  ..., -0.9775, -2.2695, -0.4541]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7178, -0.2793,  0.5352,  ..., -1.4268, -1.5703, -0.7456]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9629, -0.4746,  0.7773,  ..., -1.6230, -2.2090, -0.8110]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4629, -0.5098,  0.0837,  ..., -0.8857, -0.2388, -1.2852]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7090, -0.7051,  0.3259,  ..., -1.0820, -0.8774, -1.3506]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5371,  0.2856, -0.3855,  ..., -0.3860, -0.0850, -0.9551]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.0902, -0.1432,  ..., -0.5825, -0.7236, -1.0205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5400,  1.2129,  1.0547,  ..., -0.7324, -0.1671, -1.4531]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7856,  1.0176,  1.2969,  ..., -0.9287, -0.8057, -1.5186]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2603,  0.2871,  1.5352,  ...,  0.4673, -0.8584, -1.3105]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5059,  0.0917,  1.7773,  ...,  0.2708, -1.4971, -1.3760]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 73/321
Image: 64991_2_E1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3965, -0.4209,  1.2705,  ..., -0.7983, -1.6357, -0.3691]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1509, -0.6162,  1.5127,  ..., -0.9951, -2.2734, -0.4346]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7207, -0.4111,  0.6768,  ..., -1.5186, -1.6270, -0.7368]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9668, -0.6064,  0.9189,  ..., -1.7148, -2.2656, -0.8022]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4727, -0.4404,  0.0952,  ..., -0.8740, -0.2593, -1.3066]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7188, -0.6357,  0.3374,  ..., -1.0703, -0.8979, -1.3721]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4980,  0.2651, -0.3589,  ..., -0.4563, -0.0571, -0.9702]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7441,  0.0697, -0.1166,  ..., -0.6528, -0.6958, -1.0361]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5459,  1.1836,  1.0039,  ..., -0.7607, -0.1428, -1.4482]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7915,  0.9883,  1.2461,  ..., -0.9570, -0.7812, -1.5137]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2651,  0.3223,  1.5537,  ...,  0.4448, -0.8706, -1.3623]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5107,  0.1268,  1.7959,  ...,  0.2483, -1.5098, -1.4277]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 74/321
Image: idp02095-K135Mi.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3955, -0.3784,  1.3506,  ..., -0.7935, -1.5957, -0.3999]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1499, -0.5737,  1.5928,  ..., -0.9902, -2.2344, -0.4653]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7344, -0.4346,  0.6367,  ..., -1.5801, -1.4766, -0.7246]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9805, -0.6299,  0.8789,  ..., -1.7764, -2.1152, -0.7900]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3418, -0.3652, -0.0303,  ..., -0.7021, -0.0664, -1.2676]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5879, -0.5605,  0.2119,  ..., -0.8984, -0.7051, -1.3330]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4902,  0.3225, -0.3269,  ..., -0.4473, -0.0820, -0.9863]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7363,  0.1271, -0.0846,  ..., -0.6436, -0.7207, -1.0518]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6396,  1.2188,  1.0576,  ..., -0.7578, -0.1714, -1.4863]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8853,  1.0234,  1.2998,  ..., -0.9541, -0.8101, -1.5518]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2625,  0.3447,  1.5967,  ...,  0.4038, -0.8320, -1.3662]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5078,  0.1493,  1.8389,  ...,  0.2073, -1.4707, -1.4316]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 75/321
Image: 13022_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4031, -0.4648,  1.2754,  ..., -0.7305, -1.6992, -0.3389]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1575, -0.6602,  1.5176,  ..., -0.9268, -2.3379, -0.4043]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7051, -0.2869,  0.4922,  ..., -1.4844, -1.5986, -0.6826]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9512, -0.4824,  0.7344,  ..., -1.6807, -2.2383, -0.7480]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3965, -0.6382,  0.1138,  ..., -0.9189, -0.3108, -1.2324]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6426, -0.8335,  0.3562,  ..., -1.1152, -0.9492, -1.2979]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5547,  0.2491, -0.3835,  ..., -0.3882, -0.1516, -0.9043]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8008,  0.0537, -0.1412,  ..., -0.5850, -0.7900, -0.9697]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6304,  1.2461,  0.9946,  ..., -0.7837, -0.1536, -1.5039]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8760,  1.0508,  1.2373,  ..., -0.9805, -0.7920, -1.5693]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2737,  0.3267,  1.5078,  ...,  0.4346, -0.8525, -1.3389]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5195,  0.1312,  1.7500,  ...,  0.2380, -1.4912, -1.4043]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 76/321
Image: idp00021b.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4424, -0.3740,  1.3574,  ..., -0.7388, -1.6543, -0.3672]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1968, -0.5693,  1.5996,  ..., -0.9355, -2.2930, -0.4326]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6787, -0.2627,  0.5483,  ..., -1.4287, -1.5742, -0.7065]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9238, -0.4580,  0.7905,  ..., -1.6250, -2.2129, -0.7720]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3906, -0.5483,  0.0998,  ..., -0.8853, -0.2227, -1.2510]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6367, -0.7437,  0.3420,  ..., -1.0820, -0.8613, -1.3164]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5098,  0.3044, -0.3855,  ..., -0.3887, -0.0980, -0.9160]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7559,  0.1090, -0.1432,  ..., -0.5850, -0.7368, -0.9814]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5488,  1.2295,  1.0605,  ..., -0.7583, -0.1599, -1.4531]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7944,  1.0342,  1.3027,  ..., -0.9551, -0.7988, -1.5186]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2673,  0.2827,  1.5371,  ...,  0.4595, -0.8745, -1.3027]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5127,  0.0873,  1.7793,  ...,  0.2629, -1.5137, -1.3682]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 77/321
Image: WKY6_14_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3862, -0.4485,  1.2539,  ..., -0.7891, -1.6807, -0.3657]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1406, -0.6440,  1.4961,  ..., -0.9854, -2.3203, -0.4312]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7148, -0.2561,  0.4917,  ..., -1.4385, -1.6191, -0.7285]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9609, -0.4517,  0.7339,  ..., -1.6348, -2.2578, -0.7939]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3672, -0.4902, -0.0019,  ..., -0.6387, -0.2424, -1.1758]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6133, -0.6855,  0.2405,  ..., -0.8350, -0.8809, -1.2412]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5518,  0.2622, -0.3435,  ..., -0.3945, -0.1278, -0.9268]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7969,  0.0668, -0.1012,  ..., -0.5908, -0.7666, -0.9922]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.7007,  1.2363,  1.0498,  ..., -0.7559, -0.1570, -1.5654]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9463,  1.0410,  1.2920,  ..., -0.9521, -0.7959, -1.6309]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3059,  0.3459,  1.6211,  ...,  0.3892, -0.8140, -1.3975]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5518,  0.1505,  1.8633,  ...,  0.1926, -1.4531, -1.4629]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 78/321
Image: IDP04248-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3689, -0.3623,  1.3262,  ..., -0.7686, -1.6016, -0.3779]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1233, -0.5576,  1.5684,  ..., -0.9648, -2.2402, -0.4434]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7441, -0.2908,  0.5688,  ..., -1.3271, -1.5488, -0.7217]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9902, -0.4863,  0.8110,  ..., -1.5234, -2.1875, -0.7871]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3955, -0.4141, -0.0754,  ..., -0.6069, -0.1511, -1.2021]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6406, -0.6094,  0.1670,  ..., -0.8037, -0.7900, -1.2676]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5137,  0.2964, -0.3057,  ..., -0.4001, -0.0740, -0.9727]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.1010, -0.0634,  ..., -0.5967, -0.7129, -1.0381]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6299,  1.1680,  1.1211,  ..., -0.7178, -0.1945, -1.5059]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8755,  0.9727,  1.3633,  ..., -0.9141, -0.8330, -1.5713]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2817,  0.3252,  1.6250,  ...,  0.4639, -0.8315, -1.3125]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5273,  0.1298,  1.8672,  ...,  0.2673, -1.4707, -1.3779]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 79/321
Image: AK_h6h_f2_2_9_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3682, -0.3984,  1.3350,  ..., -0.7388, -1.6504, -0.3501]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1226, -0.5938,  1.5771,  ..., -0.9355, -2.2891, -0.4155]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7344, -0.3574,  0.5840,  ..., -1.5303, -1.5996, -0.6753]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9805, -0.5527,  0.8262,  ..., -1.7266, -2.2383, -0.7407]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4746, -0.5225,  0.0434,  ..., -0.8481, -0.2649, -1.3037]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7207, -0.7178,  0.2856,  ..., -1.0449, -0.9033, -1.3691]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5420,  0.3538, -0.4006,  ..., -0.4421, -0.0941, -0.9102]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7871,  0.1583, -0.1583,  ..., -0.6387, -0.7329, -0.9756]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5142,  1.3701,  0.9160,  ..., -0.6182, -0.3091, -1.2734]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7598,  1.1748,  1.1582,  ..., -0.8145, -0.9478, -1.3389]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3948,  0.3291,  1.5098,  ...,  0.4473, -0.9536, -1.3096]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.6406,  0.1337,  1.7520,  ...,  0.2507, -1.5918, -1.3750]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 80/321
Image: m2c6g.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3923, -0.4182,  1.4473,  ..., -0.7632, -1.6768, -0.3784]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1467, -0.6138,  1.6895,  ..., -0.9600, -2.3164, -0.4438]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7070, -0.3101,  0.5273,  ..., -1.4678, -1.5283, -0.6553]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.5054,  0.7695,  ..., -1.6641, -2.1680, -0.7207]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2773, -0.5771, -0.0864,  ..., -0.7158, -0.1768, -1.1836]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5234, -0.7725,  0.1560,  ..., -0.9121, -0.8154, -1.2490]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5293,  0.2927, -0.3696,  ..., -0.4297, -0.1493, -0.9116]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7754,  0.0973, -0.1273,  ..., -0.6260, -0.7881, -0.9771]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6416,  1.2422,  1.1260,  ..., -0.8359, -0.2091, -1.5391]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8872,  1.0469,  1.3682,  ..., -1.0322, -0.8477, -1.6045]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3076,  0.3193,  1.5928,  ...,  0.3508, -0.8530, -1.3428]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5532,  0.1239,  1.8350,  ...,  0.1543, -1.4922, -1.4082]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 81/321
Image: 100122_M3_A8_peak.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5527, -0.3975,  1.4902,  ..., -0.7280, -1.6680, -0.3926]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.3071, -0.5928,  1.7324,  ..., -0.9248, -2.3066, -0.4580]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6504, -0.3203,  0.4551,  ..., -1.4893, -1.5156, -0.6704]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8965, -0.5156,  0.6973,  ..., -1.6855, -2.1543, -0.7358]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2510, -0.7026,  0.1541,  ..., -0.9248, -0.2092, -1.1465]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4961, -0.8979,  0.3965,  ..., -1.1211, -0.8477, -1.2119]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4277,  0.2612, -0.3406,  ..., -0.3999, -0.1810, -0.8672]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6738,  0.0658, -0.0983,  ..., -0.5967, -0.8198, -0.9326]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4951,  1.2178,  1.1445,  ..., -0.7256, -0.1692, -1.3809]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7407,  1.0225,  1.3867,  ..., -0.9219, -0.8076, -1.4463]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2642,  0.2881,  1.4912,  ...,  0.4597, -0.9229, -1.3223]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5098,  0.0927,  1.7334,  ...,  0.2632, -1.5615, -1.3877]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 82/321
Image: idp01962a.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4258, -0.4009,  1.3633,  ..., -0.7749, -1.6416, -0.3906]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1802, -0.5962,  1.6055,  ..., -0.9717, -2.2812, -0.4561]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6914, -0.4124,  0.6670,  ..., -1.5723, -1.5850, -0.7397]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9375, -0.6079,  0.9092,  ..., -1.7686, -2.2227, -0.8052]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4150, -0.4897,  0.1509,  ..., -0.9019, -0.2024, -1.2988]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6602, -0.6851,  0.3931,  ..., -1.0986, -0.8408, -1.3643]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4854,  0.2961, -0.3816,  ..., -0.4248, -0.0658, -0.9434]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7305,  0.1007, -0.1393,  ..., -0.6211, -0.7046, -1.0088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5645,  1.2070,  1.0381,  ..., -0.7563, -0.1656, -1.4482]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8101,  1.0117,  1.2803,  ..., -0.9531, -0.8042, -1.5137]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2484,  0.2786,  1.5762,  ...,  0.4321, -0.8579, -1.3291]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4941,  0.0831,  1.8184,  ...,  0.2356, -1.4961, -1.3945]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 83/321
Image: pipm-d8g.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4097, -0.4033,  1.3486,  ..., -0.7554, -1.6064, -0.3696]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1641, -0.5986,  1.5908,  ..., -0.9521, -2.2461, -0.4351]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7354, -0.4204,  0.6299,  ..., -1.5283, -1.5391, -0.7241]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9805, -0.6157,  0.8721,  ..., -1.7246, -2.1777, -0.7896]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3545, -0.4028,  0.0052,  ..., -0.6606, -0.1647, -1.2207]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5996, -0.5981,  0.2476,  ..., -0.8574, -0.8032, -1.2861]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5322,  0.3167, -0.3359,  ..., -0.4294, -0.0953, -0.9731]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7773,  0.1212, -0.0936,  ..., -0.6260, -0.7339, -1.0391]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6562,  1.2227,  1.0654,  ..., -0.7090, -0.1840, -1.4824]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9019,  1.0273,  1.3076,  ..., -0.9053, -0.8228, -1.5479]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2822,  0.3809,  1.6084,  ...,  0.4443, -0.8398, -1.3672]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5278,  0.1854,  1.8506,  ...,  0.2478, -1.4785, -1.4326]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 84/321
Image: p2_j11.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4746, -0.4194,  1.5801,  ..., -0.7051, -1.7031, -0.3994]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2290, -0.6147,  1.8223,  ..., -0.9014, -2.3418, -0.4648]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7256, -0.4517,  0.6841,  ..., -1.6445, -1.5840, -0.6567]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9707, -0.6470,  0.9263,  ..., -1.8408, -2.2227, -0.7222]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2900, -0.6592,  0.1536,  ..., -1.0303, -0.2319, -1.2510]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5352, -0.8545,  0.3960,  ..., -1.2266, -0.8706, -1.3164]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4434,  0.2217, -0.3442,  ..., -0.4514, -0.1104, -0.8931]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6895,  0.0262, -0.1019,  ..., -0.6479, -0.7490, -0.9585]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5703,  1.2480,  1.0547,  ..., -0.8027, -0.1575, -1.4688]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8159,  1.0527,  1.2969,  ..., -0.9990, -0.7959, -1.5342]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2274,  0.2852,  1.5498,  ...,  0.4265, -0.8135, -1.3223]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4731,  0.0897,  1.7920,  ...,  0.2300, -1.4521, -1.3877]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 85/321
Image: ixr1-8.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3799, -0.3867,  1.3477,  ..., -0.8237, -1.6074, -0.3975]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1343, -0.5820,  1.5898,  ..., -1.0205, -2.2461, -0.4629]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6953, -0.4351,  0.6606,  ..., -1.5039, -1.5361, -0.7388]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.6304,  0.9028,  ..., -1.7002, -2.1758, -0.8042]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4160, -0.3945, -0.0311,  ..., -0.6562, -0.1436, -1.2627]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6621, -0.5898,  0.2112,  ..., -0.8525, -0.7822, -1.3281]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5020,  0.2917, -0.3447,  ..., -0.4497, -0.0941, -0.9434]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7480,  0.0963, -0.1024,  ..., -0.6465, -0.7329, -1.0088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6445,  1.1836,  1.0498,  ..., -0.7515, -0.1715, -1.4756]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8901,  0.9883,  1.2920,  ..., -0.9482, -0.8101, -1.5410]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3005,  0.3296,  1.6426,  ...,  0.4014, -0.8516, -1.3486]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5459,  0.1342,  1.8848,  ...,  0.2048, -1.4902, -1.4141]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 86/321
Image: idp90682-n1_B.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4155, -0.3984,  1.3105,  ..., -0.7959, -1.6025, -0.3828]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1699, -0.5938,  1.5527,  ..., -0.9922, -2.2422, -0.4482]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7285, -0.3049,  0.5581,  ..., -1.3779, -1.5850, -0.7363]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9746, -0.5005,  0.8003,  ..., -1.5742, -2.2227, -0.8018]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4004, -0.4209, -0.0400,  ..., -0.6465, -0.1704, -1.2236]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6465, -0.6162,  0.2024,  ..., -0.8428, -0.8091, -1.2891]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5234,  0.2869, -0.3484,  ..., -0.4197, -0.1003, -0.9580]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7695,  0.0914, -0.1061,  ..., -0.6162, -0.7393, -1.0234]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6455,  1.2012,  1.0713,  ..., -0.7437, -0.1855, -1.5195]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8911,  1.0059,  1.3135,  ..., -0.9404, -0.8242, -1.5850]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2893,  0.3296,  1.6094,  ...,  0.4434, -0.8394, -1.3447]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5352,  0.1342,  1.8516,  ...,  0.2468, -1.4785, -1.4102]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 87/321
Image: idp01705-n1_A.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4248, -0.4082,  1.3594,  ..., -0.7822, -1.6045, -0.3711]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1792, -0.6035,  1.6016,  ..., -0.9785, -2.2422, -0.4365]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7129, -0.3081,  0.4871,  ..., -1.4287, -1.5625, -0.7090]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9590, -0.5034,  0.7295,  ..., -1.6250, -2.2012, -0.7744]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3516, -0.4448, -0.0723,  ..., -0.6865, -0.1719, -1.2275]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5977, -0.6401,  0.1700,  ..., -0.8828, -0.8105, -1.2930]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5312,  0.3218, -0.3535,  ..., -0.4185, -0.1047, -0.9546]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7773,  0.1263, -0.1112,  ..., -0.6152, -0.7432, -1.0205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6357,  1.2344,  1.0762,  ..., -0.7568, -0.2034, -1.5156]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8813,  1.0391,  1.3184,  ..., -0.9531, -0.8418, -1.5811]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2688,  0.3298,  1.5488,  ...,  0.4302, -0.8281, -1.3076]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5146,  0.1344,  1.7910,  ...,  0.2336, -1.4668, -1.3730]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 88/321
Image: ANL2D7sucr-peak.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5435, -0.4155,  1.5000,  ..., -0.7212, -1.6426, -0.3540]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2979, -0.6108,  1.7422,  ..., -0.9180, -2.2812, -0.4194]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6807, -0.3354,  0.4268,  ..., -1.4727, -1.5215, -0.6797]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9258, -0.5308,  0.6689,  ..., -1.6689, -2.1602, -0.7451]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2764, -0.6401,  0.1174,  ..., -0.9331, -0.2098, -1.1963]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5215, -0.8354,  0.3599,  ..., -1.1299, -0.8486, -1.2617]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4873,  0.3308, -0.3225,  ..., -0.3716, -0.1863, -0.8765]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7324,  0.1354, -0.0802,  ..., -0.5684, -0.8252, -0.9419]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5439,  1.3027,  1.0625,  ..., -0.7573, -0.2195, -1.4424]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7896,  1.1074,  1.3047,  ..., -0.9541, -0.8584, -1.5078]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2542,  0.3279,  1.4668,  ...,  0.4424, -0.8838, -1.3369]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4998,  0.1324,  1.7090,  ...,  0.2458, -1.5225, -1.4023]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 89/321
Image: fdi5-8.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3818, -0.3691,  1.3184,  ..., -0.8223, -1.5898, -0.4028]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1362, -0.5645,  1.5605,  ..., -1.0186, -2.2285, -0.4683]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7207, -0.2703,  0.5825,  ..., -1.3350, -1.5293, -0.7725]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9668, -0.4658,  0.8247,  ..., -1.5312, -2.1680, -0.8379]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4375, -0.3838, -0.0532,  ..., -0.6396, -0.1617, -1.1934]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6836, -0.5791,  0.1891,  ..., -0.8359, -0.8003, -1.2588]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5400,  0.3320, -0.3171,  ..., -0.4292, -0.1152, -0.9434]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7852,  0.1366, -0.0748,  ..., -0.6260, -0.7539, -1.0088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6201,  1.2090,  1.0537,  ..., -0.7471, -0.1705, -1.4941]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8657,  1.0137,  1.2959,  ..., -0.9434, -0.8091, -1.5596]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2847,  0.3223,  1.6074,  ...,  0.4185, -0.8486, -1.3594]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5303,  0.1268,  1.8496,  ...,  0.2219, -1.4873, -1.4248]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 90/321
Image: 1001_M2_B7_high.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5117, -0.4209,  1.4609,  ..., -0.7671, -1.6348, -0.3687]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2661, -0.6162,  1.7031,  ..., -0.9639, -2.2734, -0.4341]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6631, -0.4810,  0.5557,  ..., -1.6055, -1.5820, -0.6553]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9082, -0.6763,  0.7979,  ..., -1.8018, -2.2207, -0.7207]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3174, -0.6055,  0.1152,  ..., -0.9404, -0.2075, -1.2480]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5625, -0.8008,  0.3574,  ..., -1.1367, -0.8462, -1.3135]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4824,  0.3071, -0.3794,  ..., -0.4219, -0.1145, -0.9277]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7285,  0.1117, -0.1371,  ..., -0.6182, -0.7529, -0.9932]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5239,  1.1602,  1.0811,  ..., -0.7661, -0.1517, -1.3906]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7695,  0.9648,  1.3232,  ..., -0.9629, -0.7905, -1.4561]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2695,  0.3027,  1.4668,  ...,  0.4553, -0.9214, -1.3369]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5151,  0.1073,  1.7090,  ...,  0.2588, -1.5605, -1.4023]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 91/321
Image: AK_h6h_f2_2_10_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3411, -0.4072,  1.2969,  ..., -0.7314, -1.6621, -0.3413]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0955, -0.6025,  1.5391,  ..., -0.9277, -2.3008, -0.4067]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7930, -0.2346,  0.5430,  ..., -1.3301, -1.5918, -0.6611]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0391, -0.4302,  0.7852,  ..., -1.5264, -2.2305, -0.7266]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4922, -0.5356,  0.0433,  ..., -0.8154, -0.3154, -1.2539]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7383, -0.7310,  0.2856,  ..., -1.0117, -0.9541, -1.3193]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5420,  0.3394, -0.3538,  ..., -0.3877, -0.1187, -0.8867]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7871,  0.1439, -0.1115,  ..., -0.5840, -0.7573, -0.9521]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5493,  1.2588,  1.0713,  ..., -0.7891, -0.1981, -1.4609]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7949,  1.0635,  1.3135,  ..., -0.9854, -0.8369, -1.5264]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3315,  0.3032,  1.5645,  ...,  0.3916, -0.8970, -1.3574]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5771,  0.1078,  1.8066,  ...,  0.1951, -1.5352, -1.4229]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 92/321
Image: idp90922c.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4023, -0.4033,  1.2891,  ..., -0.7695, -1.6777, -0.3691]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1567, -0.5986,  1.5312,  ..., -0.9658, -2.3164, -0.4346]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7148, -0.2163,  0.6094,  ..., -1.4160, -1.6240, -0.7461]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9609, -0.4116,  0.8516,  ..., -1.6123, -2.2617, -0.8115]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4336, -0.4604,  0.1202,  ..., -0.8545, -0.2715, -1.2549]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6797, -0.6558,  0.3625,  ..., -1.0508, -0.9102, -1.3203]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5137,  0.2827, -0.3662,  ..., -0.3875, -0.1176, -0.9277]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.0873, -0.1239,  ..., -0.5840, -0.7563, -0.9932]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5576,  1.2207,  1.0400,  ..., -0.7275, -0.1473, -1.4609]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8032,  1.0254,  1.2822,  ..., -0.9238, -0.7861, -1.5264]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3154,  0.3027,  1.5742,  ...,  0.4683, -0.8726, -1.3252]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5610,  0.1073,  1.8164,  ...,  0.2717, -1.5117, -1.3906]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 93/321
Image: 11039_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3887, -0.4072,  1.2988,  ..., -0.7583, -1.6602, -0.3711]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1431, -0.6025,  1.5410,  ..., -0.9551, -2.2988, -0.4365]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7207, -0.3667,  0.6865,  ..., -1.5469, -1.6270, -0.7598]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9668, -0.5620,  0.9287,  ..., -1.7432, -2.2656, -0.8252]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4336, -0.4521,  0.1196,  ..., -0.8911, -0.2164, -1.3154]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6797, -0.6475,  0.3618,  ..., -1.0879, -0.8550, -1.3809]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4941,  0.2834, -0.3606,  ..., -0.4109, -0.0834, -0.9658]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7402,  0.0880, -0.1183,  ..., -0.6074, -0.7222, -1.0312]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5610,  1.2324,  1.0400,  ..., -0.7656, -0.1339, -1.4219]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8066,  1.0371,  1.2822,  ..., -0.9619, -0.7725, -1.4873]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2666,  0.3245,  1.5586,  ...,  0.4253, -0.8613, -1.3320]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5122,  0.1290,  1.8008,  ...,  0.2288, -1.5000, -1.3975]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 94/321
Image: 18596_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4509, -0.3926,  1.3301,  ..., -0.7773, -1.6133, -0.3945]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2053, -0.5879,  1.5723,  ..., -0.9736, -2.2520, -0.4600]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6914, -0.4390,  0.5928,  ..., -1.5537, -1.5254, -0.7393]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9375, -0.6343,  0.8350,  ..., -1.7500, -2.1641, -0.8047]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3359, -0.4468, -0.0233,  ..., -0.6802, -0.1564, -1.2031]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5820, -0.6421,  0.2190,  ..., -0.8770, -0.7949, -1.2686]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5273,  0.3220, -0.3298,  ..., -0.4607, -0.0763, -0.9331]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7734,  0.1266, -0.0875,  ..., -0.6572, -0.7148, -0.9985]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6123,  1.1992,  1.0566,  ..., -0.7959, -0.1061, -1.4844]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8579,  1.0039,  1.2988,  ..., -0.9922, -0.7446, -1.5498]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2837,  0.3271,  1.5840,  ...,  0.4102, -0.8447, -1.4023]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5293,  0.1317,  1.8262,  ...,  0.2136, -1.4834, -1.4678]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 95/321
Image: idp02082-n1_A.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3276, -0.3926,  1.4082,  ..., -0.7783, -1.6641, -0.3760]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0820, -0.5879,  1.6504,  ..., -0.9746, -2.3027, -0.4414]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7119, -0.2688,  0.5342,  ..., -1.4297, -1.5176, -0.6914]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9570, -0.4644,  0.7764,  ..., -1.6260, -2.1562, -0.7568]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3633, -0.4858, -0.0930,  ..., -0.6367, -0.1406, -1.1846]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6094, -0.6812,  0.1493,  ..., -0.8330, -0.7793, -1.2500]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5293,  0.3035, -0.3472,  ..., -0.4119, -0.1288, -0.9116]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7754,  0.1080, -0.1049,  ..., -0.6084, -0.7676, -0.9771]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6479,  1.1875,  1.0889,  ..., -0.7676, -0.1963, -1.4883]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8936,  0.9922,  1.3311,  ..., -0.9639, -0.8350, -1.5537]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3108,  0.3276,  1.6348,  ...,  0.4160, -0.8301, -1.3213]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5566,  0.1322,  1.8770,  ...,  0.2195, -1.4688, -1.3867]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 96/321
Image: uft3-10_test.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3594, -0.3765,  1.2559,  ..., -0.8091, -1.5986, -0.3604]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1138, -0.5718,  1.4980,  ..., -1.0059, -2.2383, -0.4258]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7578, -0.2522,  0.5757,  ..., -1.3271, -1.5967, -0.7700]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0039, -0.4478,  0.8179,  ..., -1.5234, -2.2344, -0.8354]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4434, -0.3799, -0.0796,  ..., -0.5947, -0.1899, -1.1875]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6895, -0.5752,  0.1627,  ..., -0.7910, -0.8286, -1.2529]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5381,  0.3069, -0.3394,  ..., -0.4324, -0.0979, -0.9414]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.1115, -0.0970,  ..., -0.6289, -0.7363, -1.0068]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6172,  1.1729,  1.0508,  ..., -0.6953, -0.1783, -1.4883]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8628,  0.9775,  1.2930,  ..., -0.8916, -0.8169, -1.5537]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3037,  0.3262,  1.6348,  ...,  0.4692, -0.8545, -1.3096]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5493,  0.1307,  1.8770,  ...,  0.2727, -1.4932, -1.3750]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 97/321
Image: r9_3.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4946, -0.3840,  1.5146,  ..., -0.7402, -1.6787, -0.3853]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2490, -0.5796,  1.7568,  ..., -0.9365, -2.3164, -0.4507]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6592, -0.3589,  0.4844,  ..., -1.4824, -1.5029, -0.6777]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9043, -0.5542,  0.7266,  ..., -1.6787, -2.1406, -0.7432]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2529, -0.6299,  0.1107,  ..., -0.9644, -0.1973, -1.2285]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4980, -0.8252,  0.3530,  ..., -1.1611, -0.8359, -1.2939]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4580,  0.2988, -0.3364,  ..., -0.4209, -0.1410, -0.8965]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7031,  0.1034, -0.0941,  ..., -0.6172, -0.7798, -0.9619]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5273,  1.2852,  1.0596,  ..., -0.7720, -0.1602, -1.4590]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7729,  1.0898,  1.3018,  ..., -0.9688, -0.7988, -1.5244]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2517,  0.3140,  1.5254,  ...,  0.4297, -0.8442, -1.3340]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4973,  0.1185,  1.7676,  ...,  0.2332, -1.4824, -1.3994]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 98/321
Image: CalS13-S2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3569, -0.3735,  1.4170,  ..., -0.7666, -1.6709, -0.3789]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1113, -0.5688,  1.6592,  ..., -0.9629, -2.3086, -0.4443]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7266, -0.2314,  0.5352,  ..., -1.4248, -1.5039, -0.7207]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9727, -0.4268,  0.7773,  ..., -1.6211, -2.1426, -0.7861]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3232, -0.4849, -0.1174,  ..., -0.6763, -0.1327, -1.1699]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5684, -0.6802,  0.1249,  ..., -0.8730, -0.7715, -1.2354]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5137,  0.3218, -0.3545,  ..., -0.3938, -0.1180, -0.8916]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.1263, -0.1122,  ..., -0.5903, -0.7568, -0.9570]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5933,  1.1953,  1.1260,  ..., -0.8379, -0.1890, -1.4941]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8389,  1.0000,  1.3682,  ..., -1.0342, -0.8276, -1.5596]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2971,  0.3267,  1.6064,  ...,  0.3784, -0.8564, -1.3145]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5430,  0.1312,  1.8486,  ...,  0.1819, -1.4951, -1.3799]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 99/321
Image: 60620_3_E2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4258, -0.4016,  1.4072,  ..., -0.7778, -1.6680, -0.4160]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1802, -0.5972,  1.6494,  ..., -0.9746, -2.3066, -0.4814]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6719, -0.3984,  0.5869,  ..., -1.6602, -1.5283, -0.7061]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9180, -0.5938,  0.8291,  ..., -1.8564, -2.1680, -0.7715]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3809, -0.5410,  0.0526,  ..., -0.9580, -0.1805, -1.3281]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6270, -0.7363,  0.2949,  ..., -1.1543, -0.8193, -1.3936]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5137,  0.3135, -0.4106,  ..., -0.4587, -0.0959, -0.9253]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.1180, -0.1683,  ..., -0.6553, -0.7344, -0.9907]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5938,  1.2666,  0.9888,  ..., -0.7910, -0.1523, -1.4541]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8394,  1.0713,  1.2314,  ..., -0.9873, -0.7910, -1.5195]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2747,  0.2998,  1.5127,  ...,  0.4006, -0.8389, -1.3623]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5205,  0.1044,  1.7549,  ...,  0.2041, -1.4775, -1.4277]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 100/321
Image: 170412_1_E2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4636, -0.4172,  1.3311,  ..., -0.7515, -1.6279, -0.3677]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2180, -0.6128,  1.5732,  ..., -0.9482, -2.2656, -0.4331]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7129, -0.2847,  0.4919,  ..., -1.4473, -1.5371, -0.7280]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9590, -0.4800,  0.7344,  ..., -1.6436, -2.1758, -0.7935]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4248, -0.5581,  0.0878,  ..., -0.8779, -0.2321, -1.2510]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6699, -0.7534,  0.3301,  ..., -1.0742, -0.8706, -1.3164]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5215,  0.2769, -0.3538,  ..., -0.3838, -0.1162, -0.8999]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7676,  0.0814, -0.1115,  ..., -0.5801, -0.7549, -0.9653]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5596,  1.2559,  1.0312,  ..., -0.7378, -0.1447, -1.4678]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8052,  1.0605,  1.2734,  ..., -0.9346, -0.7832, -1.5332]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2465,  0.2925,  1.5234,  ...,  0.4302, -0.8745, -1.3643]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4922,  0.0970,  1.7656,  ...,  0.2336, -1.5137, -1.4297]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 101/321
Image: 18596_1_E2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3823, -0.3901,  1.2812,  ..., -0.8091, -1.6074, -0.3867]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1367, -0.5854,  1.5234,  ..., -1.0059, -2.2461, -0.4521]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6943, -0.3923,  0.6465,  ..., -1.4961, -1.5820, -0.7461]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9395, -0.5879,  0.8887,  ..., -1.6924, -2.2207, -0.8115]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4189, -0.3838, -0.0580,  ..., -0.6450, -0.1703, -1.2266]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6641, -0.5791,  0.1843,  ..., -0.8418, -0.8091, -1.2920]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5322,  0.3245, -0.3342,  ..., -0.4761, -0.0795, -0.9375]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7773,  0.1290, -0.0919,  ..., -0.6729, -0.7183, -1.0029]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6489,  1.2002,  1.0205,  ..., -0.7427, -0.1647, -1.4883]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8945,  1.0049,  1.2627,  ..., -0.9395, -0.8032, -1.5537]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2993,  0.3433,  1.6133,  ...,  0.4336, -0.8516, -1.3701]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5449,  0.1478,  1.8555,  ...,  0.2371, -1.4902, -1.4355]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 102/321
Image: idp00873a.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3525, -0.3743,  1.3047,  ..., -0.8271, -1.5986, -0.3936]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1069, -0.5698,  1.5469,  ..., -1.0234, -2.2383, -0.4590]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7295, -0.4163,  0.6318,  ..., -1.5029, -1.5273, -0.7700]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9746, -0.6118,  0.8740,  ..., -1.6992, -2.1660, -0.8354]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4238, -0.3672, -0.0419,  ..., -0.6367, -0.1337, -1.2734]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6699, -0.5625,  0.2004,  ..., -0.8330, -0.7725, -1.3389]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5303,  0.3250, -0.3533,  ..., -0.4690, -0.0908, -0.9751]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7754,  0.1295, -0.1110,  ..., -0.6655, -0.7295, -1.0410]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6401,  1.1865,  1.0430,  ..., -0.7393, -0.1873, -1.4785]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8857,  0.9912,  1.2852,  ..., -0.9355, -0.8262, -1.5439]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2808,  0.3320,  1.6143,  ...,  0.4302, -0.8354, -1.3418]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5264,  0.1366,  1.8564,  ...,  0.2336, -1.4746, -1.4072]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 103/321
Image: omx7-2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3398, -0.4141,  1.3887,  ..., -0.7817, -1.6699, -0.3867]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0942, -0.6094,  1.6309,  ..., -0.9785, -2.3086, -0.4521]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6787, -0.3916,  0.6553,  ..., -1.5537, -1.5664, -0.7134]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9238, -0.5869,  0.8975,  ..., -1.7500, -2.2051, -0.7788]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4004, -0.4282, -0.0980,  ..., -0.6343, -0.1506, -1.2324]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6465, -0.6235,  0.1443,  ..., -0.8311, -0.7891, -1.2979]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5439,  0.3120, -0.3667,  ..., -0.4697, -0.1343, -0.9434]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7891,  0.1166, -0.1244,  ..., -0.6660, -0.7729, -1.0088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6465,  1.1660,  1.0566,  ..., -0.7676, -0.2019, -1.4912]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8921,  0.9707,  1.2988,  ..., -0.9639, -0.8408, -1.5566]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3164,  0.3340,  1.6250,  ...,  0.4014, -0.8423, -1.3516]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5620,  0.1385,  1.8672,  ...,  0.2048, -1.4805, -1.4170]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 104/321
Image: 53-a4-2-1-peak1.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4541, -0.3975,  1.4863,  ..., -0.7632, -1.6680, -0.3867]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2085, -0.5928,  1.7285,  ..., -0.9600, -2.3066, -0.4521]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6895, -0.3008,  0.4551,  ..., -1.5068, -1.4863, -0.7383]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9355, -0.4961,  0.6973,  ..., -1.7031, -2.1250, -0.8037]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3662, -0.6016,  0.0839,  ..., -0.9395, -0.2019, -1.2373]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6113, -0.7969,  0.3262,  ..., -1.1357, -0.8408, -1.3027]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5166,  0.3208, -0.3674,  ..., -0.4185, -0.1362, -0.8833]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.1254, -0.1251,  ..., -0.6152, -0.7749, -0.9487]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5566,  1.3037,  1.0156,  ..., -0.7896, -0.1538, -1.4658]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8022,  1.1084,  1.2578,  ..., -0.9863, -0.7925, -1.5312]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2571,  0.3091,  1.5020,  ...,  0.4229, -0.8623, -1.3652]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5029,  0.1136,  1.7441,  ...,  0.2263, -1.5010, -1.4307]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 105/321
Image: gw004-2b.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3628, -0.3979,  1.4082,  ..., -0.7759, -1.6484, -0.3750]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1172, -0.5933,  1.6504,  ..., -0.9727, -2.2871, -0.4404]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6914, -0.2986,  0.5278,  ..., -1.4238, -1.5547, -0.6826]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9375, -0.4941,  0.7700,  ..., -1.6201, -2.1934, -0.7480]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3262, -0.4990, -0.0673,  ..., -0.6992, -0.1666, -1.1895]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5723, -0.6943,  0.1750,  ..., -0.8955, -0.8052, -1.2549]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5371,  0.2983, -0.3398,  ..., -0.4292, -0.1285, -0.9209]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.1029, -0.0975,  ..., -0.6260, -0.7671, -0.9863]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6543,  1.2363,  1.0781,  ..., -0.7979, -0.2010, -1.5156]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8999,  1.0410,  1.3203,  ..., -0.9941, -0.8398, -1.5811]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2891,  0.3303,  1.5820,  ...,  0.3921, -0.8408, -1.3457]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5347,  0.1349,  1.8242,  ...,  0.1956, -1.4795, -1.4111]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 106/321
Image: ukc9-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3037, -0.3911,  1.3838,  ..., -0.8052, -1.6230, -0.3843]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0581, -0.5864,  1.6260,  ..., -1.0020, -2.2617, -0.4497]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6729, -0.4180,  0.6338,  ..., -1.5342, -1.5176, -0.7148]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9180, -0.6133,  0.8760,  ..., -1.7305, -2.1562, -0.7803]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3887, -0.4297, -0.0463,  ..., -0.6836, -0.1429, -1.2324]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6348, -0.6250,  0.1960,  ..., -0.8799, -0.7817, -1.2979]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5586,  0.3379, -0.3665,  ..., -0.5029, -0.0833, -0.9600]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8047,  0.1425, -0.1241,  ..., -0.6992, -0.7217, -1.0254]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6538,  1.2090,  1.0518,  ..., -0.7959, -0.2097, -1.4873]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8994,  1.0137,  1.2939,  ..., -0.9922, -0.8486, -1.5527]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2949,  0.3516,  1.5879,  ...,  0.3735, -0.8281, -1.3877]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5405,  0.1561,  1.8301,  ...,  0.1770, -1.4668, -1.4531]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 107/321
Image: pma4-8.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4534, -0.4067,  1.4268,  ..., -0.7529, -1.6504, -0.3804]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2078, -0.6021,  1.6689,  ..., -0.9492, -2.2891, -0.4458]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6963, -0.3206,  0.4719,  ..., -1.4551, -1.5430, -0.7017]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.5161,  0.7144,  ..., -1.6514, -2.1816, -0.7671]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3076, -0.5093, -0.0884,  ..., -0.6704, -0.1572, -1.2148]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5527, -0.7046,  0.1539,  ..., -0.8672, -0.7959, -1.2803]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5420,  0.3218, -0.3582,  ..., -0.3904, -0.1339, -0.9429]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7871,  0.1263, -0.1158,  ..., -0.5869, -0.7725, -1.0088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6445,  1.2402,  1.0986,  ..., -0.7451, -0.2161, -1.5312]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8901,  1.0449,  1.3408,  ..., -0.9414, -0.8545, -1.5967]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2634,  0.3311,  1.5713,  ...,  0.4375, -0.8501, -1.2949]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5088,  0.1356,  1.8135,  ...,  0.2410, -1.4883, -1.3604]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 108/321
Image: r3_7.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3936, -0.4189,  1.4600,  ..., -0.7749, -1.6611, -0.3818]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1479, -0.6143,  1.7021,  ..., -0.9717, -2.3008, -0.4473]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7012, -0.3228,  0.5312,  ..., -1.4678, -1.5000, -0.6440]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9473, -0.5181,  0.7734,  ..., -1.6641, -2.1387, -0.7095]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3066, -0.5415, -0.0906,  ..., -0.7290, -0.1406, -1.1797]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5527, -0.7368,  0.1517,  ..., -0.9258, -0.7793, -1.2451]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5625,  0.3066, -0.3855,  ..., -0.4221, -0.1273, -0.9224]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8086,  0.1112, -0.1432,  ..., -0.6187, -0.7661, -0.9878]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6772,  1.2666,  1.0801,  ..., -0.7720, -0.1990, -1.5410]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9229,  1.0713,  1.3223,  ..., -0.9688, -0.8379, -1.6064]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2834,  0.3396,  1.5664,  ...,  0.4038, -0.8345, -1.3164]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5293,  0.1442,  1.8086,  ...,  0.2073, -1.4727, -1.3818]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 109/321
Image: IDP01143-3.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3584, -0.3774,  1.2666,  ..., -0.8184, -1.5918, -0.3774]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1128, -0.5728,  1.5088,  ..., -1.0146, -2.2305, -0.4429]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7617, -0.3911,  0.6660,  ..., -1.5117, -1.5684, -0.7251]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0078, -0.5864,  0.9082,  ..., -1.7080, -2.2070, -0.7905]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4287, -0.3301, -0.0917,  ..., -0.6177, -0.1195, -1.2549]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6738, -0.5254,  0.1506,  ..., -0.8145, -0.7583, -1.3203]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5205,  0.3110, -0.3618,  ..., -0.4565, -0.0782, -0.9697]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7656,  0.1156, -0.1195,  ..., -0.6533, -0.7168, -1.0352]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6514,  1.1836,  1.0225,  ..., -0.7246, -0.1957, -1.4756]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8970,  0.9883,  1.2646,  ..., -0.9209, -0.8345, -1.5410]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3137,  0.3491,  1.6094,  ...,  0.4482, -0.8525, -1.3330]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5596,  0.1537,  1.8516,  ...,  0.2517, -1.4912, -1.3984]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 110/321
Image: 14775_2_E1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3838, -0.4082,  1.2764,  ..., -0.7539, -1.6748, -0.3379]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1382, -0.6035,  1.5186,  ..., -0.9502, -2.3125, -0.4033]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7441, -0.2571,  0.6226,  ..., -1.3789, -1.6680, -0.7007]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9902, -0.4526,  0.8647,  ..., -1.5752, -2.3066, -0.7661]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4668, -0.4404,  0.0388,  ..., -0.8486, -0.2664, -1.2266]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7129, -0.6357,  0.2812,  ..., -1.0449, -0.9053, -1.2920]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4961,  0.2484, -0.3521,  ..., -0.3926, -0.1122, -0.9043]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7422,  0.0530, -0.1097,  ..., -0.5889, -0.7510, -0.9697]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5791,  1.2266,  1.0430,  ..., -0.7373, -0.1631, -1.4785]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8247,  1.0312,  1.2852,  ..., -0.9336, -0.8018, -1.5439]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3347,  0.3157,  1.5967,  ...,  0.4617, -0.8975, -1.3418]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5801,  0.1202,  1.8389,  ...,  0.2651, -1.5361, -1.4072]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 111/321
Image: 13498_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4314, -0.4602,  1.4062,  ..., -0.7656, -1.7207, -0.3691]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1858, -0.6558,  1.6484,  ..., -0.9619, -2.3594, -0.4346]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6934, -0.4065,  0.6221,  ..., -1.6572, -1.6143, -0.6182]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9395, -0.6021,  0.8643,  ..., -1.8535, -2.2539, -0.6836]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3877, -0.5537, -0.0413,  ..., -0.9365, -0.1963, -1.2666]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6328, -0.7490,  0.2010,  ..., -1.1328, -0.8350, -1.3320]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5459,  0.2874, -0.4343,  ..., -0.4297, -0.0999, -0.9341]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7910,  0.0919, -0.1920,  ..., -0.6260, -0.7383, -0.9995]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5571,  1.1377,  1.0303,  ..., -0.8271, -0.0867, -1.3906]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8027,  0.9424,  1.2725,  ..., -1.0234, -0.7256, -1.4561]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3237,  0.3267,  1.4277,  ...,  0.4355, -0.9155, -1.3223]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5693,  0.1312,  1.6699,  ...,  0.2390, -1.5547, -1.3877]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 112/321
Image: idp90300d.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4131, -0.3794,  1.4414,  ..., -0.7837, -1.6260, -0.4062]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1675, -0.5747,  1.6836,  ..., -0.9805, -2.2656, -0.4717]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6973, -0.4531,  0.6240,  ..., -1.5762, -1.4854, -0.7051]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9434, -0.6484,  0.8662,  ..., -1.7725, -2.1250, -0.7705]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3379, -0.4229, -0.0213,  ..., -0.7090, -0.0915, -1.2314]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5840, -0.6182,  0.2209,  ..., -0.9053, -0.7300, -1.2969]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5156,  0.3281, -0.3433,  ..., -0.4807, -0.0851, -0.9673]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.1327, -0.1010,  ..., -0.6772, -0.7236, -1.0332]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6465,  1.2217,  1.0576,  ..., -0.7510, -0.1837, -1.4922]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8921,  1.0264,  1.2998,  ..., -0.9473, -0.8223, -1.5576]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2700,  0.3345,  1.5664,  ...,  0.3894, -0.8369, -1.3945]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5156,  0.1390,  1.8086,  ...,  0.1929, -1.4756, -1.4600]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 113/321
Image: 121774_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3633, -0.4282,  1.3428,  ..., -0.7607, -1.6748, -0.3477]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1177, -0.6235,  1.5850,  ..., -0.9570, -2.3125, -0.4131]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7324, -0.2393,  0.5347,  ..., -1.4336, -1.5859, -0.6709]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9785, -0.4346,  0.7769,  ..., -1.6299, -2.2246, -0.7363]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4580, -0.5312,  0.0386,  ..., -0.9121, -0.3025, -1.2109]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7031, -0.7266,  0.2808,  ..., -1.1084, -0.9414, -1.2764]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5479,  0.2827, -0.3962,  ..., -0.3843, -0.1134, -0.8877]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7930,  0.0873, -0.1539,  ..., -0.5811, -0.7520, -0.9531]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5649,  1.2275,  1.0518,  ..., -0.7788, -0.1663, -1.4453]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8105,  1.0322,  1.2939,  ..., -0.9756, -0.8047, -1.5107]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2910,  0.3250,  1.5352,  ...,  0.4458, -0.9028, -1.3076]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5366,  0.1295,  1.7773,  ...,  0.2493, -1.5410, -1.3730]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 114/321
Image: idp01182-2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4553, -0.3862,  1.3965,  ..., -0.7783, -1.6025, -0.3672]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2097, -0.5815,  1.6387,  ..., -0.9746, -2.2422, -0.4326]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7324, -0.3240,  0.4675,  ..., -1.4395, -1.5156, -0.7041]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9785, -0.5195,  0.7100,  ..., -1.6357, -2.1543, -0.7695]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3457, -0.4741, -0.0671,  ..., -0.6821, -0.1409, -1.2070]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5918, -0.6694,  0.1753,  ..., -0.8789, -0.7793, -1.2725]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5371,  0.3362, -0.3608,  ..., -0.3960, -0.1273, -0.9614]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.1407, -0.1185,  ..., -0.5928, -0.7661, -1.0273]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6265,  1.2412,  1.1035,  ..., -0.7529, -0.2190, -1.5127]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8721,  1.0459,  1.3457,  ..., -0.9492, -0.8574, -1.5781]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2915,  0.3345,  1.5586,  ...,  0.4268, -0.8647, -1.3311]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5371,  0.1390,  1.8008,  ...,  0.2302, -1.5039, -1.3965]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 115/321
Image: idp00418_4PV4.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5537, -0.4158,  1.4883,  ..., -0.7598, -1.6631, -0.3955]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.3081, -0.6113,  1.7305,  ..., -0.9561, -2.3008, -0.4609]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6689, -0.3284,  0.4438,  ..., -1.4619, -1.5391, -0.6968]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9141, -0.5239,  0.6860,  ..., -1.6582, -2.1777, -0.7622]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2754, -0.6807,  0.1428,  ..., -0.9253, -0.2139, -1.2168]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5215, -0.8760,  0.3853,  ..., -1.1221, -0.8525, -1.2822]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5098,  0.2974, -0.3701,  ..., -0.3926, -0.1519, -0.8916]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7559,  0.1019, -0.1278,  ..., -0.5889, -0.7905, -0.9570]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5205,  1.2002,  1.1689,  ..., -0.7500, -0.2017, -1.4131]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7661,  1.0049,  1.4111,  ..., -0.9463, -0.8403, -1.4785]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2666,  0.2834,  1.4648,  ...,  0.4399, -0.9351, -1.3320]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5122,  0.0880,  1.7070,  ...,  0.2434, -1.5742, -1.3975]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 116/321
Image: d30-amp-m1h11.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4653, -0.4565,  1.3535,  ..., -0.7847, -1.6738, -0.3848]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2197, -0.6519,  1.5957,  ..., -0.9814, -2.3125, -0.4502]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6885, -0.4656,  0.6348,  ..., -1.5928, -1.6377, -0.6670]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9336, -0.6611,  0.8770,  ..., -1.7891, -2.2773, -0.7324]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3262, -0.4702, -0.0533,  ..., -0.6670, -0.1775, -1.2568]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5723, -0.6655,  0.1891,  ..., -0.8633, -0.8164, -1.3223]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5127,  0.2695, -0.3767,  ..., -0.4429, -0.0879, -0.9673]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7578,  0.0741, -0.1344,  ..., -0.6396, -0.7266, -1.0332]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6470,  1.1055,  1.1035,  ..., -0.7871, -0.1438, -1.4600]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8926,  0.9102,  1.3457,  ..., -0.9834, -0.7822, -1.5254]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2969,  0.3086,  1.5400,  ...,  0.4187, -0.8638, -1.3506]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5425,  0.1132,  1.7822,  ...,  0.2222, -1.5020, -1.4160]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 117/321
Image: sacol_1320-2pk_A.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4478, -0.4043,  1.3838,  ..., -0.7422, -1.6533, -0.3633]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2021, -0.5996,  1.6260,  ..., -0.9385, -2.2930, -0.4287]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6914, -0.3909,  0.6191,  ..., -1.6133, -1.5957, -0.7148]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9375, -0.5864,  0.8613,  ..., -1.8096, -2.2344, -0.7803]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3848, -0.4780,  0.0480,  ..., -0.9258, -0.1622, -1.3145]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6309, -0.6733,  0.2903,  ..., -1.1221, -0.8008, -1.3799]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4756,  0.3171, -0.3792,  ..., -0.4382, -0.0620, -0.9673]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7207,  0.1217, -0.1368,  ..., -0.6348, -0.7007, -1.0332]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5503,  1.2275,  1.0479,  ..., -0.7871, -0.1519, -1.4277]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7959,  1.0322,  1.2900,  ..., -0.9834, -0.7905, -1.4932]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2554,  0.2925,  1.5430,  ...,  0.4565, -0.8457, -1.2988]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5010,  0.0970,  1.7852,  ...,  0.2600, -1.4844, -1.3643]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 118/321
Image: 86197_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4485, -0.3618,  1.3584,  ..., -0.7554, -1.6191, -0.3853]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2029, -0.5571,  1.6006,  ..., -0.9521, -2.2578, -0.4507]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7178, -0.2834,  0.5210,  ..., -1.4092, -1.5762, -0.7168]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9629, -0.4790,  0.7632,  ..., -1.6055, -2.2148, -0.7822]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3975, -0.5317,  0.0804,  ..., -0.8804, -0.1973, -1.2607]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6426, -0.7271,  0.3228,  ..., -1.0771, -0.8359, -1.3262]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4932,  0.2864, -0.3706,  ..., -0.3760, -0.0916, -0.9189]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7383,  0.0909, -0.1283,  ..., -0.5723, -0.7305, -0.9844]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5723,  1.2734,  1.0732,  ..., -0.7441, -0.1505, -1.4434]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8179,  1.0781,  1.3154,  ..., -0.9404, -0.7891, -1.5088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2710,  0.2881,  1.5586,  ...,  0.4326, -0.9082, -1.3301]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5166,  0.0927,  1.8008,  ...,  0.2361, -1.5469, -1.3955]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 119/321
Image: Idp90805_crystal1_1_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5098, -0.4204,  1.3457,  ..., -0.7695, -1.5781, -0.3501]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2642, -0.6157,  1.5879,  ..., -0.9658, -2.2168, -0.4155]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7402, -0.4980,  0.5767,  ..., -1.5752, -1.5430, -0.6680]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9863, -0.6934,  0.8188,  ..., -1.7715, -2.1816, -0.7334]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3105, -0.4346, -0.0449,  ..., -0.7490, -0.0933, -1.2656]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5566, -0.6299,  0.1974,  ..., -0.9453, -0.7319, -1.3311]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5088,  0.3025, -0.3674,  ..., -0.4644, -0.0682, -1.0078]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7539,  0.1071, -0.1251,  ..., -0.6611, -0.7070, -1.0732]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6519,  1.2256,  1.0576,  ..., -0.7422, -0.1895, -1.4912]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8975,  1.0303,  1.2998,  ..., -0.9385, -0.8281, -1.5566]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2419,  0.3389,  1.5430,  ...,  0.4395, -0.8521, -1.3398]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4875,  0.1434,  1.7852,  ...,  0.2429, -1.4902, -1.4053]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 120/321
Image: xtp3-5.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4553, -0.3862,  1.4023,  ..., -0.7432, -1.6387, -0.3843]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2097, -0.5815,  1.6445,  ..., -0.9395, -2.2773, -0.4497]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6738, -0.2656,  0.4902,  ..., -1.4619, -1.4805, -0.7173]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9199, -0.4609,  0.7324,  ..., -1.6582, -2.1191, -0.7827]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3828, -0.5708,  0.0813,  ..., -0.9082, -0.2074, -1.2363]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6289, -0.7661,  0.3237,  ..., -1.1045, -0.8462, -1.3018]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5195,  0.3240, -0.3755,  ..., -0.3894, -0.1107, -0.9019]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7656,  0.1285, -0.1332,  ..., -0.5859, -0.7495, -0.9673]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5498,  1.2490,  1.0488,  ..., -0.7441, -0.1469, -1.4512]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7954,  1.0537,  1.2910,  ..., -0.9404, -0.7856, -1.5166]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2588,  0.2803,  1.5303,  ...,  0.4517, -0.8623, -1.3174]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5044,  0.0848,  1.7725,  ...,  0.2551, -1.5010, -1.3828]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 121/321
Image: T6ODM_AKG_A6_3_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4854, -0.3945,  1.3164,  ..., -0.7363, -1.6182, -0.3350]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2397, -0.5898,  1.5586,  ..., -0.9326, -2.2578, -0.4004]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7422, -0.3069,  0.4707,  ..., -1.3760, -1.5947, -0.6904]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9883, -0.5024,  0.7129,  ..., -1.5723, -2.2344, -0.7559]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3584, -0.6133,  0.0468,  ..., -0.8799, -0.2330, -1.2285]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6035, -0.8086,  0.2891,  ..., -1.0762, -0.8716, -1.2939]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5400,  0.3181, -0.3909,  ..., -0.3560, -0.1396, -0.8906]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7852,  0.1227, -0.1486,  ..., -0.5527, -0.7783, -0.9561]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4851,  1.3916,  0.9688,  ..., -0.5938, -0.2913, -1.3262]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7305,  1.1963,  1.2109,  ..., -0.7900, -0.9297, -1.3916]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3604,  0.3115,  1.4805,  ...,  0.4707, -0.9717, -1.2861]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.6060,  0.1161,  1.7227,  ...,  0.2742, -1.6104, -1.3516]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 122/321
Image: 71075_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5166, -0.4094,  1.3613,  ..., -0.7656, -1.6260, -0.3677]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2710, -0.6050,  1.6035,  ..., -0.9619, -2.2656, -0.4331]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6895, -0.3428,  0.4587,  ..., -1.4277, -1.5645, -0.7378]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9355, -0.5381,  0.7012,  ..., -1.6240, -2.2031, -0.8032]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3701, -0.5811,  0.1469,  ..., -0.9087, -0.2289, -1.2354]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6152, -0.7764,  0.3892,  ..., -1.1055, -0.8677, -1.3008]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4775,  0.2917, -0.3540,  ..., -0.3904, -0.1029, -0.9214]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7227,  0.0963, -0.1117,  ..., -0.5869, -0.7417, -0.9868]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5352,  1.2617,  1.0596,  ..., -0.7295, -0.1670, -1.4570]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7808,  1.0664,  1.3018,  ..., -0.9258, -0.8057, -1.5225]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2417,  0.2915,  1.5225,  ...,  0.4531, -0.8989, -1.3662]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4873,  0.0961,  1.7646,  ...,  0.2566, -1.5371, -1.4316]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 123/321
Image: qlq2-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4580, -0.3896,  1.4014,  ..., -0.7451, -1.6582, -0.3521]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2124, -0.5850,  1.6436,  ..., -0.9414, -2.2969, -0.4175]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6689, -0.4702,  0.5664,  ..., -1.5957, -1.5723, -0.6958]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9141, -0.6655,  0.8086,  ..., -1.7920, -2.2109, -0.7612]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2549, -0.4600, -0.0414,  ..., -0.7051, -0.1263, -1.2275]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5000, -0.6553,  0.2009,  ..., -0.9014, -0.7651, -1.2930]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4609,  0.2954, -0.3311,  ..., -0.4229, -0.0675, -0.9766]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7070,  0.1000, -0.0887,  ..., -0.6191, -0.7061, -1.0420]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6235,  1.2051,  1.0879,  ..., -0.7383, -0.2094, -1.5146]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8691,  1.0098,  1.3301,  ..., -0.9346, -0.8481, -1.5801]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2556,  0.3374,  1.5664,  ...,  0.4580, -0.8174, -1.3359]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5010,  0.1420,  1.8086,  ...,  0.2615, -1.4561, -1.4014]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 124/321
Image: 36330_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4023, -0.4524,  1.3223,  ..., -0.7461, -1.6738, -0.3442]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1567, -0.6479,  1.5645,  ..., -0.9424, -2.3125, -0.4097]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7090, -0.2861,  0.5186,  ..., -1.4287, -1.6074, -0.6768]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9551, -0.4814,  0.7607,  ..., -1.6250, -2.2461, -0.7422]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3691, -0.4775, -0.1004,  ..., -0.6494, -0.2156, -1.1973]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6152, -0.6729,  0.1418,  ..., -0.8457, -0.8545, -1.2627]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5322,  0.2676, -0.3457,  ..., -0.3982, -0.1508, -0.9453]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7773,  0.0721, -0.1034,  ..., -0.5947, -0.7896, -1.0107]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6680,  1.2080,  1.0859,  ..., -0.7617, -0.2157, -1.5439]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9136,  1.0127,  1.3281,  ..., -0.9580, -0.8545, -1.6094]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2842,  0.3389,  1.5645,  ...,  0.4463, -0.8506, -1.3145]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5298,  0.1434,  1.8066,  ...,  0.2498, -1.4893, -1.3799]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 125/321
Image: oth155-5.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3770, -0.3879,  1.3008,  ..., -0.7930, -1.6221, -0.3818]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1313, -0.5835,  1.5430,  ..., -0.9893, -2.2617, -0.4473]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7246, -0.2888,  0.5601,  ..., -1.3594, -1.5820, -0.7456]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9707, -0.4844,  0.8022,  ..., -1.5557, -2.2207, -0.8110]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4971, -0.4976,  0.1125,  ..., -0.8682, -0.2820, -1.2666]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7422, -0.6929,  0.3550,  ..., -1.0645, -0.9209, -1.3320]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5400,  0.2891, -0.3757,  ..., -0.4048, -0.0831, -0.9551]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7852,  0.0936, -0.1334,  ..., -0.6016, -0.7217, -1.0205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5425,  1.1934,  1.0518,  ..., -0.7314, -0.1754, -1.4570]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7881,  0.9980,  1.2939,  ..., -0.9277, -0.8140, -1.5225]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2900,  0.2847,  1.5703,  ...,  0.4639, -0.8701, -1.3398]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5356,  0.0892,  1.8125,  ...,  0.2673, -1.5088, -1.4053]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 126/321
Image: KH12_2s1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4185, -0.4055,  1.3848,  ..., -0.7734, -1.6328, -0.3853]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1729, -0.6011,  1.6270,  ..., -0.9697, -2.2715, -0.4507]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6943, -0.3005,  0.5479,  ..., -1.4092, -1.5762, -0.7349]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9395, -0.4961,  0.7900,  ..., -1.6055, -2.2148, -0.8003]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3623, -0.4678, -0.0842,  ..., -0.6772, -0.1626, -1.2295]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6074, -0.6631,  0.1582,  ..., -0.8740, -0.8013, -1.2949]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5283,  0.2805, -0.3552,  ..., -0.4365, -0.0825, -0.9463]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7734,  0.0851, -0.1129,  ..., -0.6328, -0.7212, -1.0117]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6445,  1.2139,  1.1025,  ..., -0.7686, -0.2040, -1.5312]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8901,  1.0186,  1.3447,  ..., -0.9648, -0.8428, -1.5967]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2578,  0.3184,  1.5859,  ...,  0.4136, -0.8369, -1.3389]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5034,  0.1229,  1.8281,  ...,  0.2170, -1.4756, -1.4043]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 127/321
Image: dxo7-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3926, -0.3896,  1.3457,  ..., -0.8062, -1.5996, -0.3804]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1470, -0.5850,  1.5879,  ..., -1.0029, -2.2383, -0.4458]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7227, -0.2920,  0.5146,  ..., -1.3779, -1.5098, -0.7266]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9688, -0.4873,  0.7568,  ..., -1.5742, -2.1484, -0.7920]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3701, -0.4604, -0.0402,  ..., -0.6802, -0.1547, -1.1982]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6152, -0.6558,  0.2021,  ..., -0.8770, -0.7935, -1.2637]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5615,  0.3269, -0.3560,  ..., -0.4297, -0.1146, -0.9399]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8066,  0.1315, -0.1136,  ..., -0.6260, -0.7534, -1.0059]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6543,  1.2256,  1.0742,  ..., -0.7471, -0.2146, -1.5215]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8999,  1.0303,  1.3164,  ..., -0.9434, -0.8535, -1.5869]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2961,  0.3237,  1.5918,  ...,  0.4082, -0.8691, -1.3545]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5420,  0.1283,  1.8340,  ...,  0.2117, -1.5078, -1.4199]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 128/321
Image: llm2-5.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3306, -0.3877,  1.4521,  ..., -0.7866, -1.6611, -0.3794]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0850, -0.5830,  1.6943,  ..., -0.9834, -2.3008, -0.4448]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7344, -0.3848,  0.6392,  ..., -1.6006, -1.4766, -0.7021]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9805, -0.5801,  0.8813,  ..., -1.7969, -2.1152, -0.7676]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2920, -0.4912, -0.0398,  ..., -0.7373, -0.1132, -1.2344]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5371, -0.6865,  0.2025,  ..., -0.9336, -0.7520, -1.2998]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5215,  0.3267, -0.3679,  ..., -0.4385, -0.1012, -0.9380]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7676,  0.1312, -0.1256,  ..., -0.6348, -0.7397, -1.0039]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6626,  1.2168,  1.0908,  ..., -0.7900, -0.2349, -1.4766]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9082,  1.0215,  1.3330,  ..., -0.9863, -0.8735, -1.5420]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2825,  0.3545,  1.6094,  ...,  0.3535, -0.8257, -1.3301]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5283,  0.1591,  1.8516,  ...,  0.1570, -1.4648, -1.3955]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 129/321
Image: T1023_4_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5488, -0.3965,  1.4521,  ..., -0.7285, -1.6621, -0.3652]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.3032, -0.5918,  1.6943,  ..., -0.9248, -2.3008, -0.4307]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6670, -0.4426,  0.5898,  ..., -1.6631, -1.5332, -0.6694]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9121, -0.6382,  0.8320,  ..., -1.8594, -2.1719, -0.7349]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3184, -0.6006,  0.0789,  ..., -0.8901, -0.1581, -1.2334]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5645, -0.7959,  0.3213,  ..., -1.0869, -0.7969, -1.2988]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4834,  0.3284, -0.3950,  ..., -0.4116, -0.0826, -0.9199]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7285,  0.1329, -0.1527,  ..., -0.6084, -0.7212, -0.9854]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5430,  1.1836,  1.1045,  ..., -0.7236, -0.0452, -1.3652]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7886,  0.9883,  1.3467,  ..., -0.9199, -0.6841, -1.4307]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2639,  0.2739,  1.4922,  ...,  0.4507, -0.9077, -1.3164]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5098,  0.0785,  1.7344,  ...,  0.2542, -1.5469, -1.3818]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 130/321
Image: idp90645_3TSN.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5293, -0.4014,  1.5293,  ..., -0.7305, -1.7021, -0.3979]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2837, -0.5967,  1.7715,  ..., -0.9268, -2.3398, -0.4634]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6406, -0.4509,  0.6221,  ..., -1.6484, -1.5586, -0.6348]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8867, -0.6465,  0.8643,  ..., -1.8447, -2.1973, -0.7002]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2578, -0.6465,  0.0982,  ..., -0.9487, -0.1997, -1.2178]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5039, -0.8418,  0.3406,  ..., -1.1455, -0.8384, -1.2832]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4355,  0.3027, -0.3508,  ..., -0.4363, -0.1307, -0.9189]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6816,  0.1073, -0.1085,  ..., -0.6328, -0.7695, -0.9844]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5039,  1.1406,  1.1113,  ..., -0.7891, -0.1094, -1.3574]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7495,  0.9453,  1.3535,  ..., -0.9854, -0.7480, -1.4229]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2529,  0.2744,  1.4688,  ...,  0.4668, -0.8857, -1.2979]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4985,  0.0790,  1.7109,  ...,  0.2703, -1.5244, -1.3633]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 131/321
Image: 118551_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4644, -0.3931,  1.3975,  ..., -0.7466, -1.6094, -0.3486]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2188, -0.5884,  1.6396,  ..., -0.9434, -2.2480, -0.4141]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7031, -0.3584,  0.4543,  ..., -1.4512, -1.5508, -0.6934]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9492, -0.5537,  0.6968,  ..., -1.6475, -2.1895, -0.7588]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3809, -0.5859,  0.0896,  ..., -0.9214, -0.1954, -1.2490]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6270, -0.7812,  0.3320,  ..., -1.1182, -0.8340, -1.3145]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5234,  0.3154, -0.3684,  ..., -0.4023, -0.1053, -0.9229]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7695,  0.1200, -0.1261,  ..., -0.5986, -0.7441, -0.9883]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5684,  1.2764,  1.0605,  ..., -0.7715, -0.1653, -1.4443]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8140,  1.0811,  1.3027,  ..., -0.9678, -0.8037, -1.5098]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2391,  0.3027,  1.5156,  ...,  0.4358, -0.8872, -1.3281]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4849,  0.1073,  1.7578,  ...,  0.2393, -1.5254, -1.3936]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 132/321
Image: APC5899_c4_2_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3896, -0.3662,  1.4766,  ..., -0.7544, -1.6895, -0.4004]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1440, -0.5615,  1.7188,  ..., -0.9512, -2.3281, -0.4658]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6826, -0.3987,  0.6499,  ..., -1.5850, -1.5332, -0.6963]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9277, -0.5942,  0.8921,  ..., -1.7812, -2.1719, -0.7617]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2705, -0.4858,  0.0054,  ..., -0.7046, -0.1421, -1.1729]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5156, -0.6812,  0.2478,  ..., -0.9014, -0.7808, -1.2383]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4795,  0.3276, -0.2871,  ..., -0.4688, -0.0872, -0.9092]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7246,  0.1322, -0.0448,  ..., -0.6650, -0.7256, -0.9746]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5942,  1.1934,  1.1279,  ..., -0.8159, -0.1394, -1.4805]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8398,  0.9980,  1.3701,  ..., -1.0127, -0.7783, -1.5459]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2766,  0.3149,  1.6133,  ...,  0.4082, -0.7954, -1.3906]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5225,  0.1195,  1.8555,  ...,  0.2117, -1.4336, -1.4561]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 133/321
Image: Rb_Ado_1_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3496, -0.3918,  1.3027,  ..., -0.8184, -1.6064, -0.3882]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1040, -0.5874,  1.5449,  ..., -1.0146, -2.2461, -0.4536]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6973, -0.3076,  0.5293,  ..., -1.3447, -1.5332, -0.7847]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9434, -0.5029,  0.7715,  ..., -1.5410, -2.1719, -0.8501]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4385, -0.4268, -0.0250,  ..., -0.6377, -0.2213, -1.2051]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6836, -0.6221,  0.2173,  ..., -0.8340, -0.8599, -1.2705]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5254,  0.2646, -0.3523,  ..., -0.4043, -0.1180, -0.9487]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7715,  0.0692, -0.1100,  ..., -0.6006, -0.7568, -1.0146]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6221,  1.1641,  1.0801,  ..., -0.7480, -0.2059, -1.5273]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8677,  0.9688,  1.3223,  ..., -0.9443, -0.8447, -1.5928]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2981,  0.3154,  1.6221,  ...,  0.4019, -0.8604, -1.3916]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5439,  0.1200,  1.8643,  ...,  0.2053, -1.4990, -1.4570]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 134/321
Image: apc102469a.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3503, -0.3911,  1.3672,  ..., -0.7891, -1.6484, -0.3711]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1047, -0.5864,  1.6094,  ..., -0.9854, -2.2871, -0.4365]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7676, -0.2397,  0.5469,  ..., -1.3994, -1.5234, -0.6899]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0137, -0.4351,  0.7891,  ..., -1.5957, -2.1621, -0.7554]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3369, -0.4854, -0.0819,  ..., -0.6602, -0.1676, -1.1484]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5820, -0.6807,  0.1604,  ..., -0.8564, -0.8062, -1.2139]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5312,  0.3203, -0.3430,  ..., -0.4287, -0.1119, -0.9194]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7773,  0.1249, -0.1007,  ..., -0.6250, -0.7505, -0.9849]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6558,  1.2109,  1.1055,  ..., -0.7422, -0.2128, -1.4756]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9014,  1.0156,  1.3477,  ..., -0.9385, -0.8516, -1.5410]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3010,  0.3389,  1.6230,  ...,  0.4165, -0.8394, -1.3145]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5469,  0.1434,  1.8652,  ...,  0.2200, -1.4785, -1.3799]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 135/321
Image: a1d2-2peak.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4541, -0.4355,  1.5029,  ..., -0.6938, -1.6318, -0.3186]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2085, -0.6309,  1.7451,  ..., -0.8906, -2.2695, -0.3840]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6797, -0.4543,  0.5605,  ..., -1.6582, -1.5459, -0.6226]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9258, -0.6499,  0.8027,  ..., -1.8545, -2.1836, -0.6880]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2656, -0.5938,  0.1001,  ..., -0.9429, -0.1672, -1.2061]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5117, -0.7891,  0.3423,  ..., -1.1396, -0.8057, -1.2715]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4453,  0.3174, -0.3381,  ..., -0.3835, -0.1831, -0.9102]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6914,  0.1219, -0.0958,  ..., -0.5801, -0.8218, -0.9756]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5439,  1.2412,  1.0215,  ..., -0.7559, -0.1670, -1.4248]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7896,  1.0459,  1.2637,  ..., -0.9521, -0.8057, -1.4902]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2661,  0.3103,  1.4834,  ...,  0.4683, -0.8013, -1.2744]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5117,  0.1149,  1.7256,  ...,  0.2717, -1.4395, -1.3398]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 136/321
Image: bpt1_3_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3809, -0.4248,  1.2969,  ..., -0.7290, -1.6895, -0.3389]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1353, -0.6201,  1.5391,  ..., -0.9258, -2.3281, -0.4043]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7646, -0.1816,  0.5703,  ..., -1.4443, -1.6377, -0.6992]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0098, -0.3770,  0.8125,  ..., -1.6406, -2.2773, -0.7646]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3994, -0.5361,  0.0988,  ..., -0.8945, -0.2678, -1.1846]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6445, -0.7314,  0.3411,  ..., -1.0908, -0.9062, -1.2500]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4980,  0.2490, -0.3652,  ..., -0.4009, -0.1215, -0.9043]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7441,  0.0536, -0.1229,  ..., -0.5977, -0.7603, -0.9697]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5479,  1.2227,  1.0508,  ..., -0.8066, -0.1324, -1.4844]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7935,  1.0273,  1.2930,  ..., -1.0029, -0.7710, -1.5498]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2903,  0.3245,  1.5879,  ...,  0.4067, -0.8833, -1.3379]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5361,  0.1290,  1.8301,  ...,  0.2102, -1.5215, -1.4033]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 137/321
Image: APC234_Iy-28_1_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4658, -0.4121,  1.4434,  ..., -0.7549, -1.6533, -0.3682]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2202, -0.6074,  1.6855,  ..., -0.9512, -2.2930, -0.4336]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7021, -0.3391,  0.4846,  ..., -1.4453, -1.5938, -0.6670]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9473, -0.5347,  0.7271,  ..., -1.6416, -2.2324, -0.7324]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2568, -0.5317, -0.0706,  ..., -0.7178, -0.1710, -1.1719]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5020, -0.7271,  0.1718,  ..., -0.9141, -0.8096, -1.2373]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4990,  0.2666, -0.3306,  ..., -0.4114, -0.1144, -0.9062]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7441,  0.0712, -0.0883,  ..., -0.6079, -0.7529, -0.9717]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6431,  1.2383,  1.1045,  ..., -0.7568, -0.1763, -1.5410]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8887,  1.0430,  1.3467,  ..., -0.9531, -0.8149, -1.6064]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2477,  0.3335,  1.5723,  ...,  0.4329, -0.8213, -1.3291]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4932,  0.1381,  1.8145,  ...,  0.2363, -1.4600, -1.3945]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 138/321
Image: IDP04524-3.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5034, -0.4143,  1.4160,  ..., -0.7646, -1.6035, -0.3643]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2578, -0.6099,  1.6582,  ..., -0.9609, -2.2422, -0.4297]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6592, -0.4780,  0.5630,  ..., -1.5684, -1.5684, -0.6812]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9043, -0.6733,  0.8052,  ..., -1.7646, -2.2070, -0.7466]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3711, -0.5693,  0.1044,  ..., -0.9033, -0.2065, -1.2832]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6172, -0.7646,  0.3467,  ..., -1.0996, -0.8452, -1.3486]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4727,  0.3174, -0.3730,  ..., -0.4106, -0.0986, -0.9580]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7188,  0.1219, -0.1307,  ..., -0.6074, -0.7373, -1.0234]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4917,  1.1738,  1.0645,  ..., -0.7983, -0.1530, -1.4385]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7373,  0.9785,  1.3066,  ..., -0.9951, -0.7915, -1.5039]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2404,  0.2920,  1.5127,  ...,  0.4670, -0.8740, -1.3145]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4858,  0.0966,  1.7549,  ...,  0.2705, -1.5127, -1.3799]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 139/321
Image: hv1.12_03MAY2006_031e8_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4761, -0.4016,  1.3789,  ..., -0.7085, -1.6553, -0.3574]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2305, -0.5972,  1.6211,  ..., -0.9053, -2.2930, -0.4229]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7510, -0.2864,  0.4219,  ..., -1.4629, -1.5488, -0.7417]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9961, -0.4819,  0.6641,  ..., -1.6592, -2.1875, -0.8071]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3203, -0.6489,  0.1711,  ..., -0.9238, -0.2485, -1.2588]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5664, -0.8442,  0.4136,  ..., -1.1201, -0.8872, -1.3242]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4453,  0.2617, -0.3315,  ..., -0.3899, -0.1305, -0.9141]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6914,  0.0663, -0.0892,  ..., -0.5864, -0.7690, -0.9795]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5049,  1.1875,  1.1455,  ..., -0.8340, -0.1862, -1.4727]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7505,  0.9922,  1.3877,  ..., -1.0303, -0.8247, -1.5381]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2170,  0.2827,  1.5488,  ...,  0.4492, -0.8618, -1.3408]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4626,  0.0873,  1.7910,  ...,  0.2527, -1.5000, -1.4062]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 140/321
Image: m1g12-peak.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4084, -0.3896,  1.3613,  ..., -0.7744, -1.6445, -0.3848]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1628, -0.5850,  1.6035,  ..., -0.9707, -2.2832, -0.4502]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6729, -0.4109,  0.6763,  ..., -1.5703, -1.5615, -0.6997]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9180, -0.6064,  0.9185,  ..., -1.7666, -2.1992, -0.7651]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2891, -0.4155, -0.0570,  ..., -0.6724, -0.1214, -1.2305]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5352, -0.6108,  0.1853,  ..., -0.8691, -0.7603, -1.2959]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5020,  0.3086, -0.3430,  ..., -0.4512, -0.0918, -0.9634]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7480,  0.1132, -0.1007,  ..., -0.6475, -0.7305, -1.0293]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6201,  1.1807,  1.0693,  ..., -0.7935, -0.1456, -1.4805]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8657,  0.9854,  1.3115,  ..., -0.9902, -0.7842, -1.5459]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3071,  0.3127,  1.6309,  ...,  0.4050, -0.8350, -1.3359]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5527,  0.1173,  1.8730,  ...,  0.2085, -1.4736, -1.4014]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 141/321
Image: bdu3-7.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4331, -0.4021,  1.3252,  ..., -0.7861, -1.6123, -0.3813]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1875, -0.5977,  1.5674,  ..., -0.9824, -2.2500, -0.4468]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6641, -0.4348,  0.6143,  ..., -1.5527, -1.5918, -0.7451]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9102, -0.6304,  0.8564,  ..., -1.7490, -2.2305, -0.8105]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3340, -0.4399, -0.0125,  ..., -0.6592, -0.1819, -1.2549]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5801, -0.6353,  0.2297,  ..., -0.8555, -0.8203, -1.3203]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5107,  0.3044, -0.3674,  ..., -0.4487, -0.0802, -0.9717]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7559,  0.1090, -0.1251,  ..., -0.6455, -0.7188, -1.0371]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6533,  1.1992,  1.0557,  ..., -0.7295, -0.2083, -1.5078]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8989,  1.0039,  1.2979,  ..., -0.9258, -0.8467, -1.5732]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2693,  0.3091,  1.5703,  ...,  0.4351, -0.8257, -1.3418]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5146,  0.1136,  1.8125,  ...,  0.2385, -1.4648, -1.4072]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 142/321
Image: idp91154a.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4302, -0.3962,  1.3408,  ..., -0.7393, -1.6396, -0.3584]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1846, -0.5918,  1.5830,  ..., -0.9355, -2.2773, -0.4238]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7168, -0.2793,  0.5322,  ..., -1.4150, -1.4951, -0.6938]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9629, -0.4746,  0.7744,  ..., -1.6113, -2.1328, -0.7593]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4229, -0.5566,  0.0366,  ..., -0.8779, -0.2451, -1.2539]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6680, -0.7520,  0.2788,  ..., -1.0742, -0.8838, -1.3193]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5312,  0.3030, -0.3733,  ..., -0.3882, -0.1234, -0.9268]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7773,  0.1075, -0.1310,  ..., -0.5850, -0.7622, -0.9922]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5405,  1.2285,  1.0586,  ..., -0.7568, -0.1876, -1.4531]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7861,  1.0332,  1.3008,  ..., -0.9531, -0.8262, -1.5186]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2549,  0.2874,  1.5117,  ...,  0.4512, -0.8936, -1.3174]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5005,  0.0919,  1.7539,  ...,  0.2546, -1.5322, -1.3828]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 143/321
Image: idp1659-3_B.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4353, -0.4160,  1.4160,  ..., -0.7646, -1.6445, -0.3721]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1897, -0.6113,  1.6582,  ..., -0.9609, -2.2832, -0.4375]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6797, -0.4490,  0.5786,  ..., -1.5811, -1.5547, -0.7168]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9258, -0.6445,  0.8208,  ..., -1.7773, -2.1934, -0.7822]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3135, -0.4668, -0.0529,  ..., -0.7080, -0.1592, -1.2393]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5586, -0.6621,  0.1895,  ..., -0.9043, -0.7979, -1.3047]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5117,  0.3206, -0.3547,  ..., -0.4595, -0.1023, -0.9717]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7578,  0.1251, -0.1124,  ..., -0.6562, -0.7412, -1.0371]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6382,  1.2070,  1.0840,  ..., -0.7451, -0.2205, -1.5117]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8838,  1.0117,  1.3262,  ..., -0.9414, -0.8594, -1.5771]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2725,  0.3250,  1.5605,  ...,  0.4170, -0.8442, -1.3545]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5181,  0.1295,  1.8027,  ...,  0.2205, -1.4824, -1.4199]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 144/321
Image: idp90886c.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3877, -0.4165,  1.2988,  ..., -0.8066, -1.5898, -0.3740]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1421, -0.6118,  1.5410,  ..., -1.0029, -2.2285, -0.4395]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7314, -0.4316,  0.6416,  ..., -1.5527, -1.5410, -0.7139]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9766, -0.6270,  0.8838,  ..., -1.7490, -2.1797, -0.7793]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3652, -0.3862, -0.0720,  ..., -0.6670, -0.1379, -1.2471]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6113, -0.5815,  0.1703,  ..., -0.8633, -0.7764, -1.3125]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4902,  0.2954, -0.3662,  ..., -0.4565, -0.0560, -0.9917]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7363,  0.1000, -0.1239,  ..., -0.6533, -0.6948, -1.0576]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6484,  1.1836,  1.0488,  ..., -0.7451, -0.1908, -1.4922]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8940,  0.9883,  1.2910,  ..., -0.9414, -0.8296, -1.5576]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2722,  0.3225,  1.5977,  ...,  0.4307, -0.8135, -1.3369]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5176,  0.1271,  1.8398,  ...,  0.2341, -1.4521, -1.4023]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 145/321
Image: zty0-8.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4236, -0.3901,  1.3213,  ..., -0.7681, -1.6250, -0.3848]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1780, -0.5854,  1.5635,  ..., -0.9648, -2.2637, -0.4502]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7197, -0.2681,  0.5254,  ..., -1.4160, -1.5645, -0.7524]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9648, -0.4634,  0.7676,  ..., -1.6123, -2.2031, -0.8179]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3828, -0.4390, -0.0642,  ..., -0.6318, -0.1709, -1.2168]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6289, -0.6343,  0.1781,  ..., -0.8281, -0.8096, -1.2822]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5371,  0.3164, -0.3538,  ..., -0.3967, -0.0972, -0.9434]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.1210, -0.1115,  ..., -0.5933, -0.7358, -1.0088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6450,  1.2275,  1.0723,  ..., -0.7324, -0.1888, -1.5107]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8906,  1.0322,  1.3145,  ..., -0.9287, -0.8276, -1.5762]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2812,  0.3257,  1.5918,  ...,  0.4470, -0.8462, -1.3145]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5269,  0.1302,  1.8340,  ...,  0.2505, -1.4844, -1.3799]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 146/321
Image: 126564_3_E1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5049, -0.4006,  1.3564,  ..., -0.7339, -1.6270, -0.3608]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2593, -0.5962,  1.5986,  ..., -0.9307, -2.2656, -0.4263]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7070, -0.3042,  0.4692,  ..., -1.4482, -1.5869, -0.7637]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.4995,  0.7114,  ..., -1.6445, -2.2266, -0.8291]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3672, -0.5625,  0.0835,  ..., -0.9043, -0.2062, -1.2520]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6133, -0.7578,  0.3257,  ..., -1.1006, -0.8447, -1.3174]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4824,  0.2847, -0.3865,  ..., -0.3760, -0.1010, -0.9214]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7285,  0.0892, -0.1442,  ..., -0.5723, -0.7397, -0.9868]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5610,  1.2656,  1.0781,  ..., -0.7383, -0.1685, -1.4473]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8066,  1.0703,  1.3203,  ..., -0.9346, -0.8071, -1.5127]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2494,  0.2781,  1.5371,  ...,  0.4446, -0.9229, -1.3242]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4951,  0.0826,  1.7793,  ...,  0.2480, -1.5615, -1.3896]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 147/321
Image: IDP91191-11.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5034, -0.4094,  1.4170,  ..., -0.7500, -1.6104, -0.3364]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2578, -0.6050,  1.6592,  ..., -0.9463, -2.2500, -0.4019]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7021, -0.3555,  0.4233,  ..., -1.4434, -1.5293, -0.7007]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9473, -0.5508,  0.6655,  ..., -1.6396, -2.1680, -0.7661]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2646, -0.4771, -0.0654,  ..., -0.7256, -0.1155, -1.1826]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5098, -0.6724,  0.1769,  ..., -0.9219, -0.7539, -1.2480]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4824,  0.3191, -0.3213,  ..., -0.4043, -0.1254, -0.9473]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7285,  0.1237, -0.0790,  ..., -0.6006, -0.7642, -1.0127]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6299,  1.2520,  1.1104,  ..., -0.7466, -0.2036, -1.5137]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8755,  1.0566,  1.3525,  ..., -0.9434, -0.8423, -1.5791]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2374,  0.3274,  1.5332,  ...,  0.4443, -0.8428, -1.2959]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4829,  0.1320,  1.7754,  ...,  0.2478, -1.4814, -1.3613]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 148/321
Image: bas1428.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3154, -0.3577,  1.3213,  ..., -0.8408, -1.5908, -0.4019]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0698, -0.5532,  1.5635,  ..., -1.0371, -2.2305, -0.4673]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7305, -0.4014,  0.6489,  ..., -1.4805, -1.4844, -0.7427]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9766, -0.5967,  0.8911,  ..., -1.6768, -2.1230, -0.8081]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4551, -0.3501, -0.0325,  ..., -0.6572, -0.0871, -1.2373]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7012, -0.5454,  0.2097,  ..., -0.8535, -0.7256, -1.3027]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5352,  0.3555, -0.3447,  ..., -0.4939, -0.0635, -0.9541]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7812,  0.1600, -0.1024,  ..., -0.6904, -0.7021, -1.0195]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6328,  1.1943,  1.0430,  ..., -0.7734, -0.1652, -1.4512]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8784,  0.9990,  1.2852,  ..., -0.9697, -0.8037, -1.5166]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2612,  0.3472,  1.6465,  ...,  0.3936, -0.8262, -1.3545]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5068,  0.1517,  1.8887,  ...,  0.1970, -1.4648, -1.4199]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 149/321
Image: 1560-g5-peak.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4419, -0.4270,  1.4023,  ..., -0.7905, -1.6260, -0.3936]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1963, -0.6226,  1.6445,  ..., -0.9873, -2.2656, -0.4590]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6797, -0.4351,  0.5986,  ..., -1.6074, -1.5371, -0.6826]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9258, -0.6304,  0.8408,  ..., -1.8037, -2.1758, -0.7480]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3193, -0.4712, -0.0692,  ..., -0.7046, -0.1354, -1.2666]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5645, -0.6665,  0.1731,  ..., -0.9014, -0.7739, -1.3320]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5449,  0.3237, -0.3628,  ..., -0.4509, -0.1116, -0.9556]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7910,  0.1283, -0.1205,  ..., -0.6475, -0.7500, -1.0215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6738,  1.2393,  1.0547,  ..., -0.7666, -0.1985, -1.5166]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9194,  1.0439,  1.2969,  ..., -0.9629, -0.8369, -1.5820]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2788,  0.3347,  1.5488,  ...,  0.4033, -0.8408, -1.3516]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5244,  0.1393,  1.7910,  ...,  0.2068, -1.4795, -1.4170]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 150/321
Image: p1_d12.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3706, -0.3862,  1.4941,  ..., -0.7656, -1.7061, -0.3945]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1250, -0.5815,  1.7363,  ..., -0.9619, -2.3438, -0.4600]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7051, -0.2607,  0.5630,  ..., -1.5098, -1.4873, -0.6802]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9512, -0.4561,  0.8052,  ..., -1.7061, -2.1250, -0.7456]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2979, -0.6265,  0.0471,  ..., -1.0225, -0.2133, -1.2412]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5430, -0.8218,  0.2893,  ..., -1.2188, -0.8521, -1.3066]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5098,  0.3066, -0.3987,  ..., -0.4482, -0.1429, -0.8472]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7559,  0.1112, -0.1564,  ..., -0.6445, -0.7817, -0.9126]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5967,  1.3008,  1.0439,  ..., -0.8379, -0.1449, -1.4629]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8423,  1.1055,  1.2861,  ..., -1.0342, -0.7837, -1.5283]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3013,  0.3230,  1.5664,  ...,  0.3469, -0.8403, -1.3301]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5469,  0.1276,  1.8086,  ...,  0.1504, -1.4785, -1.3955]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 151/321
Image: 028014_mj57_a2a_test_5_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5146, -0.4019,  1.4912,  ..., -0.7529, -1.6562, -0.4004]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2690, -0.5972,  1.7334,  ..., -0.9492, -2.2949, -0.4658]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6816, -0.3193,  0.4624,  ..., -1.5156, -1.4570, -0.6987]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9277, -0.5146,  0.7046,  ..., -1.7119, -2.0957, -0.7642]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2930, -0.6460,  0.1125,  ..., -0.9375, -0.1675, -1.2168]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5391, -0.8413,  0.3550,  ..., -1.1338, -0.8062, -1.2822]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4785,  0.2954, -0.3418,  ..., -0.4038, -0.1428, -0.9077]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7246,  0.1000, -0.0995,  ..., -0.6006, -0.7812, -0.9731]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5581,  1.3027,  1.0703,  ..., -0.7549, -0.1660, -1.4570]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8037,  1.1074,  1.3125,  ..., -0.9512, -0.8047, -1.5225]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2578,  0.2878,  1.5254,  ...,  0.4309, -0.8496, -1.3545]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5034,  0.0924,  1.7676,  ...,  0.2344, -1.4883, -1.4199]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 152/321
Image: obr5-7.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3281, -0.3965,  1.3955,  ..., -0.7935, -1.6387, -0.3677]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0825, -0.5918,  1.6377,  ..., -0.9902, -2.2773, -0.4331]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6963, -0.2795,  0.5132,  ..., -1.4199, -1.4961, -0.7144]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.4751,  0.7554,  ..., -1.6162, -2.1348, -0.7798]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4062, -0.4609, -0.0760,  ..., -0.6699, -0.1548, -1.2080]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6523, -0.6562,  0.1663,  ..., -0.8662, -0.7935, -1.2734]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5469,  0.2937, -0.3601,  ..., -0.4321, -0.1030, -0.9404]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7930,  0.0983, -0.1178,  ..., -0.6289, -0.7417, -1.0059]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6475,  1.2178,  1.0732,  ..., -0.7646, -0.1930, -1.5322]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8931,  1.0225,  1.3154,  ..., -0.9609, -0.8315, -1.5977]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2776,  0.3403,  1.5801,  ...,  0.4014, -0.8267, -1.3457]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5234,  0.1449,  1.8223,  ...,  0.2048, -1.4648, -1.4111]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 153/321
Image: idp026381-3.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4392, -0.3716,  1.3320,  ..., -0.7832, -1.5869, -0.4155]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1936, -0.5669,  1.5742,  ..., -0.9795, -2.2266, -0.4810]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7656, -0.3228,  0.5586,  ..., -1.3330, -1.5449, -0.7363]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0117, -0.5181,  0.8008,  ..., -1.5293, -2.1836, -0.8018]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3975, -0.3936, -0.0532,  ..., -0.6699, -0.1057, -1.2129]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6426, -0.5889,  0.1891,  ..., -0.8662, -0.7441, -1.2783]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5176,  0.3210, -0.3320,  ..., -0.4546, -0.0618, -0.9976]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7637,  0.1256, -0.0897,  ..., -0.6514, -0.7002, -1.0635]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6226,  1.2217,  1.0869,  ..., -0.7593, -0.1765, -1.5020]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8682,  1.0264,  1.3291,  ..., -0.9561, -0.8154, -1.5674]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2629,  0.3318,  1.5986,  ...,  0.4268, -0.8530, -1.3750]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5088,  0.1364,  1.8408,  ...,  0.2302, -1.4922, -1.4404]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 154/321
Image: idp02527-1_A.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4351, -0.4131,  1.4023,  ..., -0.7622, -1.6318, -0.3857]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1895, -0.6084,  1.6445,  ..., -0.9590, -2.2695, -0.4512]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7393, -0.4277,  0.6719,  ..., -1.5762, -1.5527, -0.6748]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9844, -0.6230,  0.9141,  ..., -1.7725, -2.1914, -0.7402]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3164, -0.4370, -0.0732,  ..., -0.7061, -0.0930, -1.2686]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5625, -0.6323,  0.1691,  ..., -0.9023, -0.7314, -1.3340]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4854,  0.2891, -0.3701,  ..., -0.4763, -0.0752, -0.9595]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7305,  0.0936, -0.1278,  ..., -0.6729, -0.7139, -1.0254]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6270,  1.1113,  1.1074,  ..., -0.7832, -0.1389, -1.4326]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8726,  0.9160,  1.3496,  ..., -0.9795, -0.7773, -1.4980]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2859,  0.3208,  1.5469,  ...,  0.4141, -0.8916, -1.3164]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5312,  0.1254,  1.7891,  ...,  0.2175, -1.5303, -1.3818]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 155/321
Image: 7612_2_125.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5249, -0.4592,  1.3867,  ..., -0.7012, -1.6729, -0.3423]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2793, -0.6548,  1.6289,  ..., -0.8975, -2.3125, -0.4077]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7168, -0.3262,  0.3943,  ..., -1.5020, -1.5098, -0.6909]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9629, -0.5215,  0.6367,  ..., -1.6982, -2.1484, -0.7563]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.1875, -0.6157, -0.0108,  ..., -0.7476, -0.1698, -1.1035]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4336, -0.8110,  0.2316,  ..., -0.9443, -0.8086, -1.1689]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4531,  0.2646, -0.2913,  ..., -0.4211, -0.1604, -0.9292]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6992,  0.0692, -0.0490,  ..., -0.6177, -0.7988, -0.9946]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6802,  1.2842,  1.1172,  ..., -0.7559, -0.1968, -1.5352]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9258,  1.0889,  1.3594,  ..., -0.9521, -0.8354, -1.6006]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2454,  0.3381,  1.5820,  ...,  0.4790, -0.8472, -1.3418]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4910,  0.1427,  1.8242,  ...,  0.2825, -1.4863, -1.4072]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 156/321
Image: ESA_ESA_m_5_1_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5132, -0.4155,  1.3789,  ..., -0.7554, -1.6289, -0.3765]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2676, -0.6108,  1.6211,  ..., -0.9521, -2.2676, -0.4419]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6816, -0.3462,  0.5161,  ..., -1.4775, -1.5352, -0.6792]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9277, -0.5415,  0.7583,  ..., -1.6738, -2.1738, -0.7446]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2773, -0.5396, -0.0406,  ..., -0.7080, -0.1467, -1.1650]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5234, -0.7349,  0.2017,  ..., -0.9043, -0.7852, -1.2305]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4844,  0.2642, -0.3274,  ..., -0.4312, -0.1180, -0.9473]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7305,  0.0687, -0.0851,  ..., -0.6279, -0.7568, -1.0127]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5947,  1.1543,  1.1992,  ..., -0.7363, -0.1694, -1.4629]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8403,  0.9590,  1.4414,  ..., -0.9326, -0.8081, -1.5283]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2930,  0.2852,  1.5615,  ...,  0.4326, -0.9111, -1.3311]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5386,  0.0897,  1.8037,  ...,  0.2361, -1.5498, -1.3965]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 157/321
Image: idp04122-2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4675, -0.3823,  1.4072,  ..., -0.7539, -1.6309, -0.3867]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2219, -0.5776,  1.6494,  ..., -0.9502, -2.2695, -0.4521]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6973, -0.4646,  0.5908,  ..., -1.5762, -1.5791, -0.6943]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9434, -0.6602,  0.8330,  ..., -1.7725, -2.2188, -0.7598]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2529, -0.4771,  0.0112,  ..., -0.7002, -0.1124, -1.2529]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4980, -0.6724,  0.2534,  ..., -0.8965, -0.7510, -1.3184]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4844,  0.2986, -0.3411,  ..., -0.4167, -0.0573, -0.9897]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7305,  0.1031, -0.0988,  ..., -0.6133, -0.6958, -1.0557]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6543,  1.2041,  1.1201,  ..., -0.7334, -0.2102, -1.5117]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8999,  1.0088,  1.3623,  ..., -0.9297, -0.8486, -1.5771]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2546,  0.3064,  1.5938,  ...,  0.4402, -0.8208, -1.3398]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5000,  0.1110,  1.8359,  ...,  0.2437, -1.4590, -1.4053]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 158/321
Image: ymq0-4.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3184, -0.3926,  1.3701,  ..., -0.7891, -1.6123, -0.3892]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0728, -0.5879,  1.6123,  ..., -0.9854, -2.2500, -0.4546]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7021, -0.3906,  0.6182,  ..., -1.5664, -1.5078, -0.7310]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9473, -0.5859,  0.8604,  ..., -1.7627, -2.1465, -0.7964]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3760, -0.4336, -0.0359,  ..., -0.6846, -0.1069, -1.2568]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6211, -0.6289,  0.2064,  ..., -0.8809, -0.7456, -1.3223]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5615,  0.3491, -0.3472,  ..., -0.4868, -0.1210, -0.9629]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8066,  0.1537, -0.1049,  ..., -0.6836, -0.7598, -1.0283]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6562,  1.2148,  1.0752,  ..., -0.7837, -0.2056, -1.4609]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9019,  1.0195,  1.3174,  ..., -0.9805, -0.8442, -1.5264]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2944,  0.3630,  1.5742,  ...,  0.3882, -0.8369, -1.3516]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5400,  0.1676,  1.8164,  ...,  0.1917, -1.4756, -1.4170]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 159/321
Image: idp92610a.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4075, -0.4370,  1.4492,  ..., -0.7188, -1.6973, -0.3735]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1619, -0.6323,  1.6914,  ..., -0.9150, -2.3359, -0.4390]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6768, -0.4346,  0.6904,  ..., -1.6084, -1.6113, -0.6807]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9219, -0.6299,  0.9326,  ..., -1.8047, -2.2500, -0.7461]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3506, -0.5947,  0.0841,  ..., -0.9263, -0.2322, -1.2666]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5957, -0.7900,  0.3264,  ..., -1.1230, -0.8711, -1.3320]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4795,  0.2449, -0.4109,  ..., -0.4319, -0.0721, -0.9136]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7246,  0.0494, -0.1686,  ..., -0.6284, -0.7109, -0.9790]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5781,  1.2041,  1.0439,  ..., -0.7900, -0.1903, -1.4395]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8237,  1.0088,  1.2861,  ..., -0.9863, -0.8291, -1.5049]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2720,  0.2778,  1.5557,  ...,  0.4219, -0.8511, -1.3125]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5176,  0.0824,  1.7979,  ...,  0.2253, -1.4902, -1.3779]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 160/321
Image: idp00118-1_2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4199, -0.3911,  1.3135,  ..., -0.7896, -1.5889, -0.3848]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1743, -0.5864,  1.5557,  ..., -0.9863, -2.2266, -0.4502]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7080, -0.2981,  0.5439,  ..., -1.3564, -1.5918, -0.7505]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.4937,  0.7861,  ..., -1.5527, -2.2305, -0.8159]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4912, -0.5244,  0.1721,  ..., -0.8716, -0.2715, -1.2529]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7363, -0.7197,  0.4146,  ..., -1.0684, -0.9102, -1.3184]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5312,  0.2988, -0.3779,  ..., -0.4019, -0.0706, -0.9473]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7773,  0.1034, -0.1356,  ..., -0.5986, -0.7090, -1.0127]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5601,  1.2188,  1.0615,  ..., -0.7422, -0.1663, -1.4502]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8057,  1.0234,  1.3037,  ..., -0.9385, -0.8047, -1.5156]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2776,  0.2844,  1.5752,  ...,  0.4568, -0.8828, -1.3408]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5234,  0.0890,  1.8174,  ...,  0.2603, -1.5215, -1.4062]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 161/321
Image: xtal3.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4983, -0.3677,  1.5098,  ..., -0.7363, -1.6641, -0.3887]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2527, -0.5630,  1.7520,  ..., -0.9326, -2.3027, -0.4541]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7070, -0.3357,  0.4917,  ..., -1.4814, -1.5098, -0.6641]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.5312,  0.7339,  ..., -1.6777, -2.1484, -0.7295]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2363, -0.6626,  0.1105,  ..., -0.9614, -0.1962, -1.2129]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4824, -0.8579,  0.3528,  ..., -1.1582, -0.8350, -1.2783]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4492,  0.2856, -0.3447,  ..., -0.4258, -0.1213, -0.8970]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6953,  0.0902, -0.1024,  ..., -0.6221, -0.7598, -0.9624]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5479,  1.3076,  1.0791,  ..., -0.7798, -0.1525, -1.4434]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7935,  1.1123,  1.3213,  ..., -0.9766, -0.7910, -1.5088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2522,  0.2915,  1.5449,  ...,  0.4189, -0.8550, -1.3291]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4978,  0.0961,  1.7871,  ...,  0.2224, -1.4941, -1.3945]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 162/321
Image: 38495_3_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4163, -0.4114,  1.2500,  ..., -0.7178, -1.6543, -0.3281]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1707, -0.6069,  1.4922,  ..., -0.9141, -2.2930, -0.3936]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7676, -0.2881,  0.5552,  ..., -1.4131, -1.6123, -0.6870]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0137, -0.4834,  0.7974,  ..., -1.6094, -2.2500, -0.7524]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4326, -0.5161,  0.0041,  ..., -0.8647, -0.2498, -1.2129]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6777, -0.7114,  0.2465,  ..., -1.0615, -0.8887, -1.2783]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5137,  0.2937, -0.3801,  ..., -0.3682, -0.1166, -0.9458]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.0983, -0.1378,  ..., -0.5645, -0.7554, -1.0117]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5586,  1.2334,  1.0645,  ..., -0.7139, -0.1600, -1.4551]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8042,  1.0381,  1.3066,  ..., -0.9102, -0.7988, -1.5205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2883,  0.3223,  1.5439,  ...,  0.4883, -0.8784, -1.3164]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5342,  0.1268,  1.7861,  ...,  0.2917, -1.5176, -1.3818]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 163/321
Image: IDP01493-J-4-C.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3745, -0.4106,  1.3350,  ..., -0.7959, -1.6260, -0.3862]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1289, -0.6060,  1.5771,  ..., -0.9922, -2.2656, -0.4517]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7021, -0.2827,  0.5508,  ..., -1.3877, -1.5488, -0.7261]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9473, -0.4780,  0.7930,  ..., -1.5840, -2.1875, -0.7915]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4189, -0.4556, -0.0859,  ..., -0.6255, -0.1780, -1.1992]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6641, -0.6509,  0.1564,  ..., -0.8223, -0.8164, -1.2646]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5518,  0.2817, -0.3596,  ..., -0.4146, -0.0870, -0.9292]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7969,  0.0863, -0.1173,  ..., -0.6113, -0.7256, -0.9946]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6377,  1.1924,  1.0703,  ..., -0.7344, -0.1898, -1.5078]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8833,  0.9971,  1.3125,  ..., -0.9307, -0.8286, -1.5732]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2837,  0.3081,  1.6035,  ...,  0.4214, -0.8394, -1.3203]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5293,  0.1127,  1.8457,  ...,  0.2249, -1.4785, -1.3857]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 164/321
Image: 18596_1_E1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3911, -0.3882,  1.2861,  ..., -0.8086, -1.6094, -0.3862]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1455, -0.5835,  1.5283,  ..., -1.0049, -2.2480, -0.4517]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6934, -0.3921,  0.6455,  ..., -1.5000, -1.5820, -0.7725]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9395, -0.5874,  0.8877,  ..., -1.6963, -2.2207, -0.8379]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4131, -0.3857, -0.0458,  ..., -0.6411, -0.1835, -1.2383]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6582, -0.5811,  0.1965,  ..., -0.8379, -0.8223, -1.3037]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5195,  0.3049, -0.3237,  ..., -0.4578, -0.0822, -0.9331]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7656,  0.1095, -0.0814,  ..., -0.6543, -0.7207, -0.9985]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6562,  1.2051,  1.0254,  ..., -0.7529, -0.1501, -1.4834]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9019,  1.0098,  1.2676,  ..., -0.9492, -0.7891, -1.5488]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2920,  0.3477,  1.6230,  ...,  0.4209, -0.8379, -1.3867]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5376,  0.1522,  1.8652,  ...,  0.2244, -1.4766, -1.4521]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 165/321
Image: xBs2m.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4150, -0.3945,  1.4482,  ..., -0.7559, -1.6172, -0.3672]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1694, -0.5898,  1.6904,  ..., -0.9521, -2.2559, -0.4326]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6748, -0.4229,  0.5996,  ..., -1.6143, -1.5039, -0.6396]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9199, -0.6182,  0.8418,  ..., -1.8105, -2.1426, -0.7051]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3721, -0.5278,  0.0657,  ..., -0.9609, -0.1338, -1.2900]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6172, -0.7231,  0.3081,  ..., -1.1572, -0.7725, -1.3555]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5215,  0.3440, -0.3833,  ..., -0.4609, -0.0913, -0.9204]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7676,  0.1486, -0.1410,  ..., -0.6572, -0.7300, -0.9858]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5312,  1.2090,  1.0439,  ..., -0.8687, -0.1426, -1.4355]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7769,  1.0137,  1.2861,  ..., -1.0654, -0.7812, -1.5010]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2708,  0.3059,  1.5010,  ...,  0.4211, -0.8486, -1.3105]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5166,  0.1105,  1.7432,  ...,  0.2246, -1.4873, -1.3760]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 166/321
Image: 3gc2_idp994-3.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3787, -0.4082,  1.3350,  ..., -0.7808, -1.6270, -0.3828]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1331, -0.6035,  1.5771,  ..., -0.9775, -2.2656, -0.4482]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7314, -0.2827,  0.5391,  ..., -1.4102, -1.5439, -0.7183]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9766, -0.4780,  0.7812,  ..., -1.6064, -2.1836, -0.7837]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3955, -0.4434, -0.1140,  ..., -0.6592, -0.1526, -1.2061]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6406, -0.6387,  0.1283,  ..., -0.8555, -0.7910, -1.2715]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5449,  0.3008, -0.3694,  ..., -0.4231, -0.1077, -0.9341]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7910,  0.1053, -0.1271,  ..., -0.6196, -0.7461, -0.9995]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6436,  1.2168,  1.0537,  ..., -0.7642, -0.2096, -1.5127]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8892,  1.0215,  1.2959,  ..., -0.9609, -0.8481, -1.5781]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2849,  0.3296,  1.5957,  ...,  0.4258, -0.8564, -1.3174]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5303,  0.1342,  1.8379,  ...,  0.2292, -1.4951, -1.3828]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 167/321
Image: 1507_102_dropb3M2-29-gly-high.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.6406, -0.4053,  1.5449,  ..., -0.7349, -1.6387, -0.4204]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.3950, -0.6006,  1.7871,  ..., -0.9316, -2.2773, -0.4858]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6504, -0.3455,  0.4380,  ..., -1.3857, -1.5371, -0.6401]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8965, -0.5410,  0.6802,  ..., -1.5820, -2.1758, -0.7056]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2129, -0.6851,  0.1973,  ..., -0.8809, -0.2133, -1.1768]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4590, -0.8804,  0.4395,  ..., -1.0771, -0.8521, -1.2422]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4209,  0.3003, -0.2673,  ..., -0.3521, -0.2568, -0.8491]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6660,  0.1049, -0.0250,  ..., -0.5488, -0.8955, -0.9146]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4324,  1.2070,  1.1758,  ..., -0.7188, -0.2415, -1.3867]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.6777,  1.0117,  1.4180,  ..., -0.9150, -0.8799, -1.4521]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2228,  0.3171,  1.4629,  ...,  0.4719, -0.9897, -1.3457]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4683,  0.1217,  1.7051,  ...,  0.2754, -1.6289, -1.4111]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 168/321
Image: rutr-e.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4541, -0.4094,  1.3174,  ..., -0.7671, -1.6094, -0.3706]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2085, -0.6050,  1.5596,  ..., -0.9639, -2.2480, -0.4360]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7207, -0.3123,  0.5200,  ..., -1.3828, -1.5654, -0.7261]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9668, -0.5078,  0.7622,  ..., -1.5791, -2.2031, -0.7915]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3896, -0.4448, -0.0498,  ..., -0.6528, -0.1675, -1.2197]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6348, -0.6401,  0.1925,  ..., -0.8496, -0.8062, -1.2852]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5332,  0.3027, -0.3325,  ..., -0.4180, -0.1088, -0.9712]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7793,  0.1073, -0.0902,  ..., -0.6143, -0.7476, -1.0371]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6421,  1.2061,  1.0986,  ..., -0.7407, -0.1907, -1.5166]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8877,  1.0107,  1.3408,  ..., -0.9375, -0.8291, -1.5820]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2617,  0.3269,  1.5771,  ...,  0.4348, -0.8735, -1.3379]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5073,  0.1315,  1.8193,  ...,  0.2383, -1.5117, -1.4033]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 169/321
Image: IDP91988-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4575, -0.3975,  1.3311,  ..., -0.7881, -1.5938, -0.3774]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2119, -0.5928,  1.5732,  ..., -0.9844, -2.2324, -0.4429]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7422, -0.3223,  0.4810,  ..., -1.3750, -1.5449, -0.7373]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9883, -0.5176,  0.7231,  ..., -1.5713, -2.1836, -0.8027]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3643, -0.4478, -0.0459,  ..., -0.6812, -0.1670, -1.2227]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6094, -0.6431,  0.1964,  ..., -0.8779, -0.8057, -1.2881]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5303,  0.3049, -0.3513,  ..., -0.4170, -0.0894, -0.9697]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7754,  0.1095, -0.1090,  ..., -0.6133, -0.7280, -1.0352]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6396,  1.2217,  1.0967,  ..., -0.7539, -0.1964, -1.5225]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8853,  1.0264,  1.3389,  ..., -0.9502, -0.8350, -1.5879]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2588,  0.3276,  1.5742,  ...,  0.4319, -0.8545, -1.3389]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5044,  0.1322,  1.8164,  ...,  0.2354, -1.4932, -1.4043]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 170/321
Image: IDP01787-2_A.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3960, -0.4065,  1.3477,  ..., -0.7803, -1.6309, -0.3877]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1504, -0.6021,  1.5898,  ..., -0.9766, -2.2695, -0.4531]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7080, -0.2952,  0.5068,  ..., -1.4160, -1.5576, -0.7207]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.4907,  0.7490,  ..., -1.6123, -2.1953, -0.7861]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3828, -0.4663, -0.0836,  ..., -0.6523, -0.1819, -1.2041]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6289, -0.6616,  0.1587,  ..., -0.8486, -0.8203, -1.2695]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5420,  0.3101, -0.3577,  ..., -0.4165, -0.1195, -0.9551]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7871,  0.1146, -0.1154,  ..., -0.6133, -0.7583, -1.0205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6348,  1.2100,  1.0781,  ..., -0.7441, -0.2069, -1.5186]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8804,  1.0146,  1.3203,  ..., -0.9404, -0.8457, -1.5840]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2705,  0.3198,  1.5859,  ...,  0.4309, -0.8491, -1.3154]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5161,  0.1244,  1.8281,  ...,  0.2344, -1.4883, -1.3809]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 171/321
Image: xjo7-7.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3752, -0.4009,  1.3486,  ..., -0.8438, -1.5898, -0.4077]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1296, -0.5962,  1.5908,  ..., -1.0400, -2.2285, -0.4731]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6895, -0.4292,  0.6230,  ..., -1.5303, -1.5254, -0.7144]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9355, -0.6245,  0.8652,  ..., -1.7266, -2.1641, -0.7798]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3867, -0.4146, -0.0332,  ..., -0.6802, -0.1453, -1.2676]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6328, -0.6099,  0.2091,  ..., -0.8770, -0.7842, -1.3330]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5312,  0.3228, -0.3555,  ..., -0.4707, -0.1050, -0.9570]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7773,  0.1273, -0.1132,  ..., -0.6670, -0.7437, -1.0225]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6357,  1.2246,  1.0352,  ..., -0.7529, -0.1908, -1.4883]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8813,  1.0293,  1.2773,  ..., -0.9492, -0.8296, -1.5537]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2869,  0.3374,  1.5996,  ...,  0.3765, -0.8618, -1.3516]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5322,  0.1420,  1.8418,  ...,  0.1799, -1.5000, -1.4170]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 172/321
Image: stm595-3_B.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4302, -0.4128,  1.3623,  ..., -0.7490, -1.6387, -0.3848]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1846, -0.6084,  1.6045,  ..., -0.9453, -2.2773, -0.4502]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7080, -0.3010,  0.5200,  ..., -1.4492, -1.5508, -0.7524]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.4966,  0.7622,  ..., -1.6455, -2.1895, -0.8179]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4160, -0.5283,  0.0649,  ..., -0.9199, -0.2051, -1.2822]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6621, -0.7236,  0.3071,  ..., -1.1162, -0.8438, -1.3477]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4990,  0.2815, -0.3677,  ..., -0.3801, -0.0889, -0.9204]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7441,  0.0861, -0.1254,  ..., -0.5767, -0.7275, -0.9858]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5391,  1.2227,  1.0703,  ..., -0.7861, -0.1514, -1.4688]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7847,  1.0273,  1.3125,  ..., -0.9824, -0.7900, -1.5342]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2583,  0.2871,  1.5488,  ...,  0.4336, -0.8472, -1.3311]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5039,  0.0917,  1.7910,  ...,  0.2371, -1.4863, -1.3965]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 173/321
Image: DnrK_coXtal.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3955, -0.3823,  1.3555,  ..., -0.7842, -1.6631, -0.3921]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1499, -0.5776,  1.5977,  ..., -0.9805, -2.3008, -0.4575]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7139, -0.2388,  0.5190,  ..., -1.4082, -1.5547, -0.7549]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9590, -0.4341,  0.7612,  ..., -1.6045, -2.1934, -0.8203]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4736, -0.4893,  0.0696,  ..., -0.8486, -0.2529, -1.2559]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7188, -0.6846,  0.3120,  ..., -1.0449, -0.8916, -1.3213]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5410,  0.3203, -0.3901,  ..., -0.3865, -0.1121, -0.9009]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7871,  0.1249, -0.1478,  ..., -0.5830, -0.7510, -0.9663]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5547,  1.2285,  1.0264,  ..., -0.7388, -0.1641, -1.4434]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8003,  1.0332,  1.2686,  ..., -0.9355, -0.8027, -1.5088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2935,  0.2900,  1.5791,  ...,  0.4429, -0.8901, -1.3223]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5391,  0.0946,  1.8213,  ...,  0.2463, -1.5293, -1.3877]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 174/321
Image: adp-if1e2-peak1.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4258, -0.4070,  1.3633,  ..., -0.7832, -1.6377, -0.3896]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1802, -0.6025,  1.6055,  ..., -0.9795, -2.2773, -0.4551]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6543, -0.4229,  0.6104,  ..., -1.5303, -1.5957, -0.6846]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9004, -0.6182,  0.8525,  ..., -1.7266, -2.2344, -0.7500]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3545, -0.4268, -0.0894,  ..., -0.6733, -0.1726, -1.2002]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5996, -0.6221,  0.1530,  ..., -0.8701, -0.8115, -1.2656]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5117,  0.3108, -0.3718,  ..., -0.4485, -0.1060, -0.9312]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7578,  0.1154, -0.1295,  ..., -0.6450, -0.7446, -0.9966]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6235,  1.1494,  1.0801,  ..., -0.7705, -0.0900, -1.4336]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8691,  0.9541,  1.3223,  ..., -0.9668, -0.7285, -1.4990]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3325,  0.3252,  1.5723,  ...,  0.4065, -0.8911, -1.3604]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5781,  0.1298,  1.8145,  ...,  0.2100, -1.5293, -1.4258]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 175/321
Image: plt0-10.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4893, -0.4021,  1.4062,  ..., -0.7959, -1.6152, -0.3804]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2437, -0.5977,  1.6484,  ..., -0.9922, -2.2539, -0.4458]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6895, -0.3145,  0.4990,  ..., -1.4336, -1.5254, -0.7075]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9355, -0.5098,  0.7412,  ..., -1.6299, -2.1641, -0.7729]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3027, -0.5000, -0.0260,  ..., -0.6973, -0.1570, -1.1914]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5488, -0.6953,  0.2163,  ..., -0.8936, -0.7959, -1.2568]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5234,  0.3108, -0.3359,  ..., -0.4187, -0.0958, -0.9443]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7695,  0.1154, -0.0936,  ..., -0.6152, -0.7344, -1.0098]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6367,  1.2383,  1.1045,  ..., -0.7529, -0.1824, -1.5352]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8823,  1.0430,  1.3467,  ..., -0.9492, -0.8213, -1.6006]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2659,  0.3301,  1.5693,  ...,  0.4253, -0.8403, -1.3613]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5117,  0.1346,  1.8115,  ...,  0.2288, -1.4785, -1.4268]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 176/321
Image: IDP01861-3_B.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4634, -0.4019,  1.3984,  ..., -0.7705, -1.6396, -0.3921]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2178, -0.5972,  1.6406,  ..., -0.9668, -2.2773, -0.4575]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7129, -0.3142,  0.4871,  ..., -1.4629, -1.5225, -0.7061]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9590, -0.5098,  0.7295,  ..., -1.6592, -2.1602, -0.7715]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3213, -0.4614, -0.0560,  ..., -0.7231, -0.0938, -1.2334]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5664, -0.6567,  0.1863,  ..., -0.9199, -0.7324, -1.2988]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5078,  0.2979, -0.3533,  ..., -0.4182, -0.0928, -0.9546]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7539,  0.1024, -0.1110,  ..., -0.6147, -0.7314, -1.0205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6289,  1.2539,  1.0752,  ..., -0.7666, -0.1837, -1.5166]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8745,  1.0586,  1.3174,  ..., -0.9629, -0.8223, -1.5820]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2463,  0.3335,  1.5703,  ...,  0.4038, -0.8354, -1.3340]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4919,  0.1381,  1.8125,  ...,  0.2073, -1.4746, -1.3994]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 177/321
Image: dcb13_8_1_201.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.2998, -0.4644,  1.3145,  ..., -0.7612, -1.6973, -0.3354]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0542, -0.6597,  1.5566,  ..., -0.9580, -2.3359, -0.4009]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7070, -0.2639,  0.5640,  ..., -1.4766, -1.5859, -0.6831]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.4595,  0.8062,  ..., -1.6729, -2.2246, -0.7485]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3457, -0.5630, -0.0442,  ..., -0.7017, -0.2073, -1.1465]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5918, -0.7583,  0.1981,  ..., -0.8984, -0.8457, -1.2119]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5576,  0.2512, -0.3923,  ..., -0.4072, -0.1556, -0.9180]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8027,  0.0558, -0.1500,  ..., -0.6035, -0.7944, -0.9834]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6982,  1.2266,  1.0625,  ..., -0.8125, -0.1975, -1.5703]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9438,  1.0312,  1.3047,  ..., -1.0088, -0.8359, -1.6357]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3113,  0.3613,  1.5840,  ...,  0.3562, -0.8145, -1.3594]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5566,  0.1659,  1.8262,  ...,  0.1597, -1.4531, -1.4248]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 178/321
Image: 70568_1_E2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4526, -0.3896,  1.3154,  ..., -0.7622, -1.6016, -0.3569]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2070, -0.5850,  1.5576,  ..., -0.9590, -2.2402, -0.4224]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7285, -0.3040,  0.4946,  ..., -1.4111, -1.5332, -0.7163]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9746, -0.4995,  0.7368,  ..., -1.6074, -2.1719, -0.7817]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4014, -0.5342,  0.1461,  ..., -0.8760, -0.2389, -1.2139]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6465, -0.7295,  0.3884,  ..., -1.0723, -0.8774, -1.2793]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5195,  0.2866, -0.3494,  ..., -0.4009, -0.0811, -0.9243]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7656,  0.0912, -0.1071,  ..., -0.5977, -0.7197, -0.9897]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5117,  1.2109,  1.0869,  ..., -0.7651, -0.1151, -1.4531]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7573,  1.0156,  1.3291,  ..., -0.9619, -0.7539, -1.5186]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2520,  0.3027,  1.5527,  ...,  0.4429, -0.8911, -1.3770]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4976,  0.1073,  1.7949,  ...,  0.2463, -1.5293, -1.4424]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 179/321
Image: STR0003-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4419, -0.4048,  1.3662,  ..., -0.7417, -1.6201, -0.3770]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1963, -0.6001,  1.6084,  ..., -0.9385, -2.2578, -0.4424]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6719, -0.4246,  0.6123,  ..., -1.5771, -1.5684, -0.6904]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9180, -0.6201,  0.8545,  ..., -1.7734, -2.2070, -0.7559]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3232, -0.4492, -0.0923,  ..., -0.6777, -0.1313, -1.2744]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5684, -0.6445,  0.1500,  ..., -0.8740, -0.7700, -1.3398]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5059,  0.3162, -0.3621,  ..., -0.4277, -0.1064, -0.9863]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7520,  0.1207, -0.1198,  ..., -0.6240, -0.7451, -1.0518]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6514,  1.2051,  1.0713,  ..., -0.7524, -0.2118, -1.4932]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8970,  1.0098,  1.3135,  ..., -0.9492, -0.8506, -1.5586]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2727,  0.3079,  1.5762,  ...,  0.4341, -0.8423, -1.2988]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5186,  0.1124,  1.8184,  ...,  0.2375, -1.4805, -1.3643]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 180/321
Image: 34856_1_E1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4395, -0.3906,  1.2832,  ..., -0.7300, -1.6484, -0.3350]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1938, -0.5859,  1.5254,  ..., -0.9268, -2.2871, -0.4004]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7324, -0.2786,  0.5278,  ..., -1.4082, -1.6230, -0.7090]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9785, -0.4741,  0.7700,  ..., -1.6045, -2.2617, -0.7744]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3818, -0.5215,  0.0814,  ..., -0.8584, -0.2382, -1.2539]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6270, -0.7168,  0.3237,  ..., -1.0547, -0.8770, -1.3193]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4844,  0.2456, -0.3599,  ..., -0.3501, -0.1129, -0.9370]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7305,  0.0502, -0.1176,  ..., -0.5469, -0.7515, -1.0029]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5703,  1.2207,  1.0762,  ..., -0.7227, -0.1619, -1.4551]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8159,  1.0254,  1.3184,  ..., -0.9189, -0.8008, -1.5205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2861,  0.2930,  1.5684,  ...,  0.4751, -0.8965, -1.3184]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5317,  0.0975,  1.8105,  ...,  0.2786, -1.5352, -1.3838]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 181/321
Image: 169771_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4741, -0.4453,  1.3262,  ..., -0.7559, -1.6494, -0.3589]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2285, -0.6406,  1.5684,  ..., -0.9521, -2.2891, -0.4243]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7607, -0.4246,  0.6338,  ..., -1.5713, -1.5859, -0.7080]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0059, -0.6201,  0.8760,  ..., -1.7676, -2.2246, -0.7734]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3428, -0.4146, -0.0681,  ..., -0.6924, -0.1580, -1.2500]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5879, -0.6099,  0.1743,  ..., -0.8887, -0.7969, -1.3154]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5000,  0.2659, -0.3286,  ..., -0.4307, -0.0968, -0.9927]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7461,  0.0704, -0.0863,  ..., -0.6270, -0.7354, -1.0586]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6548,  1.1162,  1.1172,  ..., -0.7876, -0.1304, -1.4375]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9004,  0.9209,  1.3594,  ..., -0.9844, -0.7690, -1.5029]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3130,  0.3345,  1.5312,  ...,  0.4451, -0.8926, -1.3643]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5586,  0.1390,  1.7734,  ...,  0.2485, -1.5312, -1.4297]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 182/321
Image: 14775_2_E2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3760, -0.3921,  1.2832,  ..., -0.7559, -1.6660, -0.3574]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1304, -0.5874,  1.5254,  ..., -0.9521, -2.3047, -0.4229]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7451, -0.2649,  0.6182,  ..., -1.3789, -1.6631, -0.7241]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9902, -0.4604,  0.8604,  ..., -1.5752, -2.3008, -0.7896]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4570, -0.4390,  0.0460,  ..., -0.8516, -0.2595, -1.2354]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7031, -0.6343,  0.2883,  ..., -1.0479, -0.8984, -1.3008]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4971,  0.2651, -0.3579,  ..., -0.3955, -0.1105, -0.9106]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7422,  0.0697, -0.1156,  ..., -0.5918, -0.7490, -0.9761]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5723,  1.2266,  1.0439,  ..., -0.7402, -0.1537, -1.4756]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8179,  1.0312,  1.2861,  ..., -0.9365, -0.7925, -1.5410]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3262,  0.3203,  1.6055,  ...,  0.4639, -0.8916, -1.3408]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5718,  0.1249,  1.8477,  ...,  0.2673, -1.5303, -1.4062]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 183/321
Image: rfh0-5.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4771, -0.4189,  1.3965,  ..., -0.7920, -1.6084, -0.3867]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2314, -0.6143,  1.6387,  ..., -0.9883, -2.2461, -0.4521]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7070, -0.4536,  0.6108,  ..., -1.5605, -1.5225, -0.6812]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.6489,  0.8530,  ..., -1.7568, -2.1602, -0.7466]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3320, -0.4507, -0.0378,  ..., -0.7090, -0.1449, -1.2354]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5781, -0.6460,  0.2045,  ..., -0.9053, -0.7837, -1.3008]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5195,  0.2996, -0.3716,  ..., -0.4443, -0.0634, -0.9932]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7656,  0.1041, -0.1293,  ..., -0.6406, -0.7021, -1.0586]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6050,  1.1367,  1.1318,  ..., -0.7476, -0.1050, -1.4580]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8506,  0.9414,  1.3740,  ..., -0.9443, -0.7437, -1.5234]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2710,  0.3418,  1.5342,  ...,  0.4443, -0.8730, -1.3584]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5166,  0.1464,  1.7764,  ...,  0.2478, -1.5117, -1.4238]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 184/321
Image: 166551_1_E1_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5283, -0.3982,  1.4131,  ..., -0.7148, -1.6562, -0.3745]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2827, -0.5938,  1.6553,  ..., -0.9111, -2.2949, -0.4399]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7402, -0.3345,  0.4600,  ..., -1.4580, -1.5635, -0.6919]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9863, -0.5298,  0.7021,  ..., -1.6543, -2.2031, -0.7573]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3105, -0.6274,  0.0671,  ..., -0.9282, -0.1680, -1.2314]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5566, -0.8228,  0.3093,  ..., -1.1250, -0.8066, -1.2969]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4512,  0.2712, -0.3684,  ..., -0.3716, -0.0907, -0.9077]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6973,  0.0758, -0.1261,  ..., -0.5684, -0.7295, -0.9731]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5557,  1.2832,  1.0977,  ..., -0.7544, -0.1589, -1.4316]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8013,  1.0879,  1.3398,  ..., -0.9512, -0.7979, -1.4971]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2474,  0.2739,  1.5498,  ...,  0.4429, -0.9023, -1.3115]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4932,  0.0785,  1.7920,  ...,  0.2463, -1.5410, -1.3770]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 185/321
Image: IDP01493_MN3-B3_1a_2_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4971, -0.4624,  1.4443,  ..., -0.7793, -1.6582, -0.3794]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2515, -0.6577,  1.6865,  ..., -0.9756, -2.2969, -0.4448]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6670, -0.4407,  0.6270,  ..., -1.6270, -1.5332, -0.6494]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9121, -0.6362,  0.8691,  ..., -1.8232, -2.1719, -0.7148]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2705, -0.5000, -0.0737,  ..., -0.7407, -0.1312, -1.2275]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5156, -0.6953,  0.1686,  ..., -0.9375, -0.7700, -1.2930]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5195,  0.3037, -0.3872,  ..., -0.4331, -0.1179, -0.9585]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7656,  0.1083, -0.1449,  ..., -0.6299, -0.7568, -1.0244]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6602,  1.1543,  1.1250,  ..., -0.7729, -0.1119, -1.4658]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9058,  0.9590,  1.3672,  ..., -0.9697, -0.7505, -1.5312]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2866,  0.3115,  1.5352,  ...,  0.4185, -0.8809, -1.3369]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5322,  0.1161,  1.7773,  ...,  0.2219, -1.5195, -1.4023]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 186/321
Image: idp01828f.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3977, -0.3647,  1.3223,  ..., -0.7979, -1.5957, -0.3872]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1521, -0.5601,  1.5645,  ..., -0.9941, -2.2344, -0.4526]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7129, -0.4492,  0.5991,  ..., -1.5703, -1.4902, -0.7476]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9590, -0.6445,  0.8413,  ..., -1.7666, -2.1289, -0.8130]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3584, -0.3960, -0.0298,  ..., -0.7100, -0.1057, -1.2725]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6035, -0.5913,  0.2125,  ..., -0.9062, -0.7441, -1.3379]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5361,  0.3496, -0.3672,  ..., -0.4570, -0.0862, -0.9702]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7812,  0.1542, -0.1249,  ..., -0.6533, -0.7246, -1.0361]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6489,  1.2305,  1.0352,  ..., -0.7725, -0.1779, -1.4727]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8945,  1.0352,  1.2773,  ..., -0.9688, -0.8164, -1.5381]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2815,  0.3311,  1.5918,  ...,  0.4121, -0.8379, -1.3545]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5273,  0.1356,  1.8340,  ...,  0.2156, -1.4766, -1.4199]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 187/321
Image: X1_REM.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4343, -0.4470,  1.4229,  ..., -0.7715, -1.6621, -0.3765]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1887, -0.6426,  1.6650,  ..., -0.9678, -2.3008, -0.4419]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6748, -0.3237,  0.5186,  ..., -1.4600, -1.5664, -0.6499]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9199, -0.5190,  0.7607,  ..., -1.6562, -2.2051, -0.7153]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2627, -0.5625, -0.0575,  ..., -0.7222, -0.2021, -1.2100]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5078, -0.7578,  0.1848,  ..., -0.9189, -0.8408, -1.2754]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5352,  0.2690, -0.3796,  ..., -0.4368, -0.0977, -0.9141]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7812,  0.0736, -0.1373,  ..., -0.6333, -0.7363, -0.9795]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.7061,  1.2627,  1.0537,  ..., -0.7812, -0.2061, -1.5527]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9517,  1.0674,  1.2959,  ..., -0.9775, -0.8447, -1.6182]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2847,  0.2969,  1.5840,  ...,  0.3796, -0.8359, -1.3213]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5303,  0.1014,  1.8262,  ...,  0.1831, -1.4746, -1.3867]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 188/321
Image: rjo4-3.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4438, -0.3892,  1.3115,  ..., -0.7578, -1.6338, -0.3706]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1982, -0.5845,  1.5537,  ..., -0.9541, -2.2734, -0.4360]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7021, -0.3872,  0.6040,  ..., -1.5791, -1.6260, -0.7466]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9473, -0.5825,  0.8462,  ..., -1.7754, -2.2656, -0.8120]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4268, -0.4834,  0.0640,  ..., -0.8838, -0.2053, -1.3213]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6719, -0.6787,  0.3064,  ..., -1.0801, -0.8438, -1.3867]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4883,  0.3164, -0.4102,  ..., -0.3989, -0.0579, -0.9531]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7344,  0.1210, -0.1678,  ..., -0.5957, -0.6963, -1.0186]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5464,  1.2275,  1.0244,  ..., -0.7510, -0.1713, -1.4326]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7920,  1.0322,  1.2666,  ..., -0.9473, -0.8101, -1.4980]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2566,  0.2900,  1.5312,  ...,  0.4644, -0.8496, -1.2949]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5020,  0.0946,  1.7734,  ...,  0.2678, -1.4883, -1.3604]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 189/321
Image: 144187_1_E1_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4216, -0.3711,  1.2627,  ..., -0.7998, -1.5859, -0.3750]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1760, -0.5664,  1.5049,  ..., -0.9961, -2.2246, -0.4404]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7480, -0.2747,  0.5166,  ..., -1.3701, -1.5664, -0.7773]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9941, -0.4702,  0.7588,  ..., -1.5664, -2.2051, -0.8428]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4668, -0.4600,  0.1440,  ..., -0.8691, -0.2393, -1.2646]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7129, -0.6553,  0.3862,  ..., -1.0654, -0.8779, -1.3301]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5303,  0.3059, -0.3643,  ..., -0.4004, -0.0833, -0.9453]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7754,  0.1105, -0.1219,  ..., -0.5967, -0.7217, -1.0107]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5571,  1.2480,  1.0420,  ..., -0.7510, -0.1373, -1.4570]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8027,  1.0527,  1.2842,  ..., -0.9473, -0.7759, -1.5225]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2751,  0.3057,  1.5645,  ...,  0.4497, -0.8843, -1.3584]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5205,  0.1102,  1.8066,  ...,  0.2532, -1.5234, -1.4238]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 190/321
Image: if7g-peak2.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4517, -0.4185,  1.4668,  ..., -0.7354, -1.7090, -0.3813]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2061, -0.6138,  1.7090,  ..., -0.9316, -2.3477, -0.4468]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6934, -0.2800,  0.5293,  ..., -1.4922, -1.5020, -0.6460]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9395, -0.4756,  0.7715,  ..., -1.6885, -2.1406, -0.7114]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3281, -0.6567,  0.0450,  ..., -0.9209, -0.2249, -1.2070]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5742, -0.8521,  0.2874,  ..., -1.1172, -0.8633, -1.2725]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5059,  0.2788, -0.3818,  ..., -0.3931, -0.1440, -0.8745]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7520,  0.0834, -0.1395,  ..., -0.5898, -0.7827, -0.9399]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5352,  1.2568,  1.0732,  ..., -0.8086, -0.1593, -1.4766]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7808,  1.0615,  1.3154,  ..., -1.0049, -0.7979, -1.5420]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2891,  0.2795,  1.5332,  ...,  0.4009, -0.8828, -1.3281]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5347,  0.0841,  1.7754,  ...,  0.2043, -1.5215, -1.3936]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 191/321
Image: ztg0-3_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4155, -0.4028,  1.3438,  ..., -0.7886, -1.6338, -0.3770]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1699, -0.5981,  1.5859,  ..., -0.9854, -2.2734, -0.4424]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7500, -0.2761,  0.5049,  ..., -1.3984, -1.5664, -0.7686]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9961, -0.4717,  0.7471,  ..., -1.5947, -2.2051, -0.8340]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4189, -0.5283,  0.1471,  ..., -0.9106, -0.2078, -1.2803]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6641, -0.7236,  0.3894,  ..., -1.1074, -0.8467, -1.3457]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5234,  0.2720, -0.3362,  ..., -0.4014, -0.0879, -0.9443]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7695,  0.0765, -0.0939,  ..., -0.5977, -0.7266, -1.0098]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5439,  1.2207,  1.0879,  ..., -0.7773, -0.1183, -1.4541]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7896,  1.0254,  1.3301,  ..., -0.9736, -0.7568, -1.5195]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2271,  0.3223,  1.5488,  ...,  0.4370, -0.8413, -1.3535]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4727,  0.1268,  1.7910,  ...,  0.2405, -1.4805, -1.4189]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 192/321
Image: IUT-8-5_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4526, -0.4507,  1.2803,  ..., -0.7393, -1.6885, -0.3608]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2070, -0.6460,  1.5225,  ..., -0.9355, -2.3281, -0.4263]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6953, -0.2688,  0.4426,  ..., -1.4561, -1.5635, -0.7349]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.4644,  0.6851,  ..., -1.6523, -2.2031, -0.8003]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3955, -0.5996,  0.1208,  ..., -0.9082, -0.3137, -1.1602]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6406, -0.7949,  0.3630,  ..., -1.1045, -0.9521, -1.2256]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4932,  0.2419, -0.3574,  ..., -0.3611, -0.1420, -0.8921]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7383,  0.0465, -0.1151,  ..., -0.5576, -0.7808, -0.9575]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5215,  1.2100,  1.0596,  ..., -0.7832, -0.1398, -1.4902]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7671,  1.0146,  1.3018,  ..., -0.9795, -0.7783, -1.5557]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2549,  0.3164,  1.5322,  ...,  0.4419, -0.8828, -1.3770]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5005,  0.1210,  1.7744,  ...,  0.2454, -1.5215, -1.4424]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 193/321
Image: IMPC91INDF5gly.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5640, -0.3589,  1.5059,  ..., -0.7202, -1.6338, -0.3823]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.3184, -0.5542,  1.7480,  ..., -0.9170, -2.2734, -0.4478]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6758, -0.4382,  0.6035,  ..., -1.6289, -1.5039, -0.6587]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9219, -0.6338,  0.8457,  ..., -1.8252, -2.1426, -0.7241]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2412, -0.6182,  0.1187,  ..., -0.9131, -0.1249, -1.2227]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4863, -0.8135,  0.3608,  ..., -1.1094, -0.7637, -1.2881]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.3955,  0.3110, -0.3425,  ..., -0.4319, -0.0854, -0.9136]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6406,  0.1156, -0.1002,  ..., -0.6284, -0.7241, -0.9790]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4897,  1.2461,  1.1045,  ..., -0.8062, -0.1082, -1.3887]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7354,  1.0508,  1.3467,  ..., -1.0029, -0.7471, -1.4541]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2544,  0.2852,  1.5449,  ...,  0.4277, -0.8721, -1.3262]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5000,  0.0897,  1.7871,  ...,  0.2312, -1.5107, -1.3916]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 194/321
Image: O8K746-13_7_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4036, -0.4006,  1.2949,  ..., -0.7720, -1.6260, -0.3750]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1580, -0.5962,  1.5371,  ..., -0.9688, -2.2656, -0.4404]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6992, -0.3040,  0.5376,  ..., -1.3486, -1.6035, -0.7554]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9453, -0.4995,  0.7798,  ..., -1.5449, -2.2422, -0.8208]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4414, -0.5342,  0.1311,  ..., -0.8657, -0.3142, -1.2285]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6875, -0.7295,  0.3735,  ..., -1.0625, -0.9531, -1.2939]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5293,  0.2800, -0.3577,  ..., -0.4106, -0.0931, -0.9180]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7754,  0.0846, -0.1154,  ..., -0.6074, -0.7319, -0.9834]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5625,  1.2227,  1.0381,  ..., -0.7510, -0.1693, -1.4785]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8081,  1.0273,  1.2803,  ..., -0.9473, -0.8081, -1.5439]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2876,  0.3013,  1.5605,  ...,  0.4482, -0.8877, -1.3652]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5332,  0.1058,  1.8027,  ...,  0.2517, -1.5264, -1.4307]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 195/321
Image: 111979_1_E1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4470, -0.3906,  1.3447,  ..., -0.7559, -1.6250, -0.3750]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2014, -0.5859,  1.5869,  ..., -0.9521, -2.2637, -0.4404]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7188, -0.3032,  0.4963,  ..., -1.4326, -1.5479, -0.7251]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9648, -0.4985,  0.7388,  ..., -1.6289, -2.1875, -0.7905]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4160, -0.5361,  0.1343,  ..., -0.9121, -0.2305, -1.2314]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6621, -0.7314,  0.3765,  ..., -1.1084, -0.8691, -1.2969]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5332,  0.2957, -0.3721,  ..., -0.4141, -0.0842, -0.9248]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7793,  0.1002, -0.1298,  ..., -0.6104, -0.7227, -0.9902]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5693,  1.2578,  1.0430,  ..., -0.7461, -0.1439, -1.4512]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8149,  1.0625,  1.2852,  ..., -0.9424, -0.7827, -1.5166]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2493,  0.2874,  1.5469,  ...,  0.4333, -0.8823, -1.3564]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4949,  0.0919,  1.7891,  ...,  0.2368, -1.5215, -1.4219]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 196/321
Image: 30918_2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4795, -0.3979,  1.3242,  ..., -0.7446, -1.6074, -0.3530]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2339, -0.5933,  1.5664,  ..., -0.9414, -2.2461, -0.4185]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7109, -0.4519,  0.5918,  ..., -1.5332, -1.5625, -0.7119]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9570, -0.6475,  0.8340,  ..., -1.7295, -2.2012, -0.7773]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3506, -0.4009, -0.0400,  ..., -0.6865, -0.1467, -1.2363]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5957, -0.5962,  0.2023,  ..., -0.8828, -0.7852, -1.3018]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4883,  0.3015, -0.3447,  ..., -0.4370, -0.0908, -0.9956]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7344,  0.1061, -0.1024,  ..., -0.6338, -0.7295, -1.0615]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6318,  1.2012,  1.0723,  ..., -0.7412, -0.1912, -1.4863]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8774,  1.0059,  1.3145,  ..., -0.9375, -0.8301, -1.5518]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2578,  0.3364,  1.5723,  ...,  0.4485, -0.8867, -1.3457]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5034,  0.1410,  1.8145,  ...,  0.2520, -1.5254, -1.4111]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 197/321
Image: cps041-6_5_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4932, -0.4219,  1.4473,  ..., -0.6821, -1.6738, -0.3398]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2476, -0.6172,  1.6895,  ..., -0.8789, -2.3125, -0.4053]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7295, -0.2693,  0.3989,  ..., -1.5352, -1.4990, -0.6904]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9746, -0.4648,  0.6411,  ..., -1.7314, -2.1367, -0.7559]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2549, -0.6831,  0.2004,  ..., -0.9854, -0.2729, -1.2227]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5000, -0.8784,  0.4429,  ..., -1.1816, -0.9116, -1.2881]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4434,  0.2676, -0.3086,  ..., -0.3779, -0.1989, -0.9014]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6895,  0.0721, -0.0663,  ..., -0.5742, -0.8374, -0.9668]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5234,  1.2354,  1.1299,  ..., -0.8242, -0.2161, -1.4795]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7690,  1.0400,  1.3721,  ..., -1.0205, -0.8545, -1.5449]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2150,  0.3267,  1.5293,  ...,  0.4502, -0.8809, -1.3301]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4604,  0.1312,  1.7715,  ...,  0.2537, -1.5195, -1.3955]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 198/321
Image: idp00511b-lr.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4360, -0.4268,  1.4209,  ..., -0.7900, -1.6475, -0.3604]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1904, -0.6221,  1.6631,  ..., -0.9863, -2.2852, -0.4258]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7002, -0.4858,  0.5479,  ..., -1.5898, -1.5654, -0.6694]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9453, -0.6812,  0.7900,  ..., -1.7861, -2.2031, -0.7349]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2607, -0.4702, -0.0797,  ..., -0.7144, -0.1523, -1.2227]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5059, -0.6655,  0.1626,  ..., -0.9111, -0.7910, -1.2881]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5049,  0.2729, -0.3542,  ..., -0.4399, -0.0784, -0.9458]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7500,  0.0775, -0.1119,  ..., -0.6367, -0.7168, -1.0117]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6523,  1.2129,  1.0674,  ..., -0.7686, -0.2122, -1.5293]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8979,  1.0176,  1.3096,  ..., -0.9648, -0.8506, -1.5947]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2744,  0.3455,  1.5527,  ...,  0.4319, -0.8159, -1.3477]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5200,  0.1500,  1.7949,  ...,  0.2354, -1.4551, -1.4131]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 199/321
Image: 34325_1_E1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3945, -0.3647,  1.2656,  ..., -0.7812, -1.5879, -0.3853]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1489, -0.5601,  1.5078,  ..., -0.9775, -2.2266, -0.4507]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7197, -0.4199,  0.6436,  ..., -1.4990, -1.5381, -0.7246]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9648, -0.6152,  0.8857,  ..., -1.6953, -2.1758, -0.7900]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4102, -0.3267, -0.0675,  ..., -0.6592, -0.1292, -1.2432]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6562, -0.5220,  0.1748,  ..., -0.8555, -0.7676, -1.3086]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5137,  0.3342, -0.3103,  ..., -0.4746, -0.0947, -1.0312]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.1388, -0.0680,  ..., -0.6709, -0.7334, -1.0967]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6387,  1.2012,  1.0537,  ..., -0.7559, -0.1672, -1.4639]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8843,  1.0059,  1.2959,  ..., -0.9521, -0.8057, -1.5293]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2554,  0.3525,  1.5996,  ...,  0.4424, -0.8555, -1.3740]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5010,  0.1571,  1.8418,  ...,  0.2458, -1.4941, -1.4395]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 200/321
Image: wqa0-1_S.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4097, -0.3833,  1.3574,  ..., -0.7881, -1.6084, -0.3975]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1641, -0.5786,  1.5996,  ..., -0.9844, -2.2461, -0.4629]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7227, -0.2825,  0.5371,  ..., -1.3857, -1.5586, -0.7300]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9688, -0.4780,  0.7793,  ..., -1.5820, -2.1973, -0.7954]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3701, -0.4688, -0.0528,  ..., -0.6660, -0.1548, -1.2246]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6152, -0.6641,  0.1895,  ..., -0.8623, -0.7935, -1.2900]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5381,  0.3076, -0.3767,  ..., -0.4214, -0.0891, -0.9448]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.1122, -0.1344,  ..., -0.6182, -0.7275, -1.0107]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6543,  1.2236,  1.0801,  ..., -0.7520, -0.2020, -1.5078]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8999,  1.0283,  1.3223,  ..., -0.9482, -0.8408, -1.5732]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2922,  0.3237,  1.6035,  ...,  0.4192, -0.8501, -1.3242]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5381,  0.1283,  1.8457,  ...,  0.2227, -1.4883, -1.3896]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 201/321
Image: 255936g5_x_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4070, -0.4160,  1.3369,  ..., -0.7754, -1.6025, -0.3809]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1614, -0.6113,  1.5791,  ..., -0.9717, -2.2422, -0.4463]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7559, -0.4319,  0.6235,  ..., -1.5332, -1.5195, -0.6909]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0020, -0.6274,  0.8657,  ..., -1.7295, -2.1582, -0.7563]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3760, -0.4570, -0.0197,  ..., -0.7153, -0.2057, -1.1846]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6211, -0.6523,  0.2227,  ..., -0.9121, -0.8442, -1.2500]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5566,  0.2944, -0.3953,  ..., -0.4819, -0.0846, -0.9658]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8027,  0.0990, -0.1530,  ..., -0.6787, -0.7231, -1.0312]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6548,  1.1172,  1.1299,  ..., -0.7754, -0.0833, -1.4551]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9004,  0.9219,  1.3721,  ..., -0.9717, -0.7217, -1.5205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2976,  0.3467,  1.5615,  ...,  0.4053, -0.9155, -1.4014]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5430,  0.1512,  1.8037,  ...,  0.2087, -1.5547, -1.4668]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 202/321
Image: 204641a10_05-10MKI_x0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3721, -0.4031,  1.2617,  ..., -0.7686, -1.6582, -0.3398]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1265, -0.5986,  1.5039,  ..., -0.9648, -2.2969, -0.4053]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7773, -0.2583,  0.5977,  ..., -1.3369, -1.6143, -0.6909]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0234, -0.4536,  0.8398,  ..., -1.5332, -2.2539, -0.7563]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4727, -0.4609,  0.0624,  ..., -0.8564, -0.2656, -1.2051]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7188, -0.6562,  0.3047,  ..., -1.0527, -0.9043, -1.2705]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5166,  0.2900, -0.3562,  ..., -0.4116, -0.1035, -0.9136]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.0946, -0.1139,  ..., -0.6084, -0.7422, -0.9790]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4951,  1.1855,  1.0703,  ..., -0.7539, -0.1512, -1.4766]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7407,  0.9902,  1.3125,  ..., -0.9502, -0.7900, -1.5420]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2913,  0.3257,  1.5762,  ...,  0.4673, -0.8892, -1.3770]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5371,  0.1302,  1.8184,  ...,  0.2708, -1.5273, -1.4424]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 203/321
Image: CAA0080_NADH_low2.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4282, -0.4609,  1.4805,  ..., -0.7563, -1.7168, -0.3760]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1826, -0.6562,  1.7227,  ..., -0.9531, -2.3555, -0.4414]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6826, -0.4592,  0.6611,  ..., -1.6699, -1.6270, -0.6157]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9277, -0.6548,  0.9033,  ..., -1.8662, -2.2656, -0.6812]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2363, -0.5786, -0.1046,  ..., -0.7588, -0.1646, -1.2256]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4824, -0.7739,  0.1377,  ..., -0.9551, -0.8032, -1.2910]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5000,  0.2500, -0.4001,  ..., -0.4438, -0.1227, -0.9351]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7461,  0.0546, -0.1578,  ..., -0.6406, -0.7612, -1.0010]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6768,  1.1426,  1.1123,  ..., -0.8389, -0.1348, -1.4668]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9224,  0.9473,  1.3545,  ..., -1.0352, -0.7734, -1.5322]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3184,  0.3052,  1.5547,  ...,  0.3855, -0.8613, -1.2959]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5640,  0.1097,  1.7969,  ...,  0.1890, -1.5000, -1.3613]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 204/321
Image: idp00067-3.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4292, -0.3799,  1.4658,  ..., -0.7427, -1.6875, -0.3867]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1836, -0.5752,  1.7080,  ..., -0.9395, -2.3262, -0.4521]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6602, -0.2776,  0.5166,  ..., -1.4707, -1.5479, -0.7124]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9062, -0.4731,  0.7588,  ..., -1.6670, -2.1875, -0.7778]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3516, -0.6108,  0.0704,  ..., -0.9277, -0.2166, -1.2627]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5977, -0.8062,  0.3127,  ..., -1.1240, -0.8555, -1.3281]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4941,  0.2886, -0.3691,  ..., -0.3794, -0.1390, -0.8896]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7402,  0.0931, -0.1268,  ..., -0.5762, -0.7778, -0.9551]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5557,  1.2393,  1.0615,  ..., -0.7891, -0.1656, -1.4629]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8013,  1.0439,  1.3037,  ..., -0.9854, -0.8042, -1.5283]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2695,  0.2861,  1.5332,  ...,  0.4387, -0.8560, -1.3086]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5151,  0.0907,  1.7754,  ...,  0.2422, -1.4941, -1.3740]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 205/321
Image: 41998_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3984, -0.3862,  1.2363,  ..., -0.7603, -1.6172, -0.3457]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1528, -0.5815,  1.4785,  ..., -0.9570, -2.2559, -0.4111]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7695, -0.2878,  0.5400,  ..., -1.3867, -1.6260, -0.7808]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0156, -0.4834,  0.7822,  ..., -1.5830, -2.2656, -0.8462]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4648, -0.4565,  0.0809,  ..., -0.8740, -0.2365, -1.2822]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7109, -0.6519,  0.3232,  ..., -1.0703, -0.8750, -1.3477]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5137,  0.2847, -0.3784,  ..., -0.3582, -0.1271, -0.9844]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.0892, -0.1361,  ..., -0.5547, -0.7656, -1.0498]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5449,  1.2285,  1.0703,  ..., -0.7275, -0.1583, -1.4443]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7905,  1.0332,  1.3125,  ..., -0.9238, -0.7969, -1.5098]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2708,  0.3452,  1.5488,  ...,  0.4883, -0.8926, -1.3291]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5166,  0.1498,  1.7910,  ...,  0.2917, -1.5312, -1.3945]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 206/321
Image: IDP02729-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4624, -0.3777,  1.3330,  ..., -0.7847, -1.6006, -0.3887]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2168, -0.5732,  1.5752,  ..., -0.9814, -2.2383, -0.4541]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7373, -0.3215,  0.4998,  ..., -1.3877, -1.5225, -0.7358]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9824, -0.5171,  0.7422,  ..., -1.5840, -2.1602, -0.8013]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4092, -0.5166,  0.1163,  ..., -0.9082, -0.1749, -1.2764]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6543, -0.7119,  0.3586,  ..., -1.1045, -0.8135, -1.3418]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5098,  0.3145, -0.3711,  ..., -0.4194, -0.0763, -0.9478]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7559,  0.1190, -0.1288,  ..., -0.6162, -0.7148, -1.0137]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5332,  1.2500,  1.0352,  ..., -0.7480, -0.1538, -1.4434]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7788,  1.0547,  1.2773,  ..., -0.9443, -0.7925, -1.5088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2170,  0.2939,  1.5137,  ...,  0.4292, -0.8579, -1.3516]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4626,  0.0985,  1.7559,  ...,  0.2327, -1.4961, -1.4170]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 207/321
Image: sta103b.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4062, -0.3823,  1.4199,  ..., -0.7119, -1.6797, -0.3540]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1606, -0.5776,  1.6621,  ..., -0.9082, -2.3184, -0.4194]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6963, -0.2271,  0.5425,  ..., -1.5205, -1.6035, -0.7334]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.4224,  0.7847,  ..., -1.7168, -2.2422, -0.7988]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3350, -0.5747,  0.0850,  ..., -0.9653, -0.2122, -1.1758]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5801, -0.7700,  0.3274,  ..., -1.1621, -0.8506, -1.2412]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4785,  0.2964, -0.3860,  ..., -0.3604, -0.1449, -0.8833]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7246,  0.1010, -0.1437,  ..., -0.5566, -0.7837, -0.9487]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5327,  1.2480,  1.0391,  ..., -0.7871, -0.1340, -1.4395]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7783,  1.0527,  1.2812,  ..., -0.9834, -0.7725, -1.5049]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2966,  0.3154,  1.5137,  ...,  0.4536, -0.8403, -1.2734]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5420,  0.1200,  1.7559,  ...,  0.2571, -1.4785, -1.3389]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 208/321
Image: IDP01304_3hho.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4089, -0.4175,  1.3867,  ..., -0.7715, -1.6445, -0.3799]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1633, -0.6128,  1.6289,  ..., -0.9678, -2.2832, -0.4453]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6768, -0.4343,  0.6084,  ..., -1.5898, -1.5625, -0.6670]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9219, -0.6299,  0.8506,  ..., -1.7861, -2.2012, -0.7324]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3340, -0.4351, -0.0697,  ..., -0.6353, -0.1710, -1.2021]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5801, -0.6304,  0.1726,  ..., -0.8320, -0.8096, -1.2676]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5107,  0.3096, -0.3115,  ..., -0.4316, -0.1061, -0.9424]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7559,  0.1141, -0.0692,  ..., -0.6279, -0.7446, -1.0078]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6289,  1.1973,  1.0508,  ..., -0.8223, -0.1423, -1.5049]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8745,  1.0020,  1.2930,  ..., -1.0186, -0.7812, -1.5703]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3096,  0.3208,  1.5840,  ...,  0.4106, -0.8501, -1.3711]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5552,  0.1254,  1.8262,  ...,  0.2141, -1.4883, -1.4365]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 209/321
Image: Cterm-Rcsb-aa.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4033, -0.4209,  1.3584,  ..., -0.7554, -1.6543, -0.3687]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1577, -0.6162,  1.6006,  ..., -0.9521, -2.2930, -0.4341]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7012, -0.2856,  0.5728,  ..., -1.4121, -1.5625, -0.7026]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9473, -0.4810,  0.8149,  ..., -1.6084, -2.2012, -0.7681]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3555, -0.4956, -0.0690,  ..., -0.6592, -0.1826, -1.1982]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6016, -0.6909,  0.1733,  ..., -0.8555, -0.8213, -1.2637]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5488,  0.2915, -0.3599,  ..., -0.4263, -0.1202, -0.9336]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7949,  0.0961, -0.1176,  ..., -0.6230, -0.7588, -0.9990]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6699,  1.2148,  1.0723,  ..., -0.7563, -0.2122, -1.5225]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9155,  1.0195,  1.3145,  ..., -0.9531, -0.8506, -1.5879]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2932,  0.2993,  1.6025,  ...,  0.4150, -0.8623, -1.3301]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5391,  0.1039,  1.8447,  ...,  0.2185, -1.5010, -1.3955]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 210/321
Image: idp91169g.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4805, -0.4148,  1.3633,  ..., -0.7754, -1.6387, -0.3755]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2349, -0.6104,  1.6055,  ..., -0.9717, -2.2773, -0.4409]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6797, -0.4558,  0.6426,  ..., -1.5674, -1.5840, -0.7310]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9258, -0.6514,  0.8848,  ..., -1.7637, -2.2227, -0.7964]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3096, -0.4199, -0.0047,  ..., -0.6948, -0.1477, -1.2236]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5547, -0.6152,  0.2375,  ..., -0.8916, -0.7861, -1.2891]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4883,  0.2888, -0.3442,  ..., -0.4434, -0.0789, -0.9722]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7344,  0.0934, -0.1019,  ..., -0.6396, -0.7178, -1.0381]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6406,  1.2031,  1.0625,  ..., -0.7490, -0.2018, -1.5068]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8862,  1.0078,  1.3047,  ..., -0.9453, -0.8403, -1.5723]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2742,  0.3237,  1.5742,  ...,  0.4263, -0.8438, -1.3643]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5195,  0.1283,  1.8164,  ...,  0.2297, -1.4824, -1.4297]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 211/321
Image: rgo9-7.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3745, -0.4180,  1.3262,  ..., -0.7808, -1.6270, -0.3618]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1289, -0.6133,  1.5684,  ..., -0.9775, -2.2656, -0.4272]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7480, -0.2698,  0.5571,  ..., -1.4082, -1.5576, -0.7075]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9941, -0.4653,  0.7993,  ..., -1.6045, -2.1953, -0.7729]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4355, -0.4521, -0.1008,  ..., -0.6348, -0.1467, -1.2139]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6816, -0.6475,  0.1415,  ..., -0.8311, -0.7852, -1.2793]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5518,  0.2966, -0.3901,  ..., -0.4292, -0.0767, -0.9243]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7969,  0.1012, -0.1478,  ..., -0.6260, -0.7153, -0.9897]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6685,  1.2002,  1.0469,  ..., -0.7510, -0.1909, -1.5020]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9141,  1.0049,  1.2891,  ..., -0.9473, -0.8296, -1.5674]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2986,  0.3220,  1.6074,  ...,  0.4187, -0.8516, -1.3027]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5439,  0.1266,  1.8496,  ...,  0.2222, -1.4902, -1.3682]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 212/321
Image: sbq8-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3960, -0.3838,  1.4121,  ..., -0.8076, -1.6113, -0.3999]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1504, -0.5791,  1.6543,  ..., -1.0039, -2.2500, -0.4653]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6982, -0.4326,  0.5967,  ..., -1.5820, -1.5059, -0.7197]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9434, -0.6279,  0.8389,  ..., -1.7783, -2.1445, -0.7852]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4043, -0.5269,  0.1423,  ..., -0.9395, -0.2089, -1.2871]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6504, -0.7222,  0.3848,  ..., -1.1357, -0.8477, -1.3525]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5215,  0.3223, -0.3889,  ..., -0.4678, -0.0642, -0.9336]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7676,  0.1268, -0.1466,  ..., -0.6641, -0.7031, -0.9990]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5576,  1.2256,  1.0137,  ..., -0.7705, -0.1614, -1.4375]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8032,  1.0303,  1.2559,  ..., -0.9668, -0.7998, -1.5029]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2627,  0.2983,  1.5381,  ...,  0.3999, -0.8574, -1.3711]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5083,  0.1029,  1.7803,  ...,  0.2034, -1.4961, -1.4365]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 213/321
Image: IDP01787-2_2_B.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4307, -0.3972,  1.3369,  ..., -0.7578, -1.6465, -0.3623]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1851, -0.5928,  1.5791,  ..., -0.9541, -2.2852, -0.4277]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7031, -0.2607,  0.5029,  ..., -1.4434, -1.5527, -0.7251]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9492, -0.4561,  0.7451,  ..., -1.6396, -2.1914, -0.7905]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4346, -0.5405,  0.0599,  ..., -0.8950, -0.2576, -1.2598]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6797, -0.7358,  0.3022,  ..., -1.0918, -0.8965, -1.3252]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5381,  0.3164, -0.3894,  ..., -0.3865, -0.1387, -0.9341]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.1210, -0.1471,  ..., -0.5830, -0.7773, -0.9995]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5449,  1.2266,  1.0312,  ..., -0.7256, -0.1836, -1.4561]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7905,  1.0312,  1.2734,  ..., -0.9219, -0.8223, -1.5215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2671,  0.2812,  1.5215,  ...,  0.4580, -0.8716, -1.3018]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5127,  0.0858,  1.7637,  ...,  0.2615, -1.5098, -1.3672]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 214/321
Image: ozx5-5_y.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4619, -0.3972,  1.4697,  ..., -0.7749, -1.6611, -0.3809]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2163, -0.5928,  1.7119,  ..., -0.9717, -2.3008, -0.4463]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6611, -0.4565,  0.5693,  ..., -1.6318, -1.5381, -0.6885]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9062, -0.6519,  0.8115,  ..., -1.8281, -2.1758, -0.7539]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3242, -0.5884,  0.1301,  ..., -0.9629, -0.2162, -1.2793]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5703, -0.7837,  0.3726,  ..., -1.1592, -0.8550, -1.3447]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4766,  0.3218, -0.3657,  ..., -0.4697, -0.1202, -0.9395]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7227,  0.1263, -0.1234,  ..., -0.6660, -0.7588, -1.0049]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5405,  1.2480,  1.0322,  ..., -0.7900, -0.1836, -1.4395]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7861,  1.0527,  1.2744,  ..., -0.9863, -0.8223, -1.5049]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2397,  0.3064,  1.5117,  ...,  0.3975, -0.8574, -1.3516]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4854,  0.1110,  1.7539,  ...,  0.2009, -1.4961, -1.4170]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 215/321
Image: 100731_1_H6_peak.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5791, -0.4170,  1.4980,  ..., -0.7373, -1.6543, -0.3794]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.3335, -0.6123,  1.7402,  ..., -0.9336, -2.2930, -0.4448]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6006, -0.5220,  0.5801,  ..., -1.6582, -1.5537, -0.6333]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8457, -0.7173,  0.8223,  ..., -1.8545, -2.1914, -0.6987]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2500, -0.6475,  0.0952,  ..., -0.9243, -0.1943, -1.2061]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4961, -0.8428,  0.3374,  ..., -1.1211, -0.8330, -1.2715]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4199,  0.2998, -0.3457,  ..., -0.4375, -0.1334, -0.9277]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6660,  0.1044, -0.1034,  ..., -0.6338, -0.7720, -0.9932]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5171,  1.2734,  1.0273,  ..., -0.7417, -0.1975, -1.4219]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7627,  1.0781,  1.2695,  ..., -0.9385, -0.8359, -1.4873]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2271,  0.2910,  1.5156,  ...,  0.4482, -0.8794, -1.3320]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4727,  0.0956,  1.7578,  ...,  0.2517, -1.5176, -1.3975]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 216/321
Image: p106-6.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4399, -0.4067,  1.3955,  ..., -0.7593, -1.6377, -0.3750]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1943, -0.6021,  1.6377,  ..., -0.9561, -2.2773, -0.4404]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6992, -0.4258,  0.6162,  ..., -1.5566, -1.5811, -0.6953]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9453, -0.6211,  0.8584,  ..., -1.7529, -2.2188, -0.7607]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3477, -0.3960, -0.0755,  ..., -0.6724, -0.1460, -1.2529]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5938, -0.5913,  0.1667,  ..., -0.8691, -0.7847, -1.3184]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5029,  0.3137, -0.3367,  ..., -0.4395, -0.0942, -0.9604]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7480,  0.1183, -0.0944,  ..., -0.6357, -0.7329, -1.0264]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6445,  1.2207,  1.0703,  ..., -0.7715, -0.1953, -1.4961]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8901,  1.0254,  1.3125,  ..., -0.9678, -0.8340, -1.5615]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2852,  0.3457,  1.5684,  ...,  0.4282, -0.8530, -1.3613]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5308,  0.1503,  1.8105,  ...,  0.2317, -1.4922, -1.4268]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 217/321
Image: yts5_-10.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3855, -0.3931,  1.3389,  ..., -0.8042, -1.6211, -0.3921]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1399, -0.5884,  1.5811,  ..., -1.0010, -2.2598, -0.4575]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7051, -0.4033,  0.6543,  ..., -1.5547, -1.5693, -0.6968]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9512, -0.5986,  0.8965,  ..., -1.7510, -2.2070, -0.7622]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4268, -0.4077, -0.0761,  ..., -0.6616, -0.1434, -1.2764]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6719, -0.6030,  0.1663,  ..., -0.8584, -0.7822, -1.3418]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5381,  0.3137, -0.3901,  ..., -0.4595, -0.0767, -0.9600]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.1183, -0.1478,  ..., -0.6562, -0.7153, -1.0254]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6548,  1.2188,  1.0107,  ..., -0.7402, -0.1855, -1.4844]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9004,  1.0234,  1.2529,  ..., -0.9365, -0.8242, -1.5498]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2869,  0.3232,  1.6045,  ...,  0.4004, -0.8428, -1.3223]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5322,  0.1278,  1.8467,  ...,  0.2039, -1.4814, -1.3877]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 218/321
Image: T6ODM_AKG_A6_1_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4087, -0.4109,  1.3740,  ..., -0.7485, -1.6465, -0.3491]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1631, -0.6064,  1.6162,  ..., -0.9453, -2.2852, -0.4146]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7314, -0.3979,  0.6016,  ..., -1.5557, -1.6084, -0.6538]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9766, -0.5933,  0.8438,  ..., -1.7520, -2.2461, -0.7192]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3906, -0.5776,  0.0724,  ..., -0.8955, -0.2522, -1.3027]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6367, -0.7729,  0.3147,  ..., -1.0918, -0.8906, -1.3682]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5371,  0.3245, -0.4165,  ..., -0.4321, -0.0972, -0.9243]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.1290, -0.1742,  ..., -0.6289, -0.7358, -0.9897]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5127,  1.3613,  0.9287,  ..., -0.6055, -0.3113, -1.2910]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7583,  1.1660,  1.1709,  ..., -0.8018, -0.9502, -1.3564]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3647,  0.3091,  1.4922,  ...,  0.4380, -0.9409, -1.2793]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.6104,  0.1136,  1.7344,  ...,  0.2415, -1.5801, -1.3447]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 219/321
Image: lft6-5.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3708, -0.3984,  1.4375,  ..., -0.7407, -1.6670, -0.3711]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1252, -0.5938,  1.6797,  ..., -0.9375, -2.3047, -0.4365]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6855, -0.3916,  0.6328,  ..., -1.6094, -1.5576, -0.6968]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9316, -0.5869,  0.8750,  ..., -1.8057, -2.1953, -0.7622]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4033, -0.5508,  0.0292,  ..., -0.9653, -0.1945, -1.3057]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6484, -0.7461,  0.2715,  ..., -1.1621, -0.8330, -1.3711]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4883,  0.2839, -0.4263,  ..., -0.4473, -0.0677, -0.9312]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7344,  0.0885, -0.1840,  ..., -0.6436, -0.7065, -0.9966]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5532,  1.1924,  1.0371,  ..., -0.7910, -0.1780, -1.4238]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7988,  0.9971,  1.2793,  ..., -0.9873, -0.8164, -1.4893]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2590,  0.2852,  1.5527,  ...,  0.4307, -0.8311, -1.2920]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5049,  0.0897,  1.7949,  ...,  0.2341, -1.4697, -1.3574]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 220/321
Image: SpeGRcsB-c.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3342, -0.3804,  1.4668,  ..., -0.7710, -1.6357, -0.3901]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0886, -0.5757,  1.7090,  ..., -0.9678, -2.2734, -0.4556]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6895, -0.3767,  0.6953,  ..., -1.5928, -1.4922, -0.6895]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9355, -0.5723,  0.9375,  ..., -1.7891, -2.1309, -0.7549]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2852, -0.4888, -0.0442,  ..., -0.7720, -0.1184, -1.2061]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5312, -0.6841,  0.1981,  ..., -0.9688, -0.7568, -1.2715]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5020,  0.3398, -0.3586,  ..., -0.4817, -0.1014, -0.8887]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7480,  0.1444, -0.1163,  ..., -0.6782, -0.7402, -0.9541]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6758,  1.2334,  1.0752,  ..., -0.8433, -0.2026, -1.4727]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9214,  1.0381,  1.3174,  ..., -1.0400, -0.8413, -1.5381]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3003,  0.3350,  1.6230,  ...,  0.3408, -0.8345, -1.3232]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5459,  0.1395,  1.8652,  ...,  0.1443, -1.4727, -1.3887]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 221/321
Image: sMAT_Eth_6.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4468, -0.3628,  1.4727,  ..., -0.7393, -1.6348, -0.3423]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2012, -0.5581,  1.7148,  ..., -0.9355, -2.2734, -0.4077]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6982, -0.3174,  0.4756,  ..., -1.4648, -1.4922, -0.7002]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9434, -0.5127,  0.7178,  ..., -1.6611, -2.1309, -0.7656]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3564, -0.5874,  0.1101,  ..., -0.9395, -0.1648, -1.2021]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6016, -0.7827,  0.3525,  ..., -1.1357, -0.8037, -1.2676]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4854,  0.3232, -0.3557,  ..., -0.3887, -0.1399, -0.9009]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7305,  0.1278, -0.1134,  ..., -0.5850, -0.7783, -0.9663]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5220,  1.2520,  1.0723,  ..., -0.7446, -0.1621, -1.4395]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7676,  1.0566,  1.3145,  ..., -0.9414, -0.8008, -1.5049]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2532,  0.3247,  1.5010,  ...,  0.4761, -0.8521, -1.3027]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4988,  0.1293,  1.7432,  ...,  0.2795, -1.4902, -1.3682]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 222/321
Image: IDP06102_PKa_B.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4321, -0.4141,  1.5186,  ..., -0.7344, -1.7002, -0.4077]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1865, -0.6094,  1.7607,  ..., -0.9307, -2.3398, -0.4731]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7002, -0.4290,  0.6816,  ..., -1.6680, -1.5938, -0.6919]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9453, -0.6245,  0.9238,  ..., -1.8643, -2.2324, -0.7573]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3213, -0.6045,  0.0470,  ..., -1.0107, -0.2283, -1.2686]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5664, -0.7998,  0.2893,  ..., -1.2070, -0.8672, -1.3340]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4873,  0.2698, -0.3970,  ..., -0.4678, -0.0850, -0.9053]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7324,  0.0743, -0.1547,  ..., -0.6641, -0.7236, -0.9707]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5586,  1.1396,  1.0752,  ..., -0.8848, -0.0798, -1.3711]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8042,  0.9443,  1.3174,  ..., -1.0811, -0.7183, -1.4365]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2793,  0.2729,  1.5039,  ...,  0.4246, -0.8604, -1.2832]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5249,  0.0775,  1.7461,  ...,  0.2280, -1.4990, -1.3486]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 223/321
Image: SA49_6_set.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5317, -0.3938,  1.4492,  ..., -0.7036, -1.6230, -0.3350]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2861, -0.5894,  1.6914,  ..., -0.9004, -2.2617, -0.4004]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6484, -0.3525,  0.4392,  ..., -1.4785, -1.5078, -0.7158]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8945, -0.5479,  0.6816,  ..., -1.6748, -2.1465, -0.7812]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3018, -0.5923,  0.1438,  ..., -0.9277, -0.1543, -1.2529]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5469, -0.7876,  0.3862,  ..., -1.1240, -0.7930, -1.3184]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4570,  0.3352, -0.3521,  ..., -0.3704, -0.1317, -0.9355]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7031,  0.1398, -0.1097,  ..., -0.5669, -0.7705, -1.0010]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5322,  1.2588,  1.0996,  ..., -0.7344, -0.1980, -1.4375]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7778,  1.0635,  1.3418,  ..., -0.9307, -0.8369, -1.5029]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2112,  0.2854,  1.5137,  ...,  0.4761, -0.8594, -1.2656]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4568,  0.0900,  1.7559,  ...,  0.2795, -1.4980, -1.3311]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 224/321
Image: IDP91398-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4314, -0.4067,  1.4033,  ..., -0.7129, -1.6777, -0.3643]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1858, -0.6021,  1.6455,  ..., -0.9092, -2.3164, -0.4297]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7080, -0.2476,  0.5415,  ..., -1.4961, -1.5889, -0.6816]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.4429,  0.7837,  ..., -1.6924, -2.2266, -0.7471]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3848, -0.5713,  0.0456,  ..., -0.9326, -0.2332, -1.2344]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6309, -0.7666,  0.2878,  ..., -1.1289, -0.8721, -1.2998]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5029,  0.3027, -0.3723,  ..., -0.4001, -0.1191, -0.8921]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7480,  0.1073, -0.1300,  ..., -0.5967, -0.7578, -0.9575]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5566,  1.2383,  1.0312,  ..., -0.7637, -0.1412, -1.4600]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8022,  1.0430,  1.2734,  ..., -0.9600, -0.7798, -1.5254]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2690,  0.3003,  1.5254,  ...,  0.4580, -0.8418, -1.2871]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5146,  0.1049,  1.7676,  ...,  0.2615, -1.4805, -1.3525]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 225/321
Image: idp95069b.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4639, -0.3865,  1.4746,  ..., -0.6997, -1.6631, -0.3706]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2183, -0.5820,  1.7168,  ..., -0.8965, -2.3008, -0.4360]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6914, -0.4172,  0.6455,  ..., -1.5732, -1.5645, -0.7046]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9375, -0.6128,  0.8877,  ..., -1.7695, -2.2031, -0.7700]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3506, -0.5688,  0.0696,  ..., -0.9077, -0.1626, -1.2734]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5957, -0.7642,  0.3120,  ..., -1.1045, -0.8013, -1.3389]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4600,  0.3086, -0.3752,  ..., -0.4082, -0.0662, -0.9185]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7051,  0.1132, -0.1329,  ..., -0.6045, -0.7051, -0.9839]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5479,  1.2119,  1.0781,  ..., -0.7583, -0.1484, -1.4121]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7935,  1.0166,  1.3203,  ..., -0.9551, -0.7871, -1.4775]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2468,  0.2705,  1.5566,  ...,  0.4492, -0.8604, -1.2871]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4924,  0.0751,  1.7988,  ...,  0.2527, -1.4990, -1.3525]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 226/321
Image: IDP04297-1_Se_B.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4253, -0.4038,  1.4043,  ..., -0.7485, -1.6895, -0.3867]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1797, -0.5991,  1.6465,  ..., -0.9453, -2.3281, -0.4521]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6514, -0.2251,  0.5537,  ..., -1.4629, -1.5830, -0.6943]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8965, -0.4204,  0.7959,  ..., -1.6592, -2.2227, -0.7598]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3955, -0.5562,  0.0698,  ..., -0.8745, -0.2505, -1.2432]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6406, -0.7515,  0.3120,  ..., -1.0713, -0.8892, -1.3086]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5205,  0.3081, -0.3801,  ..., -0.3892, -0.1351, -0.8799]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7656,  0.1127, -0.1378,  ..., -0.5859, -0.7739, -0.9453]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5747,  1.2480,  1.0244,  ..., -0.8018, -0.1438, -1.4658]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8203,  1.0527,  1.2666,  ..., -0.9980, -0.7822, -1.5312]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2910,  0.2878,  1.5254,  ...,  0.4321, -0.8555, -1.3242]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5366,  0.0924,  1.7676,  ...,  0.2356, -1.4941, -1.3896]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 227/321
Image: bvu3-5.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4470, -0.4297,  1.4111,  ..., -0.7334, -1.6758, -0.3701]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2014, -0.6250,  1.6533,  ..., -0.9297, -2.3145, -0.4355]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7227, -0.2661,  0.5298,  ..., -1.5029, -1.5693, -0.6992]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9688, -0.4614,  0.7720,  ..., -1.6992, -2.2070, -0.7646]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3965, -0.5435,  0.0085,  ..., -0.9248, -0.1997, -1.2373]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6426, -0.7388,  0.2507,  ..., -1.1211, -0.8384, -1.3027]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5059,  0.2808, -0.3979,  ..., -0.3940, -0.1008, -0.8799]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7520,  0.0853, -0.1556,  ..., -0.5908, -0.7393, -0.9453]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5742,  1.2598,  1.0293,  ..., -0.7852, -0.1534, -1.4629]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8198,  1.0645,  1.2715,  ..., -0.9814, -0.7920, -1.5283]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2795,  0.2947,  1.5283,  ...,  0.4434, -0.8467, -1.3047]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5254,  0.0992,  1.7705,  ...,  0.2468, -1.4854, -1.3701]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 228/321
Image: IDP90793B4_PKa.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4551, -0.3696,  1.4678,  ..., -0.7441, -1.6484, -0.3901]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2095, -0.5649,  1.7100,  ..., -0.9404, -2.2871, -0.4556]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6670, -0.4617,  0.6274,  ..., -1.6396, -1.4912, -0.6631]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9121, -0.6572,  0.8696,  ..., -1.8359, -2.1289, -0.7285]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2324, -0.5112, -0.0188,  ..., -0.7197, -0.0918, -1.2061]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4785, -0.7065,  0.2235,  ..., -0.9160, -0.7305, -1.2715]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4785,  0.3110, -0.3191,  ..., -0.4626, -0.0995, -0.9561]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7246,  0.1156, -0.0768,  ..., -0.6592, -0.7383, -1.0215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6152,  1.2158,  1.1133,  ..., -0.8193, -0.1470, -1.4883]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8608,  1.0205,  1.3555,  ..., -1.0156, -0.7856, -1.5537]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2725,  0.2993,  1.6123,  ...,  0.3936, -0.8301, -1.3896]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5181,  0.1039,  1.8545,  ...,  0.1970, -1.4688, -1.4551]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 229/321
Image: 101464_1_E1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3831, -0.3813,  1.2402,  ..., -0.7861, -1.6172, -0.3604]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1375, -0.5767,  1.4824,  ..., -0.9824, -2.2559, -0.4258]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7656, -0.2739,  0.5640,  ..., -1.3574, -1.6152, -0.7593]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0117, -0.4692,  0.8062,  ..., -1.5537, -2.2539, -0.8247]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.5117, -0.4424,  0.0869,  ..., -0.8677, -0.2876, -1.2773]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7578, -0.6377,  0.3291,  ..., -1.0645, -0.9263, -1.3428]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5430,  0.2842, -0.3586,  ..., -0.4082, -0.1014, -0.9600]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7891,  0.0887, -0.1163,  ..., -0.6045, -0.7402, -1.0254]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5576,  1.2031,  1.0371,  ..., -0.7222, -0.1593, -1.4727]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8032,  1.0078,  1.2793,  ..., -0.9189, -0.7979, -1.5381]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3000,  0.3108,  1.5664,  ...,  0.4692, -0.9004, -1.3496]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5459,  0.1154,  1.8086,  ...,  0.2727, -1.5391, -1.4150]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 230/321
Image: AK_h6h_f2_2_7_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3337, -0.4087,  1.3193,  ..., -0.7324, -1.6553, -0.3315]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0881, -0.6040,  1.5615,  ..., -0.9287, -2.2930, -0.3970]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.8232, -0.2415,  0.5186,  ..., -1.3555, -1.5859, -0.6631]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0684, -0.4370,  0.7607,  ..., -1.5518, -2.2246, -0.7285]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4941, -0.5137,  0.0209,  ..., -0.8525, -0.3320, -1.2236]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7402, -0.7090,  0.2632,  ..., -1.0488, -0.9707, -1.2891]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5479,  0.3335, -0.3611,  ..., -0.4136, -0.1447, -0.8442]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7930,  0.1381, -0.1188,  ..., -0.6104, -0.7832, -0.9097]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5488,  1.2598,  1.0723,  ..., -0.7939, -0.1981, -1.4570]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7944,  1.0645,  1.3145,  ..., -0.9902, -0.8369, -1.5225]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3284,  0.3271,  1.5625,  ...,  0.3887, -0.9121, -1.3652]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5742,  0.1317,  1.8047,  ...,  0.1921, -1.5508, -1.4307]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 231/321
Image: sacol_1320-2infl_A.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3958, -0.3926,  1.3467,  ..., -0.7671, -1.6523, -0.3730]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1501, -0.5879,  1.5889,  ..., -0.9639, -2.2910, -0.4385]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7334, -0.2349,  0.5620,  ..., -1.4531, -1.5820, -0.6992]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9785, -0.4302,  0.8042,  ..., -1.6494, -2.2207, -0.7646]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4404, -0.4634,  0.0436,  ..., -0.9028, -0.2090, -1.2715]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6855, -0.6587,  0.2859,  ..., -1.0996, -0.8477, -1.3369]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5381,  0.3206, -0.3953,  ..., -0.4297, -0.0883, -0.9141]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.1251, -0.1530,  ..., -0.6260, -0.7271, -0.9795]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5532,  1.2461,  1.0332,  ..., -0.7729, -0.1442, -1.4434]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7988,  1.0508,  1.2754,  ..., -0.9697, -0.7827, -1.5088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2939,  0.3042,  1.5664,  ...,  0.4404, -0.8770, -1.2988]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5396,  0.1088,  1.8086,  ...,  0.2439, -1.5156, -1.3643]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 232/321
Image: 233969a8_x0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3799, -0.3879,  1.2793,  ..., -0.7822, -1.6143, -0.3647]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1343, -0.5835,  1.5215,  ..., -0.9785, -2.2539, -0.4302]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7422, -0.4175,  0.6650,  ..., -1.4814, -1.5869, -0.6753]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9883, -0.6128,  0.9072,  ..., -1.6777, -2.2266, -0.7407]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4688, -0.4575,  0.0690,  ..., -0.8877, -0.2324, -1.2588]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7148, -0.6528,  0.3113,  ..., -1.0840, -0.8711, -1.3242]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5010,  0.3096, -0.3933,  ..., -0.4458, -0.0610, -0.9434]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7461,  0.1141, -0.1510,  ..., -0.6426, -0.6997, -1.0088]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5142,  1.1611,  1.0059,  ..., -0.7808, -0.1182, -1.4355]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7598,  0.9658,  1.2480,  ..., -0.9775, -0.7568, -1.5010]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3000,  0.3250,  1.5576,  ...,  0.4399, -0.8984, -1.3809]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5459,  0.1295,  1.7998,  ...,  0.2434, -1.5371, -1.4463]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 233/321
Image: ANL-1F12sucr-peak1.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5869, -0.3960,  1.5605,  ..., -0.6987, -1.6641, -0.3696]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.3413, -0.5913,  1.8027,  ..., -0.8955, -2.3027, -0.4351]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6621, -0.5137,  0.5967,  ..., -1.6621, -1.5195, -0.6079]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9082, -0.7090,  0.8389,  ..., -1.8584, -2.1582, -0.6733]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.1699, -0.6982,  0.1237,  ..., -0.9619, -0.1731, -1.1797]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4160, -0.8936,  0.3660,  ..., -1.1582, -0.8115, -1.2451]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.3877,  0.2966, -0.3477,  ..., -0.4365, -0.1157, -0.8955]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6328,  0.1012, -0.1053,  ..., -0.6328, -0.7544, -0.9609]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5034,  1.2988,  1.0459,  ..., -0.7373, -0.1653, -1.4141]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7490,  1.1035,  1.2881,  ..., -0.9336, -0.8037, -1.4795]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2166,  0.3052,  1.5312,  ...,  0.4580, -0.8691, -1.3096]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4622,  0.1097,  1.7734,  ...,  0.2615, -1.5078, -1.3750]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 234/321
Image: 34856_1_E2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4358, -0.3843,  1.2979,  ..., -0.7349, -1.6455, -0.3511]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1902, -0.5796,  1.5400,  ..., -0.9316, -2.2852, -0.4165]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7324, -0.2637,  0.5396,  ..., -1.4082, -1.6250, -0.7100]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9785, -0.4590,  0.7817,  ..., -1.6045, -2.2637, -0.7754]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3662, -0.5098,  0.0839,  ..., -0.8628, -0.2251, -1.2451]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6113, -0.7051,  0.3262,  ..., -1.0596, -0.8638, -1.3105]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4775,  0.2585, -0.3699,  ..., -0.3582, -0.1079, -0.9326]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7227,  0.0631, -0.1276,  ..., -0.5547, -0.7466, -0.9980]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5664,  1.2354,  1.0664,  ..., -0.7246, -0.1564, -1.4502]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8120,  1.0400,  1.3086,  ..., -0.9209, -0.7949, -1.5156]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2827,  0.2969,  1.5703,  ...,  0.4741, -0.8921, -1.3262]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5283,  0.1014,  1.8125,  ...,  0.2776, -1.5312, -1.3916]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 235/321
Image: 66070_1_E1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3923, -0.3630,  1.3799,  ..., -0.7520, -1.6592, -0.3970]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1467, -0.5586,  1.6221,  ..., -0.9482, -2.2969, -0.4624]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6953, -0.4207,  0.6309,  ..., -1.5820, -1.5410, -0.7236]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.6162,  0.8730,  ..., -1.7783, -2.1797, -0.7891]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3779, -0.5059,  0.0839,  ..., -0.9653, -0.1846, -1.2734]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6230, -0.7012,  0.3262,  ..., -1.1621, -0.8232, -1.3389]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4600,  0.2991, -0.3735,  ..., -0.4077, -0.0663, -0.9502]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7051,  0.1036, -0.1312,  ..., -0.6045, -0.7051, -1.0156]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5400,  1.2217,  1.0293,  ..., -0.7769, -0.1262, -1.4424]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7856,  1.0264,  1.2715,  ..., -0.9736, -0.7646, -1.5078]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2676,  0.2949,  1.5176,  ...,  0.4355, -0.8418, -1.3623]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5132,  0.0995,  1.7598,  ...,  0.2390, -1.4805, -1.4277]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 236/321
Image: 66063_1_E2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4116, -0.3801,  1.2900,  ..., -0.7808, -1.6104, -0.3843]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1660, -0.5757,  1.5322,  ..., -0.9775, -2.2500, -0.4497]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6816, -0.3958,  0.6270,  ..., -1.4932, -1.5547, -0.7686]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9277, -0.5913,  0.8691,  ..., -1.6895, -2.1934, -0.8340]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4521, -0.4326,  0.1462,  ..., -0.8662, -0.2468, -1.2451]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6973, -0.6279,  0.3887,  ..., -1.0625, -0.8857, -1.3105]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5000,  0.3054, -0.3455,  ..., -0.4380, -0.0542, -0.9561]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7461,  0.1100, -0.1031,  ..., -0.6348, -0.6929, -1.0215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4966,  1.1562,  1.0303,  ..., -0.7778, -0.0748, -1.4336]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7422,  0.9609,  1.2725,  ..., -0.9746, -0.7134, -1.4990]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2725,  0.3235,  1.5605,  ...,  0.4536, -0.8872, -1.3848]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5181,  0.1281,  1.8027,  ...,  0.2571, -1.5254, -1.4502]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 237/321
Image: 10_3_D6.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4453, -0.4077,  1.4014,  ..., -0.7583, -1.6123, -0.3396]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1997, -0.6030,  1.6436,  ..., -0.9551, -2.2500, -0.4050]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6748, -0.3345,  0.4346,  ..., -1.4336, -1.5215, -0.7021]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9199, -0.5298,  0.6768,  ..., -1.6299, -2.1602, -0.7676]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2930, -0.4932, -0.0433,  ..., -0.7271, -0.1715, -1.1641]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5391, -0.6885,  0.1990,  ..., -0.9238, -0.8101, -1.2295]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5303,  0.3174, -0.3438,  ..., -0.4028, -0.1669, -0.9365]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7754,  0.1219, -0.1014,  ..., -0.5996, -0.8057, -1.0020]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6270,  1.2402,  1.1016,  ..., -0.7461, -0.2306, -1.5234]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8726,  1.0449,  1.3438,  ..., -0.9424, -0.8691, -1.5889]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2827,  0.3491,  1.5371,  ...,  0.4453, -0.8560, -1.3008]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5283,  0.1537,  1.7793,  ...,  0.2488, -1.4941, -1.3662]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 238/321
Image: ckc-3_7_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3816, -0.4312,  1.3291,  ..., -0.7617, -1.6943, -0.3774]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1360, -0.6265,  1.5713,  ..., -0.9580, -2.3320, -0.4429]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6924, -0.2446,  0.5239,  ..., -1.4736, -1.6328, -0.7012]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9375, -0.4399,  0.7661,  ..., -1.6699, -2.2715, -0.7666]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3877, -0.6226,  0.1655,  ..., -0.9438, -0.3118, -1.1846]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6328, -0.8179,  0.4077,  ..., -1.1406, -0.9502, -1.2500]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5078,  0.2239, -0.3855,  ..., -0.4175, -0.1456, -0.8818]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7539,  0.0284, -0.1432,  ..., -0.6143, -0.7842, -0.9473]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4958,  1.1680,  1.0254,  ..., -0.8433, -0.1577, -1.4629]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7412,  0.9727,  1.2676,  ..., -1.0400, -0.7964, -1.5283]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2832,  0.2949,  1.5762,  ...,  0.4050, -0.8535, -1.3467]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5288,  0.0995,  1.8184,  ...,  0.2085, -1.4922, -1.4121]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 239/321
Image: xtal-E4-x1.0002.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5518, -0.4102,  1.4775,  ..., -0.7520, -1.6426, -0.4004]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.3062, -0.6055,  1.7197,  ..., -0.9482, -2.2812, -0.4658]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6299, -0.2935,  0.4702,  ..., -1.4990, -1.5039, -0.6729]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8750, -0.4888,  0.7124,  ..., -1.6953, -2.1426, -0.7383]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2764, -0.6245,  0.2068,  ..., -0.9141, -0.2100, -1.1768]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5215, -0.8198,  0.4492,  ..., -1.1104, -0.8486, -1.2422]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4717,  0.3086, -0.3271,  ..., -0.4297, -0.1494, -0.8936]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7168,  0.1132, -0.0848,  ..., -0.6260, -0.7881, -0.9590]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4954,  1.1934,  1.1436,  ..., -0.7573, -0.1345, -1.3936]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7412,  0.9980,  1.3857,  ..., -0.9541, -0.7734, -1.4590]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2524,  0.2856,  1.4688,  ...,  0.4512, -0.9048, -1.3438]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4980,  0.0902,  1.7109,  ...,  0.2546, -1.5430, -1.4092]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 240/321
Image: IDP90557_J-2-1_1_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4380, -0.4507,  1.3389,  ..., -0.7500, -1.6709, -0.3438]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1924, -0.6460,  1.5811,  ..., -0.9463, -2.3086, -0.4092]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6963, -0.4136,  0.6660,  ..., -1.6133, -1.6035, -0.6450]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.6089,  0.9082,  ..., -1.8096, -2.2422, -0.7104]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2793, -0.4492, -0.0655,  ..., -0.6870, -0.1395, -1.2461]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5254, -0.6445,  0.1768,  ..., -0.8838, -0.7783, -1.3115]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4902,  0.2700, -0.3906,  ..., -0.4390, -0.1089, -0.9722]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7363,  0.0746, -0.1483,  ..., -0.6357, -0.7476, -1.0381]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6514,  1.1221,  1.0928,  ..., -0.7876, -0.1478, -1.4307]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8970,  0.9268,  1.3350,  ..., -0.9844, -0.7866, -1.4961]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3096,  0.3149,  1.5391,  ...,  0.4346, -0.8643, -1.2666]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5552,  0.1195,  1.7812,  ...,  0.2380, -1.5029, -1.3320]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 241/321
Image: vkt6-9_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4443, -0.4170,  1.2295,  ..., -0.7344, -1.6914, -0.3574]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1987, -0.6123,  1.4717,  ..., -0.9307, -2.3301, -0.4229]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7363, -0.2256,  0.4536,  ..., -1.4697, -1.5957, -0.7368]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9824, -0.4209,  0.6958,  ..., -1.6660, -2.2344, -0.8022]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3545, -0.5444,  0.1068,  ..., -0.8828, -0.2710, -1.2422]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5996, -0.7397,  0.3491,  ..., -1.0791, -0.9097, -1.3076]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4688,  0.2429, -0.3423,  ..., -0.3286, -0.1345, -0.9346]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7148,  0.0475, -0.1000,  ..., -0.5254, -0.7734, -1.0000]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5635,  1.2344,  1.0361,  ..., -0.7471, -0.1234, -1.4805]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8091,  1.0391,  1.2783,  ..., -0.9434, -0.7622, -1.5459]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2471,  0.3271,  1.5332,  ...,  0.4573, -0.8457, -1.3477]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4927,  0.1317,  1.7754,  ...,  0.2607, -1.4844, -1.4131]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 242/321
Image: 57526_2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4375, -0.3901,  1.3213,  ..., -0.7461, -1.6348, -0.3521]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1919, -0.5854,  1.5635,  ..., -0.9424, -2.2734, -0.4175]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7520, -0.2729,  0.5547,  ..., -1.3867, -1.6143, -0.7480]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9980, -0.4683,  0.7969,  ..., -1.5830, -2.2539, -0.8135]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3633, -0.4072, -0.0525,  ..., -0.6401, -0.1570, -1.2139]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6094, -0.6025,  0.1898,  ..., -0.8369, -0.7959, -1.2793]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5166,  0.2925, -0.3181,  ..., -0.4131, -0.1062, -0.9419]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.0970, -0.0758,  ..., -0.6094, -0.7451, -1.0078]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6846,  1.2227,  1.0918,  ..., -0.7354, -0.1755, -1.5088]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9302,  1.0273,  1.3340,  ..., -0.9316, -0.8145, -1.5742]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2961,  0.3342,  1.6377,  ...,  0.4426, -0.8701, -1.3369]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5420,  0.1388,  1.8799,  ...,  0.2461, -1.5088, -1.4023]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 243/321
Image: 57076_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5181, -0.3652,  1.4414,  ..., -0.7275, -1.6182, -0.3604]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2725, -0.5605,  1.6836,  ..., -0.9238, -2.2578, -0.4258]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7070, -0.3149,  0.4399,  ..., -1.4473, -1.5039, -0.6963]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.5103,  0.6821,  ..., -1.6436, -2.1426, -0.7617]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3496, -0.6074,  0.1689,  ..., -0.9043, -0.2035, -1.1865]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5957, -0.8027,  0.4111,  ..., -1.1006, -0.8423, -1.2520]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4873,  0.3245, -0.3364,  ..., -0.4331, -0.1071, -0.8945]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7324,  0.1290, -0.0941,  ..., -0.6299, -0.7456, -0.9600]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5166,  1.2529,  1.1104,  ..., -0.7666, -0.1371, -1.4551]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7622,  1.0576,  1.3525,  ..., -0.9629, -0.7759, -1.5205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2700,  0.3081,  1.5332,  ...,  0.4492, -0.9058, -1.3867]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5156,  0.1127,  1.7754,  ...,  0.2527, -1.5449, -1.4521]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 244/321
Image: aik4-11_16_00001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4961, -0.4041,  1.3623,  ..., -0.7671, -1.6533, -0.3740]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2505, -0.5996,  1.6045,  ..., -0.9639, -2.2930, -0.4395]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6934, -0.3223,  0.4841,  ..., -1.4336, -1.5850, -0.7412]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9395, -0.5176,  0.7266,  ..., -1.6299, -2.2227, -0.8066]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3721, -0.5596,  0.1277,  ..., -0.9058, -0.2314, -1.2598]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6172, -0.7549,  0.3701,  ..., -1.1025, -0.8701, -1.3252]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4883,  0.2791, -0.3784,  ..., -0.3928, -0.1168, -0.9287]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7344,  0.0836, -0.1361,  ..., -0.5894, -0.7554, -0.9941]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5498,  1.2646,  1.0547,  ..., -0.7559, -0.1799, -1.4658]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7954,  1.0693,  1.2969,  ..., -0.9521, -0.8184, -1.5312]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2502,  0.2871,  1.5205,  ...,  0.4329, -0.8921, -1.3604]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4958,  0.0917,  1.7627,  ...,  0.2363, -1.5312, -1.4258]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 245/321
Image: vby1-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3770, -0.3940,  1.3301,  ..., -0.7969, -1.6123, -0.3979]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1313, -0.5894,  1.5723,  ..., -0.9932, -2.2500, -0.4634]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7148, -0.3984,  0.6582,  ..., -1.5391, -1.5713, -0.7437]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9609, -0.5938,  0.9004,  ..., -1.7354, -2.2109, -0.8091]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3975, -0.3633, -0.0767,  ..., -0.6558, -0.1273, -1.2705]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6426, -0.5586,  0.1656,  ..., -0.8525, -0.7661, -1.3359]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5098,  0.3032, -0.3562,  ..., -0.4590, -0.0645, -0.9688]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7559,  0.1078, -0.1139,  ..., -0.6553, -0.7031, -1.0342]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6191,  1.1729,  1.0498,  ..., -0.7686, -0.1816, -1.4766]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8647,  0.9775,  1.2920,  ..., -0.9648, -0.8203, -1.5420]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2756,  0.3254,  1.5938,  ...,  0.4292, -0.8276, -1.3428]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5215,  0.1300,  1.8359,  ...,  0.2327, -1.4668, -1.4082]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 246/321
Image: ujd4-3.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3755, -0.3870,  1.2939,  ..., -0.7612, -1.6260, -0.3682]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1299, -0.5825,  1.5361,  ..., -0.9580, -2.2656, -0.4336]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7100, -0.3491,  0.7002,  ..., -1.5156, -1.6104, -0.7432]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9551, -0.5444,  0.9424,  ..., -1.7119, -2.2500, -0.8086]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4482, -0.3628,  0.0610,  ..., -0.8579, -0.1725, -1.2705]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6934, -0.5581,  0.3032,  ..., -1.0547, -0.8110, -1.3359]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4775,  0.2983, -0.3679,  ..., -0.4167, -0.0713, -0.9644]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7227,  0.1029, -0.1256,  ..., -0.6133, -0.7100, -1.0303]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5254,  1.2197,  1.0430,  ..., -0.7549, -0.1366, -1.4199]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7710,  1.0244,  1.2852,  ..., -0.9512, -0.7754, -1.4854]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2952,  0.3398,  1.5889,  ...,  0.4756, -0.8750, -1.3047]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5410,  0.1444,  1.8311,  ...,  0.2791, -1.5137, -1.3701]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 247/321
Image: 217599g11_x0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3271, -0.3760,  1.2744,  ..., -0.8262, -1.6123, -0.3750]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0815, -0.5713,  1.5166,  ..., -1.0225, -2.2500, -0.4404]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7275, -0.3745,  0.6221,  ..., -1.5293, -1.5361, -0.7051]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9727, -0.5698,  0.8643,  ..., -1.7256, -2.1758, -0.7705]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4238, -0.3711, -0.1002,  ..., -0.6445, -0.1162, -1.2266]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6699, -0.5664,  0.1421,  ..., -0.8408, -0.7549, -1.2920]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5293,  0.3259, -0.3821,  ..., -0.4629, -0.0691, -0.9536]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7754,  0.1305, -0.1398,  ..., -0.6592, -0.7080, -1.0195]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6025,  1.1543,  1.0303,  ..., -0.8135, -0.1289, -1.4805]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8481,  0.9590,  1.2725,  ..., -1.0098, -0.7676, -1.5459]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2795,  0.3367,  1.5938,  ...,  0.4172, -0.8325, -1.3496]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5254,  0.1412,  1.8359,  ...,  0.2207, -1.4707, -1.4150]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 248/321
Image: KFF-6-5_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3579, -0.4485,  1.2695,  ..., -0.7656, -1.6631, -0.3354]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1123, -0.6440,  1.5117,  ..., -0.9619, -2.3008, -0.4009]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7324, -0.2756,  0.5029,  ..., -1.4150, -1.6064, -0.6958]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9785, -0.4712,  0.7451,  ..., -1.6113, -2.2461, -0.7612]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4453, -0.5659,  0.1261,  ..., -0.9023, -0.3325, -1.2266]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6914, -0.7612,  0.3684,  ..., -1.0986, -0.9712, -1.2920]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5566,  0.2593, -0.3792,  ..., -0.4062, -0.1221, -0.9526]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8027,  0.0638, -0.1368,  ..., -0.6025, -0.7607, -1.0186]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5942,  1.2373,  1.0059,  ..., -0.7710, -0.1517, -1.5000]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8398,  1.0420,  1.2480,  ..., -0.9678, -0.7905, -1.5654]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2803,  0.3198,  1.5215,  ...,  0.4067, -0.8589, -1.3516]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5259,  0.1244,  1.7637,  ...,  0.2102, -1.4980, -1.4170]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 249/321
Image: idp02500_3TJ7.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4570, -0.4282,  1.4775,  ..., -0.7441, -1.6836, -0.3877]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2114, -0.6235,  1.7197,  ..., -0.9404, -2.3223, -0.4531]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6953, -0.3088,  0.5137,  ..., -1.4922, -1.5488, -0.6646]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.5044,  0.7559,  ..., -1.6885, -2.1875, -0.7300]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3379, -0.6426,  0.0460,  ..., -0.9805, -0.2233, -1.2373]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5840, -0.8379,  0.2883,  ..., -1.1768, -0.8618, -1.3027]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5283,  0.2966, -0.4102,  ..., -0.4170, -0.1079, -0.8838]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7734,  0.1012, -0.1678,  ..., -0.6133, -0.7466, -0.9492]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5879,  1.2939,  1.0283,  ..., -0.7783, -0.1660, -1.4824]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8335,  1.0986,  1.2705,  ..., -0.9746, -0.8047, -1.5479]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2615,  0.2739,  1.5293,  ...,  0.4033, -0.8608, -1.3223]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5068,  0.0785,  1.7715,  ...,  0.2068, -1.5000, -1.3877]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 250/321
Image: 19456_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3896, -0.4341,  1.2461,  ..., -0.7466, -1.6875, -0.3481]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1440, -0.6294,  1.4883,  ..., -0.9434, -2.3262, -0.4136]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7256, -0.3457,  0.6655,  ..., -1.5469, -1.6660, -0.7163]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9707, -0.5410,  0.9077,  ..., -1.7432, -2.3047, -0.7817]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3447, -0.3706, -0.0031,  ..., -0.6367, -0.1993, -1.1807]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5898, -0.5659,  0.2393,  ..., -0.8330, -0.8379, -1.2461]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4854,  0.2832, -0.2935,  ..., -0.4097, -0.1315, -0.9370]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7305,  0.0878, -0.0511,  ..., -0.6064, -0.7700, -1.0029]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6709,  1.2344,  1.0498,  ..., -0.7480, -0.1455, -1.5156]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9165,  1.0391,  1.2920,  ..., -0.9443, -0.7842, -1.5811]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3154,  0.3875,  1.6484,  ...,  0.4146, -0.8296, -1.3770]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5610,  0.1920,  1.8906,  ...,  0.2180, -1.4688, -1.4424]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 251/321
Image: 27726_3_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4028, -0.4106,  1.2373,  ..., -0.7471, -1.6494, -0.3145]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1572, -0.6060,  1.4795,  ..., -0.9434, -2.2891, -0.3799]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7725, -0.2729,  0.6074,  ..., -1.3779, -1.6650, -0.6826]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0176, -0.4683,  0.8496,  ..., -1.5742, -2.3047, -0.7480]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4453, -0.4375,  0.0185,  ..., -0.8721, -0.2373, -1.2109]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6914, -0.6328,  0.2607,  ..., -1.0684, -0.8760, -1.2764]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4941,  0.2659, -0.3799,  ..., -0.3958, -0.1008, -0.9189]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7402,  0.0704, -0.1376,  ..., -0.5923, -0.7393, -0.9844]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5830,  1.2344,  1.0479,  ..., -0.7222, -0.1619, -1.4600]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8286,  1.0391,  1.2900,  ..., -0.9189, -0.8008, -1.5254]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3057,  0.3311,  1.5752,  ...,  0.4836, -0.8916, -1.3262]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5513,  0.1356,  1.8174,  ...,  0.2871, -1.5303, -1.3916]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 252/321
Image: ProlWT_NaGP_2_00001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3455, -0.3774,  1.2646,  ..., -0.8228, -1.5879, -0.3984]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0999, -0.5728,  1.5068,  ..., -1.0195, -2.2266, -0.4639]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7471, -0.3066,  0.5850,  ..., -1.2988, -1.5781, -0.7798]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9922, -0.5020,  0.8271,  ..., -1.4951, -2.2168, -0.8452]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4863, -0.3960, -0.0704,  ..., -0.6045, -0.2010, -1.2021]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7324, -0.5913,  0.1719,  ..., -0.8008, -0.8398, -1.2676]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5195,  0.2700, -0.3528,  ..., -0.4155, -0.0841, -0.9204]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7656,  0.0746, -0.1105,  ..., -0.6123, -0.7227, -0.9858]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6113,  1.1709,  1.0557,  ..., -0.7148, -0.1854, -1.5049]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8569,  0.9756,  1.2979,  ..., -0.9111, -0.8242, -1.5703]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3188,  0.3467,  1.6230,  ...,  0.4478, -0.8574, -1.3652]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5645,  0.1512,  1.8652,  ...,  0.2512, -1.4961, -1.4307]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 253/321
Image: 138630_2_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4646, -0.4316,  1.3125,  ..., -0.7739, -1.6367, -0.3560]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2190, -0.6270,  1.5547,  ..., -0.9707, -2.2754, -0.4214]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7295, -0.3064,  0.5269,  ..., -1.3652, -1.6152, -0.7485]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9746, -0.5020,  0.7690,  ..., -1.5615, -2.2539, -0.8140]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4375, -0.5234,  0.1127,  ..., -0.8696, -0.2949, -1.2314]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6836, -0.7188,  0.3550,  ..., -1.0664, -0.9336, -1.2969]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5342,  0.2615, -0.3638,  ..., -0.3872, -0.1091, -0.9370]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7793,  0.0660, -0.1215,  ..., -0.5840, -0.7480, -1.0029]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5146,  1.1953,  1.0859,  ..., -0.7808, -0.1501, -1.4785]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7603,  1.0000,  1.3281,  ..., -0.9775, -0.7891, -1.5439]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2764,  0.3140,  1.5371,  ...,  0.4390, -0.9146, -1.3848]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5220,  0.1185,  1.7793,  ...,  0.2424, -1.5527, -1.4502]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 254/321
Image: tyra_heme5_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5142, -0.3936,  1.3887,  ..., -0.7383, -1.6230, -0.3711]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2686, -0.5889,  1.6309,  ..., -0.9346, -2.2617, -0.4365]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6934, -0.4810,  0.5996,  ..., -1.6211, -1.5273, -0.6875]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9395, -0.6763,  0.8418,  ..., -1.8174, -2.1660, -0.7529]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3232, -0.5703,  0.1544,  ..., -0.9243, -0.1599, -1.2695]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5684, -0.7656,  0.3967,  ..., -1.1211, -0.7988, -1.3350]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4570,  0.3018, -0.3750,  ..., -0.4453, -0.0801, -0.9468]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7031,  0.1063, -0.1327,  ..., -0.6416, -0.7188, -1.0127]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4993,  1.2119,  1.0488,  ..., -0.7852, -0.1263, -1.4141]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7451,  1.0166,  1.2910,  ..., -0.9814, -0.7651, -1.4795]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2339,  0.2793,  1.5332,  ...,  0.4385, -0.8628, -1.3613]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4795,  0.0839,  1.7754,  ...,  0.2419, -1.5020, -1.4268]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 255/321
Image: IDP102505B_PKa.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4619, -0.3982,  1.4111,  ..., -0.7803, -1.6279, -0.4028]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2163, -0.5938,  1.6533,  ..., -0.9766, -2.2656, -0.4683]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6855, -0.4585,  0.5967,  ..., -1.6191, -1.5254, -0.6841]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9316, -0.6538,  0.8389,  ..., -1.8154, -2.1641, -0.7495]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2520, -0.4634, -0.0360,  ..., -0.7095, -0.1164, -1.2539]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4980, -0.6587,  0.2063,  ..., -0.9062, -0.7549, -1.3193]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4736,  0.3042, -0.3210,  ..., -0.4473, -0.1069, -0.9697]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7188,  0.1088, -0.0787,  ..., -0.6436, -0.7456, -1.0352]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6582,  1.2627,  1.0615,  ..., -0.7695, -0.1699, -1.5020]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9038,  1.0674,  1.3037,  ..., -0.9658, -0.8086, -1.5674]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2566,  0.3208,  1.5879,  ...,  0.4050, -0.8232, -1.3828]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5020,  0.1254,  1.8301,  ...,  0.2085, -1.4619, -1.4482]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 256/321
Image: cps047-6_7.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4922, -0.4341,  1.3770,  ..., -0.7378, -1.6572, -0.3398]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2466, -0.6294,  1.6191,  ..., -0.9346, -2.2969, -0.4053]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7236, -0.2981,  0.4829,  ..., -1.4258, -1.5518, -0.7041]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9688, -0.4937,  0.7251,  ..., -1.6221, -2.1914, -0.7695]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2637, -0.5073,  0.0168,  ..., -0.7520, -0.2036, -1.1416]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5098, -0.7026,  0.2590,  ..., -0.9482, -0.8423, -1.2070]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5068,  0.2712, -0.3621,  ..., -0.4260, -0.1165, -0.9238]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7520,  0.0758, -0.1198,  ..., -0.6226, -0.7549, -0.9893]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6362,  1.2207,  1.1641,  ..., -0.7939, -0.2263, -1.5137]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8818,  1.0254,  1.4062,  ..., -0.9902, -0.8652, -1.5791]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2837,  0.3308,  1.5703,  ...,  0.4065, -0.9072, -1.3359]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5293,  0.1354,  1.8125,  ...,  0.2100, -1.5459, -1.4014]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 257/321
Image: yis5-4_6_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4048, -0.4043,  1.3203,  ..., -0.7402, -1.6895, -0.3652]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1592, -0.5996,  1.5625,  ..., -0.9365, -2.3281, -0.4307]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7744, -0.2097,  0.5239,  ..., -1.4639, -1.5684, -0.6763]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0195, -0.4053,  0.7661,  ..., -1.6602, -2.2070, -0.7417]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3691, -0.6123,  0.0820,  ..., -0.9175, -0.2622, -1.2656]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6152, -0.8076,  0.3242,  ..., -1.1143, -0.9009, -1.3311]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4648,  0.2588, -0.3696,  ..., -0.3760, -0.1505, -0.8789]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7109,  0.0634, -0.1273,  ..., -0.5723, -0.7891, -0.9443]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5498,  1.2490,  1.0840,  ..., -0.8247, -0.1323, -1.4912]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7954,  1.0537,  1.3262,  ..., -1.0215, -0.7710, -1.5566]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2832,  0.3027,  1.5654,  ...,  0.4043, -0.8760, -1.3408]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5288,  0.1073,  1.8076,  ...,  0.2078, -1.5146, -1.4062]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 258/321
Image: kam_3_3_s2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4785, -0.4111,  1.4141,  ..., -0.7407, -1.6641, -0.3818]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2329, -0.6064,  1.6562,  ..., -0.9375, -2.3027, -0.4473]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6035, -0.4187,  0.6479,  ..., -1.5840, -1.5967, -0.6919]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8496, -0.6143,  0.8901,  ..., -1.7803, -2.2344, -0.7573]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3682, -0.5620,  0.1176,  ..., -0.8770, -0.2307, -1.2637]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6133, -0.7573,  0.3599,  ..., -1.0732, -0.8691, -1.3291]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4746,  0.3103, -0.3779,  ..., -0.4351, -0.0981, -0.9297]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7207,  0.1149, -0.1356,  ..., -0.6318, -0.7368, -0.9951]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5508,  1.2119,  1.0371,  ..., -0.7490, -0.1638, -1.4424]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7964,  1.0166,  1.2793,  ..., -0.9453, -0.8027, -1.5078]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2690,  0.2778,  1.5312,  ...,  0.4478, -0.8750, -1.3281]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5146,  0.0824,  1.7734,  ...,  0.2512, -1.5137, -1.3936]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 259/321
Image: ozx5-4.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4250, -0.4067,  1.3311,  ..., -0.7798, -1.6123, -0.3765]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1794, -0.6021,  1.5732,  ..., -0.9766, -2.2500, -0.4419]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7227, -0.3220,  0.5020,  ..., -1.3857, -1.5566, -0.7227]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9688, -0.5176,  0.7441,  ..., -1.5820, -2.1953, -0.7881]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3809, -0.4761, -0.0831,  ..., -0.6611, -0.1766, -1.2158]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6270, -0.6714,  0.1592,  ..., -0.8574, -0.8154, -1.2812]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5557,  0.2988, -0.3630,  ..., -0.4238, -0.1078, -0.9565]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8008,  0.1034, -0.1207,  ..., -0.6201, -0.7466, -1.0225]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6450,  1.2119,  1.0791,  ..., -0.7451, -0.2047, -1.5293]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8906,  1.0166,  1.3213,  ..., -0.9414, -0.8433, -1.5947]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2793,  0.3213,  1.5723,  ...,  0.4268, -0.8569, -1.3340]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5249,  0.1259,  1.8145,  ...,  0.2302, -1.4961, -1.3994]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 260/321
Image: 34856_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4485, -0.3887,  1.2861,  ..., -0.7197, -1.6523, -0.3379]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2029, -0.5840,  1.5283,  ..., -0.9160, -2.2910, -0.4033]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7324, -0.2695,  0.5273,  ..., -1.4043, -1.6123, -0.7114]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9785, -0.4648,  0.7695,  ..., -1.6006, -2.2500, -0.7769]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3652, -0.5151,  0.0769,  ..., -0.8560, -0.2336, -1.2549]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6113, -0.7104,  0.3193,  ..., -1.0527, -0.8721, -1.3203]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4707,  0.2520, -0.3574,  ..., -0.3545, -0.1029, -0.9355]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7168,  0.0565, -0.1151,  ..., -0.5508, -0.7417, -1.0010]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5688,  1.2236,  1.0762,  ..., -0.7231, -0.1573, -1.4541]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8145,  1.0283,  1.3184,  ..., -0.9199, -0.7959, -1.5195]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2842,  0.2944,  1.5635,  ...,  0.4827, -0.8999, -1.3174]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5298,  0.0990,  1.8057,  ...,  0.2861, -1.5391, -1.3828]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 261/321
Image: idp91829-IEX-pk1-a.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4023, -0.3906,  1.3262,  ..., -0.7822, -1.6230, -0.3823]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1567, -0.5859,  1.5684,  ..., -0.9785, -2.2617, -0.4478]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7148, -0.2739,  0.5132,  ..., -1.3926, -1.5205, -0.7319]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9609, -0.4692,  0.7554,  ..., -1.5889, -2.1602, -0.7974]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4707, -0.5273,  0.0834,  ..., -0.8677, -0.2712, -1.2812]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7168, -0.7227,  0.3257,  ..., -1.0645, -0.9102, -1.3467]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5420,  0.3081, -0.3696,  ..., -0.3979, -0.1312, -0.9253]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7871,  0.1127, -0.1273,  ..., -0.5947, -0.7700, -0.9907]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5508,  1.2256,  1.0293,  ..., -0.7354, -0.1772, -1.4531]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7964,  1.0303,  1.2715,  ..., -0.9316, -0.8159, -1.5186]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2783,  0.2798,  1.5391,  ...,  0.4475, -0.8701, -1.3223]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5239,  0.0844,  1.7812,  ...,  0.2510, -1.5088, -1.3877]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 262/321
Image: 149288_2_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4373, -0.3833,  1.2920,  ..., -0.7529, -1.6221, -0.3618]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1917, -0.5786,  1.5342,  ..., -0.9492, -2.2617, -0.4272]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7363, -0.3325,  0.5107,  ..., -1.3672, -1.6133, -0.7485]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9824, -0.5278,  0.7529,  ..., -1.5635, -2.2520, -0.8140]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4482, -0.4985,  0.0715,  ..., -0.8745, -0.2358, -1.2744]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6934, -0.6938,  0.3137,  ..., -1.0713, -0.8745, -1.3398]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5146,  0.2783, -0.3779,  ..., -0.3804, -0.0945, -0.9561]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.0829, -0.1356,  ..., -0.5771, -0.7334, -1.0215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5449,  1.2236,  1.0527,  ..., -0.7402, -0.1677, -1.4551]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7905,  1.0283,  1.2949,  ..., -0.9365, -0.8066, -1.5205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2656,  0.3052,  1.5400,  ...,  0.4570, -0.9077, -1.3359]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5112,  0.1097,  1.7822,  ...,  0.2605, -1.5469, -1.4014]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 263/321
Image: Puck10-2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3823, -0.3696,  1.4580,  ..., -0.7861, -1.6523, -0.3760]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1367, -0.5649,  1.7002,  ..., -0.9824, -2.2910, -0.4414]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6699, -0.4099,  0.5732,  ..., -1.6162, -1.4736, -0.7212]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9160, -0.6055,  0.8154,  ..., -1.8125, -2.1133, -0.7866]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3076, -0.4434, -0.0638,  ..., -0.7139, -0.1053, -1.2344]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5527, -0.6387,  0.1785,  ..., -0.9102, -0.7441, -1.2998]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5156,  0.3574, -0.3425,  ..., -0.4634, -0.1375, -0.9561]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.1620, -0.1002,  ..., -0.6602, -0.7764, -1.0215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6216,  1.2314,  1.0732,  ..., -0.7822, -0.2161, -1.5000]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8672,  1.0361,  1.3154,  ..., -0.9785, -0.8545, -1.5654]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2957,  0.3511,  1.5742,  ...,  0.4016, -0.8477, -1.3389]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5410,  0.1556,  1.8164,  ...,  0.2051, -1.4863, -1.4043]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 264/321
Image: 109793_M1_G10_data.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4795, -0.4016,  1.4873,  ..., -0.7207, -1.7031, -0.3818]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2339, -0.5972,  1.7295,  ..., -0.9170, -2.3418, -0.4473]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6836, -0.4160,  0.6577,  ..., -1.6484, -1.5879, -0.6587]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9297, -0.6113,  0.8999,  ..., -1.8447, -2.2266, -0.7241]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2910, -0.6138,  0.0262,  ..., -0.9238, -0.1923, -1.2393]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5371, -0.8091,  0.2686,  ..., -1.1201, -0.8311, -1.3047]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4639,  0.3027, -0.4070,  ..., -0.4458, -0.0967, -0.9141]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7090,  0.1073, -0.1647,  ..., -0.6426, -0.7354, -0.9795]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5576,  1.1514,  1.0703,  ..., -0.7939, -0.0948, -1.3545]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8032,  0.9561,  1.3125,  ..., -0.9902, -0.7334, -1.4199]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3062,  0.2700,  1.5244,  ...,  0.4050, -0.9106, -1.2949]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5518,  0.0746,  1.7666,  ...,  0.2085, -1.5488, -1.3604]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 265/321
Image: 111979_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4399, -0.3877,  1.3428,  ..., -0.7549, -1.6191, -0.3750]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1943, -0.5830,  1.5850,  ..., -0.9512, -2.2578, -0.4404]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7295, -0.2981,  0.5000,  ..., -1.4189, -1.5508, -0.7065]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9746, -0.4937,  0.7422,  ..., -1.6152, -2.1895, -0.7720]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4180, -0.5220,  0.1283,  ..., -0.9014, -0.2164, -1.2354]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6641, -0.7173,  0.3706,  ..., -1.0977, -0.8550, -1.3008]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5117,  0.2844, -0.3613,  ..., -0.4099, -0.0863, -0.9214]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7578,  0.0890, -0.1190,  ..., -0.6064, -0.7251, -0.9868]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5146,  1.2227,  1.0811,  ..., -0.7925, -0.1265, -1.4473]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7603,  1.0273,  1.3232,  ..., -0.9893, -0.7651, -1.5127]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2632,  0.2935,  1.5586,  ...,  0.4404, -0.8789, -1.3652]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5088,  0.0980,  1.8008,  ...,  0.2439, -1.5176, -1.4307]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 266/321
Image: idp951-2_A.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3921, -0.4204,  1.3584,  ..., -0.7427, -1.6650, -0.3491]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1465, -0.6157,  1.6006,  ..., -0.9395, -2.3047, -0.4146]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7256, -0.2729,  0.4993,  ..., -1.4619, -1.5918, -0.6978]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9707, -0.4683,  0.7417,  ..., -1.6582, -2.2305, -0.7632]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3477, -0.4629, -0.1166,  ..., -0.6528, -0.1617, -1.1582]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5938, -0.6582,  0.1257,  ..., -0.8496, -0.8003, -1.2236]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5371,  0.2839, -0.3542,  ..., -0.4023, -0.1216, -0.9355]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.0885, -0.1119,  ..., -0.5986, -0.7603, -1.0010]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6401,  1.2314,  1.0762,  ..., -0.7900, -0.1997, -1.5342]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8857,  1.0361,  1.3184,  ..., -0.9863, -0.8384, -1.5996]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2896,  0.3647,  1.5674,  ...,  0.4238, -0.8315, -1.3398]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5352,  0.1693,  1.8096,  ...,  0.2273, -1.4707, -1.4053]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 267/321
Image: SsfS6_TDP.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4023, -0.4453,  1.3379,  ..., -0.7759, -1.6270, -0.3799]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1567, -0.6406,  1.5801,  ..., -0.9727, -2.2656, -0.4453]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6973, -0.4519,  0.6748,  ..., -1.5703, -1.5928, -0.7129]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9434, -0.6475,  0.9170,  ..., -1.7666, -2.2305, -0.7783]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3584, -0.4629, -0.0623,  ..., -0.6753, -0.1506, -1.2607]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6035, -0.6582,  0.1799,  ..., -0.8721, -0.7891, -1.3262]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5127,  0.2625, -0.3701,  ..., -0.4746, -0.0867, -0.9829]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7578,  0.0670, -0.1278,  ..., -0.6709, -0.7256, -1.0488]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6719,  1.1602,  1.0547,  ..., -0.7578, -0.2174, -1.4971]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9175,  0.9648,  1.2969,  ..., -0.9541, -0.8560, -1.5625]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2827,  0.3123,  1.6055,  ...,  0.4106, -0.8438, -1.3379]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5283,  0.1168,  1.8477,  ...,  0.2141, -1.4824, -1.4033]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 268/321
Image: idp90549_3O6C.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5381, -0.4338,  1.4639,  ..., -0.7324, -1.6582, -0.3672]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2925, -0.6294,  1.7061,  ..., -0.9287, -2.2969, -0.4326]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6807, -0.4639,  0.5820,  ..., -1.6465, -1.5664, -0.6606]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9258, -0.6592,  0.8242,  ..., -1.8428, -2.2051, -0.7261]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2793, -0.6001,  0.1279,  ..., -0.9434, -0.1748, -1.2656]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5254, -0.7954,  0.3701,  ..., -1.1396, -0.8135, -1.3311]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4551,  0.2930, -0.3606,  ..., -0.4326, -0.1107, -0.9268]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7012,  0.0975, -0.1183,  ..., -0.6289, -0.7495, -0.9922]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5718,  1.2529,  1.0449,  ..., -0.7529, -0.1703, -1.4590]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8174,  1.0576,  1.2871,  ..., -0.9492, -0.8091, -1.5244]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2213,  0.2891,  1.5176,  ...,  0.4492, -0.8345, -1.3369]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4668,  0.0936,  1.7598,  ...,  0.2527, -1.4727, -1.4023]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 269/321
Image: KDM4A_1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3403, -0.4429,  1.3936,  ..., -0.7852, -1.6689, -0.3760]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0947, -0.6382,  1.6357,  ..., -0.9814, -2.3086, -0.4414]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6553, -0.4097,  0.6577,  ..., -1.5781, -1.5645, -0.6802]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9004, -0.6050,  0.8999,  ..., -1.7744, -2.2031, -0.7456]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3740, -0.4243, -0.0754,  ..., -0.6626, -0.1394, -1.2393]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6191, -0.6196,  0.1669,  ..., -0.8594, -0.7783, -1.3047]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5381,  0.2939, -0.3730,  ..., -0.4641, -0.1080, -0.9341]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.0985, -0.1307,  ..., -0.6606, -0.7466, -0.9995]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6631,  1.1816,  1.0459,  ..., -0.7783, -0.1921, -1.5117]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9087,  0.9863,  1.2881,  ..., -0.9746, -0.8311, -1.5771]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2964,  0.3276,  1.6055,  ...,  0.3994, -0.8281, -1.3398]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5420,  0.1322,  1.8477,  ...,  0.2029, -1.4668, -1.4053]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 270/321
Image: lnk6-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3962, -0.4131,  1.3730,  ..., -0.8008, -1.6211, -0.3936]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1506, -0.6084,  1.6152,  ..., -0.9971, -2.2598, -0.4590]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6807, -0.4514,  0.6562,  ..., -1.5391, -1.5703, -0.7383]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9258, -0.6470,  0.8984,  ..., -1.7354, -2.2090, -0.8037]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3516, -0.4258, -0.0399,  ..., -0.6982, -0.1348, -1.2598]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5977, -0.6211,  0.2024,  ..., -0.8945, -0.7734, -1.3252]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5215,  0.2957, -0.3645,  ..., -0.4746, -0.0825, -0.9512]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7676,  0.1002, -0.1222,  ..., -0.6709, -0.7212, -1.0166]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6523,  1.1836,  1.0459,  ..., -0.7593, -0.2023, -1.5137]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8979,  0.9883,  1.2881,  ..., -0.9561, -0.8408, -1.5791]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2856,  0.3149,  1.5996,  ...,  0.3882, -0.8413, -1.3770]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5312,  0.1195,  1.8418,  ...,  0.1917, -1.4805, -1.4424]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 271/321
Image: E2_8_set.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4629, -0.3799,  1.3652,  ..., -0.7734, -1.5879, -0.3950]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2173, -0.5752,  1.6074,  ..., -0.9697, -2.2266, -0.4604]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7168, -0.2937,  0.5020,  ..., -1.4160, -1.5303, -0.7275]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9629, -0.4893,  0.7441,  ..., -1.6123, -2.1680, -0.7930]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3447, -0.4736, -0.0845,  ..., -0.6724, -0.1349, -1.2100]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5898, -0.6689,  0.1578,  ..., -0.8691, -0.7734, -1.2754]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5244,  0.3174, -0.3516,  ..., -0.4026, -0.0950, -0.9512]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7695,  0.1219, -0.1093,  ..., -0.5991, -0.7334, -1.0166]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6357,  1.2432,  1.0938,  ..., -0.7402, -0.1827, -1.5059]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8813,  1.0479,  1.3359,  ..., -0.9365, -0.8213, -1.5713]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2534,  0.3130,  1.5840,  ...,  0.4302, -0.8657, -1.3164]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4990,  0.1176,  1.8262,  ...,  0.2336, -1.5039, -1.3818]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 272/321
Image: a0_k4.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4971, -0.4229,  1.4414,  ..., -0.7217, -1.6475, -0.3535]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2515, -0.6182,  1.6836,  ..., -0.9180, -2.2852, -0.4189]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6777, -0.4456,  0.6372,  ..., -1.6221, -1.6055, -0.6587]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9238, -0.6411,  0.8794,  ..., -1.8184, -2.2441, -0.7241]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3008, -0.6094,  0.1041,  ..., -0.9531, -0.2139, -1.2783]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5469, -0.8047,  0.3464,  ..., -1.1494, -0.8525, -1.3438]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4609,  0.3074, -0.3950,  ..., -0.4321, -0.1002, -0.9219]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7070,  0.1119, -0.1527,  ..., -0.6289, -0.7388, -0.9873]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5347,  1.2051,  1.0605,  ..., -0.8140, -0.1584, -1.4521]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7803,  1.0098,  1.3027,  ..., -1.0107, -0.7969, -1.5176]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2571,  0.2766,  1.5186,  ...,  0.4282, -0.8657, -1.3105]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5029,  0.0812,  1.7607,  ...,  0.2317, -1.5039, -1.3760]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 273/321
Image: DneoptPIH7eg.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4199, -0.4014,  1.4766,  ..., -0.7598, -1.6562, -0.3594]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1743, -0.5967,  1.7188,  ..., -0.9561, -2.2949, -0.4248]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6816, -0.4846,  0.5752,  ..., -1.6289, -1.5479, -0.6582]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9277, -0.6802,  0.8174,  ..., -1.8252, -2.1875, -0.7236]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2051, -0.4780, -0.0603,  ..., -0.7495, -0.1241, -1.2158]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4512, -0.6733,  0.1820,  ..., -0.9463, -0.7627, -1.2812]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4707,  0.2966, -0.3064,  ..., -0.4697, -0.1255, -0.9585]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7168,  0.1012, -0.0641,  ..., -0.6660, -0.7642, -1.0244]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6255,  1.2109,  1.0977,  ..., -0.7729, -0.2114, -1.5234]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8711,  1.0156,  1.3398,  ..., -0.9697, -0.8501, -1.5889]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2644,  0.3320,  1.5605,  ...,  0.4360, -0.8003, -1.3359]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5098,  0.1366,  1.8027,  ...,  0.2395, -1.4395, -1.4014]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 274/321
Image: 38347_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4800, -0.4150,  1.3252,  ..., -0.7617, -1.6270, -0.3682]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2344, -0.6104,  1.5674,  ..., -0.9580, -2.2656, -0.4336]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7178, -0.3135,  0.5010,  ..., -1.4102, -1.5967, -0.7388]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9629, -0.5088,  0.7432,  ..., -1.6064, -2.2344, -0.8042]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4062, -0.5503,  0.1299,  ..., -0.8931, -0.2468, -1.2520]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6523, -0.7456,  0.3721,  ..., -1.0898, -0.8857, -1.3174]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5137,  0.2544, -0.3667,  ..., -0.3677, -0.1042, -0.9482]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.0590, -0.1244,  ..., -0.5645, -0.7432, -1.0137]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5542,  1.2324,  1.0664,  ..., -0.7251, -0.1608, -1.4746]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7998,  1.0371,  1.3086,  ..., -0.9219, -0.7993, -1.5400]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2402,  0.3003,  1.5273,  ...,  0.4487, -0.8979, -1.3525]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4858,  0.1049,  1.7695,  ...,  0.2522, -1.5371, -1.4180]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 275/321
Image: 181314_2_E1_00017.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4321, -0.3855,  1.3291,  ..., -0.7358, -1.6475, -0.3574]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1865, -0.5811,  1.5713,  ..., -0.9326, -2.2852, -0.4229]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7432, -0.2798,  0.5234,  ..., -1.3750, -1.5869, -0.7114]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9883, -0.4751,  0.7656,  ..., -1.5713, -2.2266, -0.7769]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3984, -0.4790,  0.0977,  ..., -0.8804, -0.2039, -1.2607]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6445, -0.6743,  0.3401,  ..., -1.0771, -0.8428, -1.3262]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4688,  0.2776, -0.3296,  ..., -0.3689, -0.0984, -0.9365]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7148,  0.0822, -0.0873,  ..., -0.5654, -0.7373, -1.0020]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5312,  1.2256,  1.0967,  ..., -0.7549, -0.1306, -1.4346]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7769,  1.0303,  1.3389,  ..., -0.9512, -0.7695, -1.5000]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2415,  0.3140,  1.5605,  ...,  0.4644, -0.8745, -1.3193]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4871,  0.1185,  1.8027,  ...,  0.2678, -1.5137, -1.3848]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 276/321
Image: IDP04389-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4402, -0.3955,  1.3379,  ..., -0.8003, -1.5918, -0.3916]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1946, -0.5908,  1.5801,  ..., -0.9971, -2.2305, -0.4570]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6914, -0.3125,  0.5376,  ..., -1.3809, -1.5732, -0.7266]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9375, -0.5078,  0.7798,  ..., -1.5771, -2.2109, -0.7920]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4609, -0.5396,  0.1758,  ..., -0.8906, -0.2588, -1.2637]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7070, -0.7349,  0.4180,  ..., -1.0869, -0.8975, -1.3291]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5352,  0.2974, -0.3806,  ..., -0.4087, -0.0696, -0.9556]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7812,  0.1019, -0.1383,  ..., -0.6055, -0.7080, -1.0215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5376,  1.2266,  1.0547,  ..., -0.7456, -0.1656, -1.4541]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7832,  1.0312,  1.2969,  ..., -0.9424, -0.8042, -1.5195]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2622,  0.2930,  1.5391,  ...,  0.4473, -0.8691, -1.3359]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5078,  0.0975,  1.7812,  ...,  0.2507, -1.5078, -1.4014]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 277/321
Image: idp90792ad.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4043, -0.4478,  1.3525,  ..., -0.7520, -1.6865, -0.3501]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1587, -0.6431,  1.5947,  ..., -0.9482, -2.3242, -0.4155]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7021, -0.2544,  0.5713,  ..., -1.4639, -1.5977, -0.6855]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9473, -0.4497,  0.8135,  ..., -1.6602, -2.2363, -0.7510]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3574, -0.4790, -0.0907,  ..., -0.6597, -0.1765, -1.2139]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6035, -0.6743,  0.1516,  ..., -0.8564, -0.8154, -1.2793]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5400,  0.2661, -0.3660,  ..., -0.4055, -0.1251, -0.9375]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7852,  0.0707, -0.1237,  ..., -0.6021, -0.7637, -1.0029]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6719,  1.2080,  1.0703,  ..., -0.7617, -0.2065, -1.5439]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9175,  1.0127,  1.3125,  ..., -0.9580, -0.8452, -1.6094]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2981,  0.3181,  1.5762,  ...,  0.4377, -0.8296, -1.3096]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5439,  0.1227,  1.8184,  ...,  0.2412, -1.4688, -1.3750]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 278/321
Image: idp90278c.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3823, -0.3770,  1.3955,  ..., -0.7812, -1.6211, -0.3989]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1367, -0.5723,  1.6377,  ..., -0.9775, -2.2598, -0.4644]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7021, -0.4250,  0.6274,  ..., -1.5566, -1.4971, -0.7202]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9473, -0.6206,  0.8696,  ..., -1.7529, -2.1367, -0.7856]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3213, -0.4375, -0.0172,  ..., -0.7139, -0.1385, -1.2080]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5664, -0.6328,  0.2251,  ..., -0.9102, -0.7773, -1.2734]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5068,  0.3345, -0.3369,  ..., -0.4805, -0.0868, -0.9668]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7520,  0.1390, -0.0946,  ..., -0.6768, -0.7256, -1.0322]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5986,  1.1553,  1.0859,  ..., -0.8105, -0.1669, -1.4707]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8442,  0.9600,  1.3281,  ..., -1.0068, -0.8057, -1.5361]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2673,  0.3142,  1.5762,  ...,  0.3848, -0.8306, -1.3770]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5127,  0.1188,  1.8184,  ...,  0.1882, -1.4688, -1.4424]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 279/321
Image: 17328_5_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3848, -0.4033,  1.2324,  ..., -0.7456, -1.6699, -0.3018]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1392, -0.5986,  1.4746,  ..., -0.9424, -2.3086, -0.3672]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7607, -0.2737,  0.5825,  ..., -1.3828, -1.6426, -0.6719]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0059, -0.4692,  0.8247,  ..., -1.5791, -2.2812, -0.7373]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4678, -0.4331, -0.0030,  ..., -0.8188, -0.2642, -1.2227]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7129, -0.6284,  0.2393,  ..., -1.0156, -0.9028, -1.2881]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4961,  0.2561, -0.3511,  ..., -0.3633, -0.1274, -0.9243]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7422,  0.0607, -0.1088,  ..., -0.5596, -0.7661, -0.9897]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5669,  1.2090,  1.0488,  ..., -0.7070, -0.1816, -1.4785]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8125,  1.0137,  1.2910,  ..., -0.9033, -0.8203, -1.5439]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3369,  0.3408,  1.5869,  ...,  0.5000, -0.8892, -1.3340]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5825,  0.1454,  1.8291,  ...,  0.3035, -1.5273, -1.3994]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 280/321
Image: idp90540_3THA.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5093, -0.4233,  1.5537,  ..., -0.7197, -1.6992, -0.3989]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2637, -0.6187,  1.7959,  ..., -0.9160, -2.3379, -0.4644]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7168, -0.4485,  0.6602,  ..., -1.6748, -1.5742, -0.6348]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9629, -0.6440,  0.9023,  ..., -1.8711, -2.2129, -0.7002]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2666, -0.6592,  0.0626,  ..., -1.0059, -0.1938, -1.2686]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5117, -0.8545,  0.3049,  ..., -1.2021, -0.8325, -1.3340]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4707,  0.2759, -0.3860,  ..., -0.4561, -0.1115, -0.9067]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7168,  0.0804, -0.1437,  ..., -0.6523, -0.7500, -0.9722]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5527,  1.1660,  1.0742,  ..., -0.8276, -0.1021, -1.3945]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7983,  0.9707,  1.3164,  ..., -1.0244, -0.7407, -1.4600]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2542,  0.2661,  1.4854,  ...,  0.4258, -0.8687, -1.2852]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4998,  0.0707,  1.7275,  ...,  0.2292, -1.5078, -1.3506]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 281/321
Image: meu8-4.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4465, -0.4204,  1.3682,  ..., -0.7524, -1.6338, -0.3633]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2009, -0.6157,  1.6104,  ..., -0.9492, -2.2734, -0.4287]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7109, -0.2844,  0.5151,  ..., -1.4434, -1.5830, -0.7100]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9570, -0.4800,  0.7573,  ..., -1.6396, -2.2227, -0.7754]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3984, -0.5361,  0.0837,  ..., -0.9233, -0.2278, -1.2510]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6445, -0.7314,  0.3262,  ..., -1.1201, -0.8662, -1.3164]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5195,  0.2944, -0.3906,  ..., -0.4028, -0.0739, -0.9351]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7656,  0.0990, -0.1483,  ..., -0.5996, -0.7124, -1.0010]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5586,  1.2588,  1.0518,  ..., -0.7534, -0.1687, -1.4727]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8042,  1.0635,  1.2939,  ..., -0.9502, -0.8076, -1.5381]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2460,  0.3027,  1.5010,  ...,  0.4507, -0.8501, -1.3086]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4917,  0.1073,  1.7432,  ...,  0.2542, -1.4883, -1.3740]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 282/321
Image: sMAT_N159G.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4043, -0.3584,  1.3721,  ..., -0.7588, -1.6367, -0.3813]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1587, -0.5537,  1.6143,  ..., -0.9551, -2.2754, -0.4468]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7109, -0.2715,  0.5107,  ..., -1.4229, -1.5342, -0.7178]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9570, -0.4668,  0.7529,  ..., -1.6191, -2.1719, -0.7832]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4102, -0.5142,  0.0679,  ..., -0.9053, -0.2101, -1.2939]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6562, -0.7095,  0.3103,  ..., -1.1016, -0.8486, -1.3594]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5117,  0.3267, -0.3706,  ..., -0.3779, -0.1029, -0.9268]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7578,  0.1312, -0.1283,  ..., -0.5742, -0.7417, -0.9922]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5288,  1.2480,  1.0557,  ..., -0.7812, -0.1450, -1.4297]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7744,  1.0527,  1.2979,  ..., -0.9775, -0.7837, -1.4951]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2524,  0.3003,  1.5244,  ...,  0.4438, -0.8560, -1.3027]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4980,  0.1049,  1.7666,  ...,  0.2473, -1.4941, -1.3682]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 283/321
Image: NY28_10set3.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4253, -0.4282,  1.3105,  ..., -0.7700, -1.5859, -0.3691]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1797, -0.6235,  1.5527,  ..., -0.9668, -2.2246, -0.4346]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7051, -0.3857,  0.6167,  ..., -1.5527, -1.5957, -0.7026]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9512, -0.5811,  0.8589,  ..., -1.7490, -2.2344, -0.7681]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3945, -0.4204, -0.0859,  ..., -0.6553, -0.1307, -1.2676]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6406, -0.6157,  0.1565,  ..., -0.8516, -0.7695, -1.3330]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5137,  0.3105, -0.3850,  ..., -0.4338, -0.0856, -0.9946]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7598,  0.1151, -0.1427,  ..., -0.6304, -0.7241, -1.0605]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6714,  1.2246,  1.0586,  ..., -0.7686, -0.2045, -1.5039]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9170,  1.0293,  1.3008,  ..., -0.9648, -0.8433, -1.5693]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2617,  0.3174,  1.5615,  ...,  0.4070, -0.8335, -1.3223]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5073,  0.1219,  1.8037,  ...,  0.2104, -1.4727, -1.3877]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 284/321
Image: p4_1_E1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3330, -0.4375,  1.3623,  ..., -0.7324, -1.7344, -0.3560]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0874, -0.6328,  1.6045,  ..., -0.9287, -2.3730, -0.4214]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6943, -0.2561,  0.5996,  ..., -1.4980, -1.6104, -0.6685]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9395, -0.4517,  0.8418,  ..., -1.6943, -2.2500, -0.7339]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3691, -0.6396,  0.1155,  ..., -0.9551, -0.3154, -1.1963]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6152, -0.8350,  0.3579,  ..., -1.1514, -0.9541, -1.2617]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5254,  0.2263, -0.4182,  ..., -0.4238, -0.1488, -0.8784]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7715,  0.0309, -0.1759,  ..., -0.6201, -0.7876, -0.9438]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5254,  1.1846,  1.0273,  ..., -0.8862, -0.1838, -1.4980]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7710,  0.9893,  1.2695,  ..., -1.0830, -0.8223, -1.5635]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3174,  0.3101,  1.5391,  ...,  0.3916, -0.8491, -1.3359]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5630,  0.1146,  1.7812,  ...,  0.1951, -1.4883, -1.4014]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 285/321
Image: 1001_M2_B7_low.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4248, -0.4399,  1.4248,  ..., -0.7695, -1.6465, -0.3545]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1792, -0.6353,  1.6670,  ..., -0.9658, -2.2852, -0.4199]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6943, -0.4336,  0.5742,  ..., -1.5986, -1.6270, -0.6528]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9395, -0.6289,  0.8164,  ..., -1.7949, -2.2656, -0.7183]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3125, -0.4746, -0.0839,  ..., -0.6953, -0.1821, -1.2197]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5586, -0.6699,  0.1584,  ..., -0.8916, -0.8208, -1.2852]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5293,  0.3022, -0.3496,  ..., -0.4519, -0.1185, -0.9336]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7754,  0.1068, -0.1073,  ..., -0.6484, -0.7573, -0.9990]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6602,  1.2334,  1.0527,  ..., -0.7676, -0.2139, -1.5225]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9058,  1.0381,  1.2949,  ..., -0.9639, -0.8525, -1.5879]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2817,  0.3386,  1.5488,  ...,  0.4263, -0.8218, -1.3477]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5273,  0.1432,  1.7910,  ...,  0.2297, -1.4609, -1.4131]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 286/321
Image: imp-m3f8e.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5420, -0.3672,  1.5479,  ..., -0.7114, -1.6875, -0.3989]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2964, -0.5625,  1.7900,  ..., -0.9082, -2.3262, -0.4644]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6318, -0.4805,  0.6211,  ..., -1.6719, -1.5273, -0.6504]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8770, -0.6758,  0.8633,  ..., -1.8682, -2.1660, -0.7158]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2109, -0.6909,  0.0986,  ..., -0.9326, -0.1492, -1.1992]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4570, -0.8862,  0.3408,  ..., -1.1289, -0.7881, -1.2646]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4043,  0.2927, -0.3811,  ..., -0.4390, -0.0897, -0.9062]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6504,  0.0973, -0.1388,  ..., -0.6357, -0.7285, -0.9717]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4905,  1.2217,  1.0732,  ..., -0.8096, -0.1240, -1.4180]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7363,  1.0264,  1.3154,  ..., -1.0059, -0.7627, -1.4834]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2620,  0.2725,  1.5469,  ...,  0.4189, -0.8633, -1.3389]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5078,  0.0770,  1.7891,  ...,  0.2224, -1.5020, -1.4043]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 287/321
Image: 86292_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3550, -0.3970,  1.2705,  ..., -0.7705, -1.6660, -0.3467]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1094, -0.5923,  1.5127,  ..., -0.9668, -2.3047, -0.4121]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7598, -0.2463,  0.5947,  ..., -1.3936, -1.6309, -0.7168]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0059, -0.4419,  0.8369,  ..., -1.5898, -2.2695, -0.7822]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4629, -0.4697,  0.0587,  ..., -0.8574, -0.2683, -1.2178]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7090, -0.6650,  0.3010,  ..., -1.0537, -0.9072, -1.2832]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5117,  0.2715, -0.3625,  ..., -0.4004, -0.0992, -0.9077]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7578,  0.0760, -0.1202,  ..., -0.5967, -0.7378, -0.9731]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5703,  1.2012,  1.0479,  ..., -0.7261, -0.1650, -1.4688]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8159,  1.0059,  1.2900,  ..., -0.9229, -0.8037, -1.5342]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3213,  0.3081,  1.5859,  ...,  0.4683, -0.8818, -1.3301]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5669,  0.1127,  1.8281,  ...,  0.2717, -1.5205, -1.3955]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 288/321
Image: idp90862a.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4248, -0.3828,  1.3164,  ..., -0.7710, -1.6680, -0.3853]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1792, -0.5781,  1.5586,  ..., -0.9678, -2.3066, -0.4507]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6855, -0.2576,  0.5303,  ..., -1.4219, -1.5762, -0.7222]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9316, -0.4531,  0.7725,  ..., -1.6182, -2.2148, -0.7876]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4092, -0.5356,  0.0865,  ..., -0.8486, -0.2637, -1.2842]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6543, -0.7310,  0.3289,  ..., -1.0449, -0.9023, -1.3496]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5166,  0.2964, -0.3608,  ..., -0.3696, -0.1221, -0.9326]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.1010, -0.1185,  ..., -0.5664, -0.7607, -0.9980]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5415,  1.2070,  1.0508,  ..., -0.7168, -0.1658, -1.4639]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7871,  1.0117,  1.2930,  ..., -0.9131, -0.8047, -1.5293]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2747,  0.2861,  1.5391,  ...,  0.4644, -0.8584, -1.3242]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5205,  0.0907,  1.7812,  ...,  0.2678, -1.4971, -1.3896]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 289/321
Image: 11258_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4690, -0.4204,  1.3721,  ..., -0.7188, -1.6660, -0.3647]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2234, -0.6157,  1.6143,  ..., -0.9150, -2.3047, -0.4302]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7334, -0.2974,  0.5166,  ..., -1.4453, -1.5957, -0.7144]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9785, -0.4927,  0.7588,  ..., -1.6416, -2.2344, -0.7798]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3584, -0.5601,  0.1003,  ..., -0.9165, -0.2009, -1.2461]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6035, -0.7554,  0.3425,  ..., -1.1133, -0.8398, -1.3115]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4824,  0.2588, -0.3628,  ..., -0.3892, -0.0841, -0.9297]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7285,  0.0634, -0.1205,  ..., -0.5859, -0.7227, -0.9951]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5225,  1.2168,  1.1172,  ..., -0.7939, -0.1469, -1.4463]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7681,  1.0215,  1.3594,  ..., -0.9902, -0.7856, -1.5117]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2314,  0.2920,  1.5430,  ...,  0.4326, -0.8862, -1.3320]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4771,  0.0966,  1.7852,  ...,  0.2361, -1.5254, -1.3975]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 290/321
Image: xtal-1-1463_H10.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5078, -0.3989,  1.4736,  ..., -0.7349, -1.6582, -0.3726]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2622, -0.5942,  1.7158,  ..., -0.9316, -2.2969, -0.4380]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6338, -0.4583,  0.6299,  ..., -1.6299, -1.5508, -0.6543]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8789, -0.6538,  0.8721,  ..., -1.8262, -2.1895, -0.7197]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3027, -0.6274,  0.1376,  ..., -0.9531, -0.1890, -1.2500]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5488, -0.8228,  0.3799,  ..., -1.1494, -0.8276, -1.3154]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4668,  0.3098, -0.3765,  ..., -0.4487, -0.1074, -0.9351]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7129,  0.1144, -0.1342,  ..., -0.6455, -0.7461, -1.0010]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5557,  1.2490,  1.0430,  ..., -0.7437, -0.1877, -1.4395]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8013,  1.0537,  1.2852,  ..., -0.9404, -0.8262, -1.5049]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2393,  0.2817,  1.5166,  ...,  0.4551, -0.8447, -1.3311]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4849,  0.0863,  1.7588,  ...,  0.2585, -1.4834, -1.3965]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 291/321
Image: IDP02065-5_A.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4021, -0.4146,  1.3818,  ..., -0.7490, -1.6553, -0.3662]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1565, -0.6099,  1.6240,  ..., -0.9453, -2.2930, -0.4316]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7002, -0.2571,  0.5103,  ..., -1.4668, -1.5996, -0.6919]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9453, -0.4526,  0.7524,  ..., -1.6631, -2.2383, -0.7573]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4180, -0.5439, -0.0383,  ..., -0.9121, -0.2311, -1.2490]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6641, -0.7393,  0.2040,  ..., -1.1084, -0.8696, -1.3145]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5156,  0.3215, -0.3928,  ..., -0.4104, -0.1166, -0.8926]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.1261, -0.1505,  ..., -0.6069, -0.7554, -0.9580]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5361,  1.2480,  1.0117,  ..., -0.7871, -0.1757, -1.4561]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7817,  1.0527,  1.2539,  ..., -0.9834, -0.8145, -1.5215]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2830,  0.2920,  1.5352,  ...,  0.4561, -0.8574, -1.2900]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5283,  0.0966,  1.7773,  ...,  0.2595, -1.4961, -1.3555]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 292/321
Image: 97004_2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3457, -0.4287,  1.2783,  ..., -0.7617, -1.6621, -0.3384]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1001, -0.6240,  1.5205,  ..., -0.9580, -2.3008, -0.4038]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7646, -0.2087,  0.5859,  ..., -1.4180, -1.6377, -0.7192]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0098, -0.4043,  0.8281,  ..., -1.6143, -2.2773, -0.7847]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3555, -0.4326, -0.0715,  ..., -0.6587, -0.2244, -1.1553]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6016, -0.6279,  0.1708,  ..., -0.8555, -0.8633, -1.2207]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5059,  0.2615, -0.3430,  ..., -0.4155, -0.1224, -0.9194]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7520,  0.0660, -0.1007,  ..., -0.6123, -0.7612, -0.9849]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6748,  1.1846,  1.0947,  ..., -0.7705, -0.1935, -1.5098]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9204,  0.9893,  1.3369,  ..., -0.9668, -0.8320, -1.5752]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3240,  0.3320,  1.6250,  ...,  0.4270, -0.8545, -1.3340]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5693,  0.1366,  1.8672,  ...,  0.2305, -1.4932, -1.3994]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 293/321
Image: uft3-4_collect.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4663, -0.3809,  1.3750,  ..., -0.7407, -1.6533, -0.3887]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2207, -0.5762,  1.6172,  ..., -0.9375, -2.2930, -0.4541]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6748, -0.2896,  0.5293,  ..., -1.4248, -1.5869, -0.7202]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9199, -0.4849,  0.7715,  ..., -1.6211, -2.2266, -0.7856]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4023, -0.5718,  0.0787,  ..., -0.8857, -0.2339, -1.2646]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6484, -0.7671,  0.3210,  ..., -1.0820, -0.8726, -1.3301]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5020,  0.2969, -0.3748,  ..., -0.3870, -0.1078, -0.9224]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7480,  0.1014, -0.1324,  ..., -0.5835, -0.7466, -0.9878]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5459,  1.2344,  1.0566,  ..., -0.7412, -0.1621, -1.4551]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7915,  1.0391,  1.2988,  ..., -0.9375, -0.8008, -1.5205]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2595,  0.2664,  1.5488,  ...,  0.4424, -0.8833, -1.3301]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5049,  0.0709,  1.7910,  ...,  0.2458, -1.5215, -1.3955]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 294/321
Image: knx7-8.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4087, -0.3760,  1.3643,  ..., -0.7861, -1.6445, -0.3862]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1631, -0.5713,  1.6064,  ..., -0.9824, -2.2832, -0.4517]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7109, -0.2515,  0.5674,  ..., -1.3877, -1.5693, -0.6924]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9570, -0.4468,  0.8096,  ..., -1.5840, -2.2070, -0.7578]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4668, -0.5063,  0.0416,  ..., -0.8618, -0.2507, -1.2432]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7129, -0.7017,  0.2839,  ..., -1.0586, -0.8896, -1.3086]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5332,  0.3262, -0.3965,  ..., -0.4072, -0.0896, -0.9004]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7793,  0.1307, -0.1542,  ..., -0.6035, -0.7285, -0.9658]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5547,  1.2412,  1.0283,  ..., -0.7617, -0.1609, -1.4512]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8003,  1.0459,  1.2705,  ..., -0.9580, -0.7998, -1.5166]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3079,  0.2910,  1.5703,  ...,  0.4336, -0.9014, -1.3145]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5537,  0.0956,  1.8125,  ...,  0.2371, -1.5400, -1.3799]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 295/321
Image: mz1802-b9-2.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5293, -0.3765,  1.5332,  ..., -0.7305, -1.6709, -0.3896]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2837, -0.5718,  1.7754,  ..., -0.9268, -2.3086, -0.4551]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6631, -0.4680,  0.5869,  ..., -1.6973, -1.4922, -0.6362]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9082, -0.6636,  0.8291,  ..., -1.8936, -2.1309, -0.7017]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.1953, -0.6528,  0.1287,  ..., -0.9424, -0.1387, -1.1875]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4414, -0.8481,  0.3711,  ..., -1.1387, -0.7773, -1.2529]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4121,  0.3054, -0.3276,  ..., -0.4390, -0.1432, -0.9194]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6582,  0.1100, -0.0853,  ..., -0.6357, -0.7817, -0.9849]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4827,  1.2578,  1.0771,  ..., -0.8027, -0.1313, -1.4160]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7285,  1.0625,  1.3193,  ..., -0.9990, -0.7700, -1.4814]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2391,  0.3083,  1.5312,  ...,  0.4370, -0.8589, -1.3301]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4849,  0.1129,  1.7734,  ...,  0.2405, -1.4980, -1.3955]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 296/321
Image: ekd3-3.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4207, -0.4204,  1.3906,  ..., -0.7319, -1.6387, -0.3433]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1750, -0.6157,  1.6328,  ..., -0.9287, -2.2773, -0.4087]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7148, -0.2512,  0.5371,  ..., -1.4492, -1.6152, -0.7231]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9609, -0.4468,  0.7793,  ..., -1.6455, -2.2539, -0.7886]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4150, -0.5532,  0.0540,  ..., -0.8911, -0.2312, -1.2822]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6602, -0.7485,  0.2964,  ..., -1.0879, -0.8701, -1.3477]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4932,  0.2739, -0.4092,  ..., -0.3967, -0.0903, -0.9175]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7383,  0.0785, -0.1669,  ..., -0.5933, -0.7290, -0.9829]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5742,  1.2471,  1.0547,  ..., -0.7773, -0.2015, -1.4893]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8198,  1.0518,  1.2969,  ..., -0.9736, -0.8403, -1.5547]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2458,  0.3054,  1.5410,  ...,  0.4504, -0.8545, -1.2852]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4915,  0.1100,  1.7832,  ...,  0.2539, -1.4932, -1.3506]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 297/321
Image: ijh3-5_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4773, -0.4265,  1.3447,  ..., -0.7114, -1.6865, -0.3521]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2317, -0.6221,  1.5869,  ..., -0.9082, -2.3242, -0.4175]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7275, -0.2830,  0.4302,  ..., -1.5137, -1.5645, -0.7207]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9727, -0.4785,  0.6724,  ..., -1.7100, -2.2031, -0.7861]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3164, -0.6392,  0.1549,  ..., -0.9375, -0.2461, -1.1934]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5625, -0.8345,  0.3972,  ..., -1.1338, -0.8848, -1.2588]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4932,  0.2759, -0.3406,  ..., -0.3816, -0.1184, -0.9155]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7383,  0.0804, -0.0983,  ..., -0.5781, -0.7568, -0.9810]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5845,  1.2578,  1.0537,  ..., -0.7588, -0.1431, -1.4932]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8301,  1.0625,  1.2959,  ..., -0.9551, -0.7817, -1.5586]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2446,  0.3215,  1.5078,  ...,  0.4619, -0.8296, -1.3525]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4902,  0.1261,  1.7500,  ...,  0.2654, -1.4688, -1.4180]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 298/321
Image: hix8-6.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4243, -0.4033,  1.3828,  ..., -0.7373, -1.6484, -0.3408]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1787, -0.5986,  1.6250,  ..., -0.9336, -2.2871, -0.4062]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7080, -0.4399,  0.5889,  ..., -1.6387, -1.5781, -0.7383]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.6353,  0.8311,  ..., -1.8350, -2.2168, -0.8037]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4043, -0.5264,  0.0776,  ..., -0.9434, -0.1732, -1.3174]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6504, -0.7217,  0.3198,  ..., -1.1396, -0.8120, -1.3828]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4775,  0.2891, -0.3926,  ..., -0.4026, -0.0734, -0.9517]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7227,  0.0936, -0.1503,  ..., -0.5991, -0.7119, -1.0176]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5664,  1.2197,  1.0645,  ..., -0.7744, -0.1779, -1.4463]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8120,  1.0244,  1.3066,  ..., -0.9707, -0.8164, -1.5117]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2424,  0.2847,  1.5488,  ...,  0.4492, -0.8198, -1.2979]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4880,  0.0892,  1.7910,  ...,  0.2527, -1.4590, -1.3633]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 299/321
Image: 7660_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4636, -0.4556,  1.3076,  ..., -0.7090, -1.7109, -0.3530]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2180, -0.6509,  1.5498,  ..., -0.9053, -2.3496, -0.4185]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7646, -0.2659,  0.4756,  ..., -1.4600, -1.6152, -0.7134]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0098, -0.4614,  0.7178,  ..., -1.6562, -2.2539, -0.7788]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3711, -0.6060,  0.0322,  ..., -0.9326, -0.2666, -1.2471]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6172, -0.8013,  0.2744,  ..., -1.1289, -0.9053, -1.3125]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4756,  0.2468, -0.3613,  ..., -0.3535, -0.1483, -0.9092]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7207,  0.0514, -0.1190,  ..., -0.5498, -0.7871, -0.9746]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5669,  1.2529,  1.0576,  ..., -0.7949, -0.1670, -1.4873]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8125,  1.0576,  1.2998,  ..., -0.9912, -0.8057, -1.5527]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2211,  0.3086,  1.5088,  ...,  0.4211, -0.8770, -1.3604]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4668,  0.1132,  1.7510,  ...,  0.2246, -1.5156, -1.4258]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 300/321
Image: 67368_2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3733, -0.4180,  1.2324,  ..., -0.7637, -1.6172, -0.3257]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1277, -0.6133,  1.4746,  ..., -0.9600, -2.2559, -0.3911]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7666, -0.2537,  0.5781,  ..., -1.3594, -1.5898, -0.7622]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0117, -0.4492,  0.8203,  ..., -1.5557, -2.2285, -0.8276]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.5127, -0.4702,  0.1012,  ..., -0.8662, -0.3267, -1.2129]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7578, -0.6655,  0.3435,  ..., -1.0625, -0.9653, -1.2783]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5518,  0.2874, -0.3535,  ..., -0.3989, -0.1299, -0.9497]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7969,  0.0919, -0.1112,  ..., -0.5957, -0.7686, -1.0156]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5381,  1.2100,  1.0195,  ..., -0.7158, -0.1663, -1.4482]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7837,  1.0146,  1.2617,  ..., -0.9121, -0.8047, -1.5137]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2812,  0.3613,  1.5469,  ...,  0.4897, -0.9180, -1.3516]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5269,  0.1659,  1.7891,  ...,  0.2932, -1.5566, -1.4170]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 301/321
Image: rdj0-10_0020.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3804, -0.3728,  1.2227,  ..., -0.7627, -1.5938, -0.3423]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1348, -0.5684,  1.4648,  ..., -0.9590, -2.2324, -0.4077]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7617, -0.2676,  0.5864,  ..., -1.3291, -1.5869, -0.7686]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0078, -0.4629,  0.8286,  ..., -1.5254, -2.2266, -0.8340]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4639, -0.4458,  0.1279,  ..., -0.8657, -0.2651, -1.2354]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7090, -0.6411,  0.3701,  ..., -1.0625, -0.9038, -1.3008]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5107,  0.2764, -0.3191,  ..., -0.4043, -0.0941, -0.9849]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7559,  0.0809, -0.0768,  ..., -0.6006, -0.7329, -1.0508]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5254,  1.1904,  1.0703,  ..., -0.7183, -0.1204, -1.4492]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7710,  0.9951,  1.3125,  ..., -0.9150, -0.7593, -1.5146]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2732,  0.3567,  1.5850,  ...,  0.4988, -0.8691, -1.3525]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5186,  0.1613,  1.8271,  ...,  0.3022, -1.5078, -1.4180]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 302/321
Image: ebw2_14_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4995, -0.4397,  1.3486,  ..., -0.7236, -1.6777, -0.3267]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2539, -0.6353,  1.5908,  ..., -0.9199, -2.3164, -0.3921]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6953, -0.4080,  0.5605,  ..., -1.6543, -1.5742, -0.6846]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9414, -0.6035,  0.8027,  ..., -1.8506, -2.2129, -0.7500]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2090, -0.5176,  0.0135,  ..., -0.7251, -0.1736, -1.1602]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4551, -0.7129,  0.2559,  ..., -0.9219, -0.8125, -1.2256]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4463,  0.2666, -0.3264,  ..., -0.4248, -0.1097, -0.9395]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6914,  0.0712, -0.0841,  ..., -0.6211, -0.7485, -1.0049]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6533,  1.1855,  1.1191,  ..., -0.7915, -0.1458, -1.5098]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8989,  0.9902,  1.3613,  ..., -0.9883, -0.7842, -1.5752]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2678,  0.3220,  1.6006,  ...,  0.4331, -0.8433, -1.3496]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5137,  0.1266,  1.8428,  ...,  0.2366, -1.4824, -1.4150]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 303/321
Image: hot1-4.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3452, -0.3684,  1.3252,  ..., -0.8359, -1.5996, -0.3843]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0996, -0.5640,  1.5674,  ..., -1.0322, -2.2383, -0.4497]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6602, -0.4038,  0.6211,  ..., -1.4893, -1.5459, -0.7441]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9062, -0.5991,  0.8633,  ..., -1.6855, -2.1836, -0.8096]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4180, -0.3525, -0.0736,  ..., -0.6221, -0.1505, -1.2197]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6641, -0.5479,  0.1687,  ..., -0.8184, -0.7891, -1.2852]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5195,  0.3281, -0.3411,  ..., -0.4529, -0.1017, -0.9487]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7656,  0.1327, -0.0988,  ..., -0.6494, -0.7402, -1.0146]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6162,  1.1699,  1.0303,  ..., -0.7437, -0.1886, -1.4727]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8618,  0.9746,  1.2725,  ..., -0.9404, -0.8271, -1.5381]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3020,  0.3296,  1.6201,  ...,  0.4294, -0.8384, -1.3506]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5479,  0.1342,  1.8623,  ...,  0.2329, -1.4766, -1.4160]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 304/321
Image: T1023_3_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4937, -0.4055,  1.3867,  ..., -0.7412, -1.6699, -0.3613]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2480, -0.6011,  1.6289,  ..., -0.9375, -2.3086, -0.4268]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6543, -0.4080,  0.6221,  ..., -1.6162, -1.5654, -0.6973]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9004, -0.6035,  0.8643,  ..., -1.8125, -2.2031, -0.7627]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3906, -0.5459,  0.0826,  ..., -0.8799, -0.1674, -1.2500]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6367, -0.7412,  0.3250,  ..., -1.0762, -0.8062, -1.3154]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5029,  0.3110, -0.4121,  ..., -0.3896, -0.0875, -0.9307]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7480,  0.1156, -0.1698,  ..., -0.5859, -0.7261, -0.9961]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.4868,  1.3467,  0.9404,  ..., -0.5938, -0.2349, -1.2979]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7324,  1.1514,  1.1826,  ..., -0.7900, -0.8735, -1.3633]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3335,  0.3000,  1.4971,  ...,  0.5059, -0.9019, -1.2969]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5791,  0.1046,  1.7393,  ...,  0.3093, -1.5410, -1.3623]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 305/321
Image: IMPPEGsIIC9gly-peak.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.5122, -0.4355,  1.4238,  ..., -0.7588, -1.6689, -0.3574]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2666, -0.6309,  1.6660,  ..., -0.9551, -2.3086, -0.4229]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6699, -0.4785,  0.5811,  ..., -1.6230, -1.6104, -0.6470]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9160, -0.6738,  0.8232,  ..., -1.8193, -2.2500, -0.7124]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2832, -0.5991,  0.1009,  ..., -0.9219, -0.1921, -1.2461]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5293, -0.7944,  0.3433,  ..., -1.1182, -0.8311, -1.3115]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4600,  0.2988, -0.3508,  ..., -0.4067, -0.1261, -0.9248]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7051,  0.1034, -0.1085,  ..., -0.6035, -0.7646, -0.9902]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5669,  1.2393,  1.0273,  ..., -0.7520, -0.1875, -1.4678]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8125,  1.0439,  1.2695,  ..., -0.9482, -0.8262, -1.5332]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2463,  0.2954,  1.4941,  ...,  0.4727, -0.8311, -1.3193]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4919,  0.1000,  1.7363,  ...,  0.2761, -1.4697, -1.3848]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 306/321
Image: STR0003-1b.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4246, -0.3997,  1.3750,  ..., -0.7671, -1.6162, -0.3730]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1790, -0.5952,  1.6172,  ..., -0.9639, -2.2539, -0.4385]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7051, -0.3022,  0.4961,  ..., -1.4248, -1.5371, -0.6953]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9512, -0.4976,  0.7383,  ..., -1.6211, -2.1758, -0.7607]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4180, -0.5508,  0.0297,  ..., -0.9155, -0.2140, -1.2891]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6641, -0.7461,  0.2720,  ..., -1.1123, -0.8525, -1.3545]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5342,  0.3093, -0.4038,  ..., -0.3977, -0.1046, -0.9385]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7793,  0.1139, -0.1615,  ..., -0.5942, -0.7432, -1.0039]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5444,  1.2354,  1.0537,  ..., -0.7568, -0.1952, -1.4531]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7900,  1.0400,  1.2959,  ..., -0.9531, -0.8340, -1.5186]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2700,  0.2910,  1.5195,  ...,  0.4346, -0.8691, -1.2949]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5156,  0.0956,  1.7617,  ...,  0.2380, -1.5078, -1.3604]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 307/321
Image: lst9_6_1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4172, -0.4478,  1.3066,  ..., -0.7178, -1.6768, -0.3208]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1716, -0.6431,  1.5488,  ..., -0.9141, -2.3164, -0.3862]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7617, -0.2297,  0.5005,  ..., -1.4736, -1.5957, -0.7256]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0078, -0.4253,  0.7427,  ..., -1.6699, -2.2344, -0.7910]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3613, -0.6128,  0.1470,  ..., -0.9390, -0.2861, -1.2158]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6074, -0.8081,  0.3892,  ..., -1.1357, -0.9248, -1.2812]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5322,  0.2271, -0.4043,  ..., -0.3950, -0.1378, -0.9214]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7773,  0.0316, -0.1620,  ..., -0.5918, -0.7764, -0.9868]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5757,  1.2227,  1.0781,  ..., -0.8008, -0.1604, -1.4688]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8213,  1.0273,  1.3203,  ..., -0.9971, -0.7988, -1.5342]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2285,  0.3149,  1.5273,  ...,  0.3984, -0.8945, -1.3193]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.4741,  0.1195,  1.7695,  ...,  0.2019, -1.5332, -1.3848]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 308/321
Image: 111979_1_E2_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4058, -0.3770,  1.2842,  ..., -0.7852, -1.5977, -0.3823]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1602, -0.5723,  1.5264,  ..., -0.9814, -2.2363, -0.4478]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7422, -0.2917,  0.5283,  ..., -1.3740, -1.5664, -0.7339]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9883, -0.4873,  0.7705,  ..., -1.5703, -2.2051, -0.7993]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4590, -0.4863,  0.1144,  ..., -0.8862, -0.2418, -1.2539]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7051, -0.6816,  0.3567,  ..., -1.0830, -0.8804, -1.3193]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5156,  0.2773, -0.3538,  ..., -0.4092, -0.0781, -0.9375]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7617,  0.0819, -0.1115,  ..., -0.6055, -0.7168, -1.0029]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5576,  1.2295,  1.0410,  ..., -0.7422, -0.1353, -1.4512]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8032,  1.0342,  1.2832,  ..., -0.9385, -0.7739, -1.5166]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2627,  0.3018,  1.5781,  ...,  0.4500, -0.8794, -1.3652]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5083,  0.1063,  1.8203,  ...,  0.2534, -1.5176, -1.4307]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 309/321
Image: IDP02154-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4204, -0.3672,  1.3613,  ..., -0.7603, -1.6055, -0.3872]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1748, -0.5625,  1.6035,  ..., -0.9570, -2.2441, -0.4526]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7070, -0.2971,  0.5562,  ..., -1.3682, -1.5400, -0.6992]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9531, -0.4927,  0.7983,  ..., -1.5645, -2.1797, -0.7646]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3438, -0.4512, -0.0246,  ..., -0.6460, -0.1425, -1.2031]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5898, -0.6465,  0.2177,  ..., -0.8428, -0.7812, -1.2686]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5254,  0.3125, -0.3152,  ..., -0.4133, -0.0874, -0.9780]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7715,  0.1171, -0.0729,  ..., -0.6099, -0.7261, -1.0439]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6689,  1.2256,  1.0957,  ..., -0.7422, -0.1987, -1.5215]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9146,  1.0303,  1.3379,  ..., -0.9385, -0.8374, -1.5869]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2949,  0.3179,  1.5986,  ...,  0.4277, -0.8442, -1.3506]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5405,  0.1224,  1.8408,  ...,  0.2312, -1.4824, -1.4160]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 310/321
Image: PegH10-G1P-xtal1.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4585, -0.4087,  1.4395,  ..., -0.7935, -1.6523, -0.3901]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2129, -0.6040,  1.6816,  ..., -0.9902, -2.2910, -0.4556]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6719, -0.3123,  0.4888,  ..., -1.4570, -1.5449, -0.6885]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9180, -0.5078,  0.7310,  ..., -1.6533, -2.1836, -0.7539]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3252, -0.6069,  0.1162,  ..., -0.9355, -0.2559, -1.2354]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5703, -0.8022,  0.3584,  ..., -1.1318, -0.8945, -1.3008]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4893,  0.3013, -0.3433,  ..., -0.3977, -0.1548, -0.8887]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7344,  0.1058, -0.1010,  ..., -0.5942, -0.7935, -0.9541]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5059,  1.2578,  1.1064,  ..., -0.8076, -0.1868, -1.4775]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7515,  1.0625,  1.3486,  ..., -1.0039, -0.8252, -1.5430]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2661,  0.3096,  1.5352,  ...,  0.3958, -0.8560, -1.3584]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5117,  0.1141,  1.7773,  ...,  0.1992, -1.4941, -1.4238]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 311/321
Image: xtal_5_peak.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4126, -0.4263,  1.5137,  ..., -0.7202, -1.6826, -0.3667]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1670, -0.6216,  1.7559,  ..., -0.9170, -2.3203, -0.4321]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7100, -0.4341,  0.6079,  ..., -1.6758, -1.5635, -0.6616]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9551, -0.6294,  0.8501,  ..., -1.8721, -2.2031, -0.7271]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2305, -0.5400, -0.0732,  ..., -0.7495, -0.1277, -1.2080]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.4766, -0.7354,  0.1691,  ..., -0.9463, -0.7666, -1.2734]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4961,  0.2803, -0.3628,  ..., -0.4502, -0.1235, -0.9175]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7422,  0.0848, -0.1205,  ..., -0.6465, -0.7622, -0.9829]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6533,  1.2070,  1.0752,  ..., -0.8574, -0.1628, -1.5029]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8989,  1.0117,  1.3174,  ..., -1.0537, -0.8018, -1.5684]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2837,  0.3198,  1.6006,  ...,  0.3633, -0.8306, -1.3379]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5293,  0.1244,  1.8428,  ...,  0.1667, -1.4688, -1.4033]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 312/321
Image: idp02499-1.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3989, -0.3760,  1.4033,  ..., -0.7881, -1.6074, -0.3901]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1533, -0.5713,  1.6455,  ..., -0.9844, -2.2461, -0.4556]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6992, -0.4272,  0.6021,  ..., -1.5732, -1.4941, -0.6826]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9453, -0.6226,  0.8442,  ..., -1.7695, -2.1328, -0.7480]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3408, -0.4204, -0.0481,  ..., -0.7280, -0.0660, -1.2744]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5859, -0.6157,  0.1942,  ..., -0.9248, -0.7046, -1.3398]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5352,  0.3435, -0.3818,  ..., -0.4810, -0.0758, -0.9717]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7812,  0.1481, -0.1395,  ..., -0.6777, -0.7144, -1.0371]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6504,  1.2324,  1.0439,  ..., -0.7764, -0.1877, -1.4766]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8960,  1.0371,  1.2861,  ..., -0.9727, -0.8262, -1.5420]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2737,  0.3469,  1.5840,  ...,  0.4041, -0.8481, -1.3438]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5195,  0.1515,  1.8262,  ...,  0.2075, -1.4863, -1.4092]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 313/321
Image: idp91101d.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3613, -0.4106,  1.3320,  ..., -0.7798, -1.6309, -0.3760]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1157, -0.6060,  1.5742,  ..., -0.9766, -2.2695, -0.4414]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6934, -0.4199,  0.6514,  ..., -1.5342, -1.5801, -0.7319]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9395, -0.6152,  0.8936,  ..., -1.7305, -2.2188, -0.7974]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3818, -0.3999, -0.0527,  ..., -0.6396, -0.1561, -1.2607]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6270, -0.5952,  0.1897,  ..., -0.8359, -0.7949, -1.3262]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5234,  0.2842, -0.3486,  ..., -0.4473, -0.0876, -0.9756]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7695,  0.0887, -0.1063,  ..., -0.6436, -0.7266, -1.0410]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6401,  1.1406,  1.0889,  ..., -0.7524, -0.2030, -1.4785]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8857,  0.9453,  1.3311,  ..., -0.9492, -0.8418, -1.5439]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2798,  0.3159,  1.5977,  ...,  0.4355, -0.8330, -1.3115]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5254,  0.1205,  1.8398,  ...,  0.2390, -1.4717, -1.3770]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 314/321
Image: p1_1_E1_001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4414, -0.3855,  1.3115,  ..., -0.7349, -1.6494, -0.3608]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1958, -0.5811,  1.5537,  ..., -0.9316, -2.2891, -0.4263]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7402, -0.2358,  0.5664,  ..., -1.3877, -1.5801, -0.7363]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9863, -0.4312,  0.8086,  ..., -1.5840, -2.2188, -0.8018]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4150, -0.4922,  0.1273,  ..., -0.8818, -0.2314, -1.2100]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6602, -0.6875,  0.3696,  ..., -1.0781, -0.8701, -1.2754]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4912,  0.2751, -0.3467,  ..., -0.3887, -0.0938, -0.9243]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7363,  0.0797, -0.1044,  ..., -0.5850, -0.7324, -0.9897]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5215,  1.2188,  1.0859,  ..., -0.7686, -0.1204, -1.4512]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7671,  1.0234,  1.3281,  ..., -0.9648, -0.7588, -1.5166]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2893,  0.3071,  1.5869,  ...,  0.4629, -0.8877, -1.3613]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5352,  0.1117,  1.8291,  ...,  0.2664, -1.5264, -1.4268]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 315/321
Image: IDP91046-2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4302, -0.3857,  1.3457,  ..., -0.7705, -1.6670, -0.3833]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1846, -0.5811,  1.5879,  ..., -0.9668, -2.3047, -0.4487]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6885, -0.2505,  0.5347,  ..., -1.4424, -1.5928, -0.7163]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9336, -0.4458,  0.7769,  ..., -1.6387, -2.2305, -0.7817]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3408, -0.4360, -0.0852,  ..., -0.6392, -0.1665, -1.1982]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5859, -0.6313,  0.1571,  ..., -0.8359, -0.8052, -1.2637]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5020,  0.2979, -0.3447,  ..., -0.3806, -0.1063, -0.9316]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7480,  0.1024, -0.1024,  ..., -0.5771, -0.7451, -0.9971]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6318,  1.2217,  1.0742,  ..., -0.7441, -0.1776, -1.5312]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8774,  1.0264,  1.3164,  ..., -0.9404, -0.8164, -1.5967]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2971,  0.3374,  1.5898,  ...,  0.4592, -0.8262, -1.3252]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5430,  0.1420,  1.8320,  ...,  0.2627, -1.4648, -1.3906]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 316/321
Image: 156676_1_E2_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3198, -0.4014,  1.2549,  ..., -0.7881, -1.6123, -0.3330]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.0742, -0.5967,  1.4971,  ..., -0.9844, -2.2500, -0.3984]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7559, -0.2693,  0.5776,  ..., -1.3652, -1.6113, -0.7485]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-2.0020, -0.4648,  0.8198,  ..., -1.5615, -2.2500, -0.8140]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4648, -0.4043, -0.0864,  ..., -0.5918, -0.1914, -1.2031]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7109, -0.5996,  0.1559,  ..., -0.7881, -0.8301, -1.2686]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5557,  0.3040, -0.3340,  ..., -0.4153, -0.1392, -0.9521]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.8008,  0.1085, -0.0917,  ..., -0.6118, -0.7778, -1.0176]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6650,  1.1787,  1.0762,  ..., -0.7290, -0.2115, -1.5195]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.9106,  0.9834,  1.3184,  ..., -0.9258, -0.8501, -1.5850]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3157,  0.3455,  1.6133,  ...,  0.4495, -0.8647, -1.3105]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5615,  0.1500,  1.8555,  ...,  0.2529, -1.5039, -1.3760]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 317/321
Image: r1_0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3538, -0.3965,  1.2881,  ..., -0.7871, -1.6367, -0.3716]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1082, -0.5918,  1.5303,  ..., -0.9834, -2.2754, -0.4370]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7334, -0.3755,  0.7163,  ..., -1.4893, -1.6572, -0.6973]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9785, -0.5708,  0.9585,  ..., -1.6855, -2.2969, -0.7627]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4795, -0.4287,  0.0627,  ..., -0.8486, -0.2400, -1.2510]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7246, -0.6240,  0.3052,  ..., -1.0449, -0.8789, -1.3164]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4883,  0.2905, -0.3926,  ..., -0.4365, -0.0632, -0.9297]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7344,  0.0951, -0.1503,  ..., -0.6328, -0.7021, -0.9951]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5010,  1.1455,  1.0195,  ..., -0.7725, -0.1151, -1.4199]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7466,  0.9502,  1.2617,  ..., -0.9688, -0.7539, -1.4854]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.3169,  0.3052,  1.5859,  ...,  0.4353, -0.8848, -1.3320]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5625,  0.1097,  1.8281,  ...,  0.2388, -1.5234, -1.3975]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 318/321
Image: idp91154a-2.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4465, -0.4038,  1.3594,  ..., -0.7329, -1.6650, -0.3496]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.2009, -0.5991,  1.6016,  ..., -0.9297, -2.3047, -0.4150]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7109, -0.2720,  0.5420,  ..., -1.4229, -1.5215, -0.6675]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9570, -0.4673,  0.7842,  ..., -1.6191, -2.1602, -0.7329]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.4121, -0.5640,  0.0481,  ..., -0.8848, -0.2432, -1.2393]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6582, -0.7593,  0.2905,  ..., -1.0811, -0.8818, -1.3047]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5254,  0.3044, -0.3884,  ..., -0.3765, -0.1260, -0.9126]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7715,  0.1090, -0.1461,  ..., -0.5732, -0.7646, -0.9780]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5337,  1.2383,  1.0381,  ..., -0.7432, -0.1830, -1.4541]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7793,  1.0430,  1.2803,  ..., -0.9395, -0.8218, -1.5195]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2666,  0.2905,  1.5078,  ...,  0.4521, -0.8818, -1.3047]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5122,  0.0951,  1.7500,  ...,  0.2556, -1.5205, -1.3701]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 319/321
Image: m1g1eg-2.0001.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4441, -0.3875,  1.3838,  ..., -0.7446, -1.6484, -0.3945]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1985, -0.5830,  1.6260,  ..., -0.9414, -2.2871, -0.4600]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6865, -0.3860,  0.6592,  ..., -1.5898, -1.5547, -0.7017]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9316, -0.5815,  0.9014,  ..., -1.7861, -2.1934, -0.7671]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.2842, -0.4365, -0.0613,  ..., -0.6729, -0.0965, -1.2207]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.5293, -0.6318,  0.1810,  ..., -0.8691, -0.7354, -1.2861]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.4980,  0.3096, -0.3403,  ..., -0.4385, -0.0883, -0.9639]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7441,  0.1141, -0.0980,  ..., -0.6348, -0.7271, -1.0293]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.6523,  1.1553,  1.1104,  ..., -0.7490, -0.0845, -1.4277]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8979,  0.9600,  1.3525,  ..., -0.9453, -0.7231, -1.4932]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2988,  0.2957,  1.5996,  ...,  0.4038, -0.8677, -1.3281]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5444,  0.1002,  1.8418,  ...,  0.2073, -1.5059, -1.3936]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 320/321
Image: idp91330sm-b.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.3706, -0.3845,  1.4131,  ..., -0.7163, -1.6680, -0.3647]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1250, -0.5801,  1.6553,  ..., -0.9131, -2.3066, -0.4302]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.7490, -0.2212,  0.5386,  ..., -1.4961, -1.5234, -0.6973]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9941, -0.4165,  0.7808,  ..., -1.6924, -2.1621, -0.7627]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3936e+00, -5.9814e-01, -3.0518e-04,  ..., -9.8730e-01,
         -1.9287e-01, -1.2490e+00]], device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6387, -0.7935,  0.2419,  ..., -1.1836, -0.8315, -1.3145]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5371,  0.3101, -0.4214,  ..., -0.3906, -0.0941, -0.8760]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7832,  0.1146, -0.1791,  ..., -0.5869, -0.7329, -0.9414]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5811,  1.2617,  1.0254,  ..., -0.8066, -0.1674, -1.4404]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.8267,  1.0664,  1.2676,  ..., -1.0029, -0.8062, -1.5059]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2937,  0.3052,  1.5352,  ...,  0.4019, -0.8579, -1.2637]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5391,  0.1097,  1.7773,  ...,  0.2053, -1.4961, -1.3291]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

================================================================================
PROCESSING ROW 321/321
Image: wjm1-6.png
Prompt: This is a 2D X-ray diffraction (XRD) image with anomalies in it. The possible anomaly options are:
O...
Expected Answer: Background ring.
================================================================================

=== GENERATING WITH STEERING (Alpha: 0.3, Layer: 16) ===
Generated text: Starting generation with prompt length: 195
Steering will be applied during token generation phase
Max new tokens: 512
--------------------------------------------------
Step 1: Processing prompt embeddings...
✅ Steering applied at generation step 0 (alpha: 0.3)
  Original activation: tensor([[ 0.4292, -0.3640,  1.4277,  ..., -0.7661, -1.6260, -0.3765]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[ 0.1836, -0.5596,  1.6699,  ..., -0.9629, -2.2656, -0.4419]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'Background' (ID: 16585)
Step 2: Generating next token...
✅ Steering applied at generation step 1 (alpha: 0.3)
  Original activation: tensor([[-1.6768, -0.2869,  0.4939,  ..., -1.4531, -1.5195, -0.7217]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.9219, -0.4824,  0.7363,  ..., -1.6494, -2.1582, -0.7871]],
       device='cuda:0', dtype=torch.float16)
Generated token: 'ring' (ID: 9228)
Step 3: Generating next token...
✅ Steering applied at generation step 2 (alpha: 0.3)
  Original activation: tensor([[-1.3760, -0.5825,  0.1267,  ..., -0.9419, -0.2191, -1.2266]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.6211, -0.7778,  0.3691,  ..., -1.1387, -0.8579, -1.2920]],
       device='cuda:0', dtype=torch.float16)
Generated token: '.' (ID: 29889)
Step 4: Generating next token...
✅ Steering applied at generation step 3 (alpha: 0.3)
  Original activation: tensor([[-1.5107,  0.3384, -0.3643,  ..., -0.4053, -0.1260, -0.9004]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-1.7559,  0.1429, -0.1219,  ..., -0.6016, -0.7646, -0.9658]],
       device='cuda:0', dtype=torch.float16)
Generated token: '
' (ID: 13)
Step 5: Generating next token...
✅ Steering applied at generation step 4 (alpha: 0.3)
  Original activation: tensor([[-0.5347,  1.2568,  1.0527,  ..., -0.7622, -0.1775, -1.4541]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.7803,  1.0615,  1.2949,  ..., -0.9590, -0.8164, -1.5195]],
       device='cuda:0', dtype=torch.float16)
Generated token: '##' (ID: 2277)
Step 6: Generating next token...
✅ Steering applied at generation step 5 (alpha: 0.3)
  Original activation: tensor([[-0.2632,  0.2969,  1.5254,  ...,  0.4429, -0.8555, -1.3184]],
       device='cuda:0', dtype=torch.float16)
  Steered activation:  tensor([[-0.5088,  0.1014,  1.7676,  ...,  0.2463, -1.4941, -1.3838]],
       device='cuda:0', dtype=torch.float16)
Generated token: '#' (ID: 29937)

🛑 STOPPING CRITERIA MET at step 6


=== GENERATING BENIGN RESPONSE (NO STEERING) ===
Generated text: 
✓ SUCCESS: Generated text: Background ring.

Results saved to ./CAA_generation_results_layer_16_alpha_0.3.csv
Processed 321 items successfully
